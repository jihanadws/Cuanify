var sh=Object.defineProperty;var ih=(t,e,n)=>e in t?sh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var It=(t,e,n)=>(ih(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ha(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Se={},dr=[],Et=()=>{},Oc=()=>!1,yi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),fa=t=>t.startsWith("onUpdate:"),Ke=Object.assign,pa=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},oh=Object.prototype.hasOwnProperty,be=(t,e)=>oh.call(t,e),ce=Array.isArray,hr=t=>vi(t)==="[object Map]",Cc=t=>vi(t)==="[object Set]",fe=t=>typeof t=="function",qe=t=>typeof t=="string",rn=t=>typeof t=="symbol",je=t=>t!==null&&typeof t=="object",Ic=t=>(je(t)||fe(t))&&fe(t.then)&&fe(t.catch),Rc=Object.prototype.toString,vi=t=>Rc.call(t),ah=t=>vi(t).slice(8,-1),xc=t=>vi(t)==="[object Object]",ma=t=>qe(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Fr=ha(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),_i=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},lh=/-\w/g,wn=_i(t=>t.replace(lh,e=>e.slice(1).toUpperCase())),ch=/\B([A-Z])/g,Wn=_i(t=>t.replace(ch,"-$1").toLowerCase()),Pc=_i(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ui=_i(t=>t?`on${Pc(t)}`:""),_n=(t,e)=>!Object.is(t,e),Di=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Lc=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},uh=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let il;const bi=()=>il||(il=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ga(t){if(ce(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=qe(r)?ph(r):ga(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(qe(t)||je(t))return t}const dh=/;(?![^(]*\))/g,hh=/:([^]+)/,fh=/\/\*[^]*?\*\//g;function ph(t){const e={};return t.replace(fh,"").split(dh).forEach(n=>{if(n){const r=n.split(hh);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function ya(t){let e="";if(qe(t))e=t;else if(ce(t))for(let n=0;n<t.length;n++){const r=ya(t[n]);r&&(e+=r+" ")}else if(je(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const mh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gh=ha(mh);function Nc(t){return!!t||t===""}const jc=t=>!!(t&&t.__v_isRef===!0),jt=t=>qe(t)?t:t==null?"":ce(t)||je(t)&&(t.toString===Rc||!fe(t.toString))?jc(t)?jt(t.value):JSON.stringify(t,$c,2):String(t),$c=(t,e)=>jc(e)?$c(t,e.value):hr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s],i)=>(n[Fi(r,i)+" =>"]=s,n),{})}:Cc(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Fi(n))}:rn(e)?Fi(e):je(e)&&!ce(e)&&!xc(e)?String(e):e,Fi=(t,e="")=>{var n;return rn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let We;class Uc{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=We,!e&&We&&(this.index=(We.scopes||(We.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=We;try{return We=this,e()}finally{We=n}}}on(){++this._on===1&&(this.prevScope=We,We=this)}off(){this._on>0&&--this._on===0&&(We=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Dc(t){return new Uc(t)}function Fc(){return We}function yh(t,e=!1){We&&We.cleanups.push(t)}let Re;const Bi=new WeakSet;class Bc{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,We&&We.active&&We.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Bi.has(this)&&(Bi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||qc(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ol(this),Kc(this);const e=Re,n=Tt;Re=this,Tt=!0;try{return this.fn()}finally{Hc(this),Re=e,Tt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)ba(e);this.deps=this.depsTail=void 0,ol(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Bi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){mo(this)&&this.run()}get dirty(){return mo(this)}}let Mc=0,Br,Mr;function qc(t,e=!1){if(t.flags|=8,e){t.next=Mr,Mr=t;return}t.next=Br,Br=t}function va(){Mc++}function _a(){if(--Mc>0)return;if(Mr){let e=Mr;for(Mr=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Br;){let e=Br;for(Br=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function Kc(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Hc(t){let e,n=t.depsTail,r=n;for(;r;){const s=r.prevDep;r.version===-1?(r===n&&(n=s),ba(r),vh(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}t.deps=e,t.depsTail=n}function mo(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Wc(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Wc(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ns)||(t.globalVersion=ns,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!mo(t))))return;t.flags|=2;const e=t.dep,n=Re,r=Tt;Re=t,Tt=!0;try{Kc(t);const s=t.fn(t._value);(e.version===0||_n(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{Re=n,Tt=r,Hc(t),t.flags&=-3}}function ba(t,e=!1){const{dep:n,prevSub:r,nextSub:s}=t;if(r&&(r.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)ba(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function vh(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Tt=!0;const Vc=[];function Qt(){Vc.push(Tt),Tt=!1}function Zt(){const t=Vc.pop();Tt=t===void 0?!0:t}function ol(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Re;Re=void 0;try{e()}finally{Re=n}}}let ns=0;class _h{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class wa{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Re||!Tt||Re===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Re)n=this.activeLink=new _h(Re,this),Re.deps?(n.prevDep=Re.depsTail,Re.depsTail.nextDep=n,Re.depsTail=n):Re.deps=Re.depsTail=n,Gc(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=Re.depsTail,n.nextDep=void 0,Re.depsTail.nextDep=n,Re.depsTail=n,Re.deps===n&&(Re.deps=r)}return n}trigger(e){this.version++,ns++,this.notify(e)}notify(e){va();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{_a()}}}function Gc(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)Gc(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Qs=new WeakMap,$n=Symbol(""),go=Symbol(""),rs=Symbol("");function Ve(t,e,n){if(Tt&&Re){let r=Qs.get(t);r||Qs.set(t,r=new Map);let s=r.get(n);s||(r.set(n,s=new wa),s.map=r,s.key=n),s.track()}}function Vt(t,e,n,r,s,i){const o=Qs.get(t);if(!o){ns++;return}const a=l=>{l&&l.trigger()};if(va(),e==="clear")o.forEach(a);else{const l=ce(t),u=l&&ma(n);if(l&&n==="length"){const c=Number(r);o.forEach((d,h)=>{(h==="length"||h===rs||!rn(h)&&h>=c)&&a(d)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),u&&a(o.get(rs)),e){case"add":l?u&&a(o.get("length")):(a(o.get($n)),hr(t)&&a(o.get(go)));break;case"delete":l||(a(o.get($n)),hr(t)&&a(o.get(go)));break;case"set":hr(t)&&a(o.get($n));break}}_a()}function bh(t,e){const n=Qs.get(t);return n&&n.get(e)}function Yn(t){const e=ve(t);return e===t?e:(Ve(e,"iterate",rs),St(t)?e:e.map(Qe))}function Ea(t){return Ve(t=ve(t),"iterate",rs),t}const wh={__proto__:null,[Symbol.iterator](){return Mi(this,Symbol.iterator,Qe)},concat(...t){return Yn(this).concat(...t.map(e=>ce(e)?Yn(e):e))},entries(){return Mi(this,"entries",t=>(t[1]=Qe(t[1]),t))},every(t,e){return Ft(this,"every",t,e,void 0,arguments)},filter(t,e){return Ft(this,"filter",t,e,n=>n.map(Qe),arguments)},find(t,e){return Ft(this,"find",t,e,Qe,arguments)},findIndex(t,e){return Ft(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ft(this,"findLast",t,e,Qe,arguments)},findLastIndex(t,e){return Ft(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ft(this,"forEach",t,e,void 0,arguments)},includes(...t){return qi(this,"includes",t)},indexOf(...t){return qi(this,"indexOf",t)},join(t){return Yn(this).join(t)},lastIndexOf(...t){return qi(this,"lastIndexOf",t)},map(t,e){return Ft(this,"map",t,e,void 0,arguments)},pop(){return Ir(this,"pop")},push(...t){return Ir(this,"push",t)},reduce(t,...e){return al(this,"reduce",t,e)},reduceRight(t,...e){return al(this,"reduceRight",t,e)},shift(){return Ir(this,"shift")},some(t,e){return Ft(this,"some",t,e,void 0,arguments)},splice(...t){return Ir(this,"splice",t)},toReversed(){return Yn(this).toReversed()},toSorted(t){return Yn(this).toSorted(t)},toSpliced(...t){return Yn(this).toSpliced(...t)},unshift(...t){return Ir(this,"unshift",t)},values(){return Mi(this,"values",Qe)}};function Mi(t,e,n){const r=Ea(t),s=r[e]();return r!==t&&!St(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=n(i.value)),i}),s}const Eh=Array.prototype;function Ft(t,e,n,r,s,i){const o=Ea(t),a=o!==t&&!St(t),l=o[e];if(l!==Eh[e]){const d=l.apply(t,i);return a?Qe(d):d}let u=n;o!==t&&(a?u=function(d,h){return n.call(this,Qe(d),h,t)}:n.length>2&&(u=function(d,h){return n.call(this,d,h,t)}));const c=l.call(o,u,r);return a&&s?s(c):c}function al(t,e,n,r){const s=Ea(t);let i=n;return s!==t&&(St(t)?n.length>3&&(i=function(o,a,l){return n.call(this,o,a,l,t)}):i=function(o,a,l){return n.call(this,o,Qe(a),l,t)}),s[e](i,...r)}function qi(t,e,n){const r=ve(t);Ve(r,"iterate",rs);const s=r[e](...n);return(s===-1||s===!1)&&ka(n[0])?(n[0]=ve(n[0]),r[e](...n)):s}function Ir(t,e,n=[]){Qt(),va();const r=ve(t)[e].apply(t,n);return _a(),Zt(),r}const Th=ha("__proto__,__v_isRef,__isVue"),zc=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(rn));function Sh(t){rn(t)||(t=String(t));const e=ve(this);return Ve(e,"has",t),e.hasOwnProperty(t)}class Yc{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?Nh:Zc:i?Qc:Xc).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=ce(e);if(!s){let l;if(o&&(l=wh[n]))return l;if(n==="hasOwnProperty")return Sh}const a=Reflect.get(e,n,$e(e)?e:r);return(rn(n)?zc.has(n):Th(n))||(s||Ve(e,"get",n),i)?a:$e(a)?o&&ma(n)?a:a.value:je(a)?s?tu(a):vs(a):a}}class Jc extends Yc{constructor(e=!1){super(!1,e)}set(e,n,r,s){let i=e[n];if(!this._isShallow){const l=qn(i);if(!St(r)&&!qn(r)&&(i=ve(i),r=ve(r)),!ce(e)&&$e(i)&&!$e(r))return l||(i.value=r),!0}const o=ce(e)&&ma(n)?Number(n)<e.length:be(e,n),a=Reflect.set(e,n,r,$e(e)?e:s);return e===ve(s)&&(o?_n(r,i)&&Vt(e,"set",n,r):Vt(e,"add",n,r)),a}deleteProperty(e,n){const r=be(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&r&&Vt(e,"delete",n,void 0),s}has(e,n){const r=Reflect.has(e,n);return(!rn(n)||!zc.has(n))&&Ve(e,"has",n),r}ownKeys(e){return Ve(e,"iterate",ce(e)?"length":$n),Reflect.ownKeys(e)}}class kh extends Yc{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Ah=new Jc,Oh=new kh,Ch=new Jc(!0);const yo=t=>t,Cs=t=>Reflect.getPrototypeOf(t);function Ih(t,e,n){return function(...r){const s=this.__v_raw,i=ve(s),o=hr(i),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=s[t](...r),c=n?yo:e?vo:Qe;return!e&&Ve(i,"iterate",l?go:$n),{next(){const{value:d,done:h}=u.next();return h?{value:d,done:h}:{value:a?[c(d[0]),c(d[1])]:c(d),done:h}},[Symbol.iterator](){return this}}}}function Is(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Rh(t,e){const n={get(s){const i=this.__v_raw,o=ve(i),a=ve(s);t||(_n(s,a)&&Ve(o,"get",s),Ve(o,"get",a));const{has:l}=Cs(o),u=e?yo:t?vo:Qe;if(l.call(o,s))return u(i.get(s));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!t&&Ve(ve(s),"iterate",$n),s.size},has(s){const i=this.__v_raw,o=ve(i),a=ve(s);return t||(_n(s,a)&&Ve(o,"has",s),Ve(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=ve(a),u=e?yo:t?vo:Qe;return!t&&Ve(l,"iterate",$n),a.forEach((c,d)=>s.call(i,u(c),u(d),o))}};return Ke(n,t?{add:Is("add"),set:Is("set"),delete:Is("delete"),clear:Is("clear")}:{add(s){!e&&!St(s)&&!qn(s)&&(s=ve(s));const i=ve(this);return Cs(i).has.call(i,s)||(i.add(s),Vt(i,"add",s,s)),this},set(s,i){!e&&!St(i)&&!qn(i)&&(i=ve(i));const o=ve(this),{has:a,get:l}=Cs(o);let u=a.call(o,s);u||(s=ve(s),u=a.call(o,s));const c=l.call(o,s);return o.set(s,i),u?_n(i,c)&&Vt(o,"set",s,i):Vt(o,"add",s,i),this},delete(s){const i=ve(this),{has:o,get:a}=Cs(i);let l=o.call(i,s);l||(s=ve(s),l=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return l&&Vt(i,"delete",s,void 0),u},clear(){const s=ve(this),i=s.size!==0,o=s.clear();return i&&Vt(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=Ih(s,t,e)}),n}function Ta(t,e){const n=Rh(t,e);return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(be(n,s)&&s in r?n:r,s,i)}const xh={get:Ta(!1,!1)},Ph={get:Ta(!1,!0)},Lh={get:Ta(!0,!1)};const Xc=new WeakMap,Qc=new WeakMap,Zc=new WeakMap,Nh=new WeakMap;function jh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function $h(t){return t.__v_skip||!Object.isExtensible(t)?0:jh(ah(t))}function vs(t){return qn(t)?t:Sa(t,!1,Ah,xh,Xc)}function eu(t){return Sa(t,!1,Ch,Ph,Qc)}function tu(t){return Sa(t,!0,Oh,Lh,Zc)}function Sa(t,e,n,r,s){if(!je(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=$h(t);if(i===0)return t;const o=s.get(t);if(o)return o;const a=new Proxy(t,i===2?r:n);return s.set(t,a),a}function Un(t){return qn(t)?Un(t.__v_raw):!!(t&&t.__v_isReactive)}function qn(t){return!!(t&&t.__v_isReadonly)}function St(t){return!!(t&&t.__v_isShallow)}function ka(t){return t?!!t.__v_raw:!1}function ve(t){const e=t&&t.__v_raw;return e?ve(e):t}function Aa(t){return!be(t,"__v_skip")&&Object.isExtensible(t)&&Lc(t,"__v_skip",!0),t}const Qe=t=>je(t)?vs(t):t,vo=t=>je(t)?tu(t):t;function $e(t){return t?t.__v_isRef===!0:!1}function Z(t){return nu(t,!1)}function Uh(t){return nu(t,!0)}function nu(t,e){return $e(t)?t:new Dh(t,e)}class Dh{constructor(e,n){this.dep=new wa,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ve(e),this._value=n?e:Qe(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||St(e)||qn(e);e=r?e:ve(e),_n(e,n)&&(this._rawValue=e,this._value=r?e:Qe(e),this.dep.trigger())}}function Ae(t){return $e(t)?t.value:t}const Fh={get:(t,e,n)=>e==="__v_raw"?t:Ae(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return $e(s)&&!$e(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function ru(t){return Un(t)?t:new Proxy(t,Fh)}function Bh(t){const e=ce(t)?new Array(t.length):{};for(const n in t)e[n]=qh(t,n);return e}class Mh{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return bh(ve(this._object),this._key)}}function qh(t,e,n){const r=t[e];return $e(r)?r:new Mh(t,e,n)}class Kh{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new wa(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ns-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Re!==this)return qc(this,!0),!0}get value(){const e=this.dep.track();return Wc(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Hh(t,e,n=!1){let r,s;return fe(t)?r=t:(r=t.get,s=t.set),new Kh(r,s,n)}const Rs={},Zs=new WeakMap;let Pn;function Wh(t,e=!1,n=Pn){if(n){let r=Zs.get(n);r||Zs.set(n,r=[]),r.push(t)}}function Vh(t,e,n=Se){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=n,u=E=>s?E:St(E)||s===!1||s===0?Gt(E,1):Gt(E);let c,d,h,f,p=!1,y=!1;if($e(t)?(d=()=>t.value,p=St(t)):Un(t)?(d=()=>u(t),p=!0):ce(t)?(y=!0,p=t.some(E=>Un(E)||St(E)),d=()=>t.map(E=>{if($e(E))return E.value;if(Un(E))return u(E);if(fe(E))return l?l(E,2):E()})):fe(t)?e?d=l?()=>l(t,2):t:d=()=>{if(h){Qt();try{h()}finally{Zt()}}const E=Pn;Pn=c;try{return l?l(t,3,[f]):t(f)}finally{Pn=E}}:d=Et,e&&s){const E=d,T=s===!0?1/0:s;d=()=>Gt(E(),T)}const w=Fc(),v=()=>{c.stop(),w&&w.active&&pa(w.effects,c)};if(i&&e){const E=e;e=(...T)=>{E(...T),v()}}let m=y?new Array(t.length).fill(Rs):Rs;const _=E=>{if(!(!(c.flags&1)||!c.dirty&&!E))if(e){const T=c.run();if(s||p||(y?T.some((S,k)=>_n(S,m[k])):_n(T,m))){h&&h();const S=Pn;Pn=c;try{const k=[T,m===Rs?void 0:y&&m[0]===Rs?[]:m,f];m=T,l?l(e,3,k):e(...k)}finally{Pn=S}}}else c.run()};return a&&a(_),c=new Bc(d),c.scheduler=o?()=>o(_,!1):_,f=E=>Wh(E,!1,c),h=c.onStop=()=>{const E=Zs.get(c);if(E){if(l)l(E,4);else for(const T of E)T();Zs.delete(c)}},e?r?_(!0):m=c.run():o?o(_.bind(null,!0),!0):c.run(),v.pause=c.pause.bind(c),v.resume=c.resume.bind(c),v.stop=v,v}function Gt(t,e=1/0,n){if(e<=0||!je(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,$e(t))Gt(t.value,e,n);else if(ce(t))for(let r=0;r<t.length;r++)Gt(t[r],e,n);else if(Cc(t)||hr(t))t.forEach(r=>{Gt(r,e,n)});else if(xc(t)){for(const r in t)Gt(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Gt(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function _s(t,e,n,r){try{return r?t(...r):t()}catch(s){wi(s,e,n)}}function $t(t,e,n,r){if(fe(t)){const s=_s(t,e,n,r);return s&&Ic(s)&&s.catch(i=>{wi(i,e,n)}),s}if(ce(t)){const s=[];for(let i=0;i<t.length;i++)s.push($t(t[i],e,n,r));return s}}function wi(t,e,n,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Se;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](t,l,u)===!1)return}a=a.parent}if(i){Qt(),_s(i,null,10,[t,l,u]),Zt();return}}Gh(t,n,s,r,o)}function Gh(t,e,n,r=!0,s=!1){if(s)throw t;console.error(t)}const Ze=[];let xt=-1;const fr=[];let fn=null,or=0;const su=Promise.resolve();let ei=null;function bs(t){const e=ei||su;return t?e.then(this?t.bind(this):t):e}function zh(t){let e=xt+1,n=Ze.length;for(;e<n;){const r=e+n>>>1,s=Ze[r],i=ss(s);i<t||i===t&&s.flags&2?e=r+1:n=r}return e}function Oa(t){if(!(t.flags&1)){const e=ss(t),n=Ze[Ze.length-1];!n||!(t.flags&2)&&e>=ss(n)?Ze.push(t):Ze.splice(zh(e),0,t),t.flags|=1,iu()}}function iu(){ei||(ei=su.then(au))}function Yh(t){ce(t)?fr.push(...t):fn&&t.id===-1?fn.splice(or+1,0,t):t.flags&1||(fr.push(t),t.flags|=1),iu()}function ll(t,e,n=xt+1){for(;n<Ze.length;n++){const r=Ze[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Ze.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function ou(t){if(fr.length){const e=[...new Set(fr)].sort((n,r)=>ss(n)-ss(r));if(fr.length=0,fn){fn.push(...e);return}for(fn=e,or=0;or<fn.length;or++){const n=fn[or];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}fn=null,or=0}}const ss=t=>t.id==null?t.flags&2?-1:1/0:t.id;function au(t){const e=Et;try{for(xt=0;xt<Ze.length;xt++){const n=Ze[xt];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),_s(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;xt<Ze.length;xt++){const n=Ze[xt];n&&(n.flags&=-2)}xt=-1,Ze.length=0,ou(),ei=null,(Ze.length||fr.length)&&au()}}let ze=null,lu=null;function ti(t){const e=ze;return ze=t,lu=t&&t.type.__scopeId||null,e}function Vn(t,e=ze,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&si(-1);const i=ti(e);let o;try{o=t(...s)}finally{ti(i),r._d&&si(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Ca(t,e){if(ze===null)return t;const n=Ai(ze),r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Se]=e[s];i&&(fe(i)&&(i={mounted:i,updated:i}),i.deep&&Gt(o),r.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function On(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(Qt(),$t(l,n,8,[t.el,a,t,e]),Zt())}}const Jh=Symbol("_vte"),Xh=t=>t.__isTeleport,Qh=Symbol("_leaveCb");function Ia(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ia(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function ot(t,e){return fe(t)?(()=>Ke({name:t.name},e,{setup:t}))():t}function cu(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const ni=new WeakMap;function qr(t,e,n,r,s=!1){if(ce(t)){t.forEach((p,y)=>qr(p,e&&(ce(e)?e[y]:e),n,r,s));return}if(pr(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&qr(t,e,n,r.component.subTree);return}const i=r.shapeFlag&4?Ai(r.component):r.el,o=s?null:i,{i:a,r:l}=t,u=e&&e.r,c=a.refs===Se?a.refs={}:a.refs,d=a.setupState,h=ve(d),f=d===Se?Oc:p=>be(h,p);if(u!=null&&u!==l){if(cl(e),qe(u))c[u]=null,f(u)&&(d[u]=null);else if($e(u)){u.value=null;const p=e;p.k&&(c[p.k]=null)}}if(fe(l))_s(l,a,12,[o,c]);else{const p=qe(l),y=$e(l);if(p||y){const w=()=>{if(t.f){const v=p?f(l)?d[l]:c[l]:l.value;if(s)ce(v)&&pa(v,i);else if(ce(v))v.includes(i)||v.push(i);else if(p)c[l]=[i],f(l)&&(d[l]=c[l]);else{const m=[i];l.value=m,t.k&&(c[t.k]=m)}}else p?(c[l]=o,f(l)&&(d[l]=o)):y&&(l.value=o,t.k&&(c[t.k]=o))};if(o){const v=()=>{w(),ni.delete(t)};v.id=-1,ni.set(t,v),ut(v,n)}else cl(t),w()}}}function cl(t){const e=ni.get(t);e&&(e.flags|=8,ni.delete(t))}bi().requestIdleCallback;bi().cancelIdleCallback;const pr=t=>!!t.type.__asyncLoader,uu=t=>t.type.__isKeepAlive;function Zh(t,e){du(t,"a",e)}function ef(t,e){du(t,"da",e)}function du(t,e,n=et){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Ei(e,r,n),n){let s=n.parent;for(;s&&s.parent;)uu(s.parent.vnode)&&tf(r,e,n,s),s=s.parent}}function tf(t,e,n,r){const s=Ei(e,t,r,!0);Ra(()=>{pa(r[e],s)},n)}function Ei(t,e,n=et,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Qt();const a=ws(n),l=$t(e,n,t,o);return a(),Zt(),l});return r?s.unshift(i):s.push(i),i}}const sn=t=>(e,n=et)=>{(!as||t==="sp")&&Ei(t,(...r)=>e(...r),n)},nf=sn("bm"),Ot=sn("m"),rf=sn("bu"),sf=sn("u"),of=sn("bum"),Ra=sn("um"),af=sn("sp"),lf=sn("rtg"),cf=sn("rtc");function uf(t,e=et){Ei("ec",t,e)}const df=Symbol.for("v-ndc");function hf(t,e,n={},r,s){if(ze.ce||ze.parent&&pr(ze.parent)&&ze.parent.ce)return e!=="default"&&(n.name=e),Te(),tn(mt,null,[yt("slot",n,r&&r())],64);let i=t[e];i&&i._c&&(i._d=!1),Te();const o=i&&hu(i(n)),a=n.key||o&&o.key,l=tn(mt,{key:(a&&!rn(a)?a:`_${e}`)+(!o&&r?"_fb":"")},o||(r?r():[]),o&&t._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function hu(t){return t.some(e=>os(e)?!(e.type===en||e.type===mt&&!hu(e.children)):!0)?t:null}const _o=t=>t?Pu(t)?Ai(t):_o(t.parent):null,Kr=Ke(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>_o(t.parent),$root:t=>_o(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>xa(t),$forceUpdate:t=>t.f||(t.f=()=>{Oa(t.update)}),$nextTick:t=>t.n||(t.n=bs.bind(t.proxy)),$watch:t=>Nf.bind(t)}),Ki=(t,e)=>t!==Se&&!t.__isScriptSetup&&be(t,e),ff={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=t;let u;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(Ki(r,e))return o[e]=1,r[e];if(s!==Se&&be(s,e))return o[e]=2,s[e];if((u=t.propsOptions[0])&&be(u,e))return o[e]=3,i[e];if(n!==Se&&be(n,e))return o[e]=4,n[e];bo&&(o[e]=0)}}const c=Kr[e];let d,h;if(c)return e==="$attrs"&&Ve(t.attrs,"get",""),c(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(n!==Se&&be(n,e))return o[e]=4,n[e];if(h=l.config.globalProperties,be(h,e))return h[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return Ki(s,e)?(s[e]=n,!0):r!==Se&&be(r,e)?(r[e]=n,!0):be(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i,type:o}},a){let l,u;return!!(n[a]||t!==Se&&a[0]!=="$"&&be(t,a)||Ki(e,a)||(l=i[0])&&be(l,a)||be(r,a)||be(Kr,a)||be(s.config.globalProperties,a)||(u=o.__cssModules)&&u[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:be(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function ul(t){return ce(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let bo=!0;function pf(t){const e=xa(t),n=t.proxy,r=t.ctx;bo=!1,e.beforeCreate&&dl(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:d,mounted:h,beforeUpdate:f,updated:p,activated:y,deactivated:w,beforeDestroy:v,beforeUnmount:m,destroyed:_,unmounted:E,render:T,renderTracked:S,renderTriggered:k,errorCaptured:N,serverPrefetch:I,expose:Y,inheritAttrs:Q,components:ue,directives:x,filters:$}=e;if(u&&mf(u,r,null),o)for(const O in o){const D=o[O];fe(D)&&(r[O]=D.bind(n))}if(s){const O=s.call(n,n);je(O)&&(t.data=vs(O))}if(bo=!0,i)for(const O in i){const D=i[O],J=fe(D)?D.bind(n,n):fe(D.get)?D.get.bind(n,n):Et,de=!fe(D)&&fe(D.set)?D.set.bind(n):Et,Ee=Oe({get:J,set:de});Object.defineProperty(r,O,{enumerable:!0,configurable:!0,get:()=>Ee.value,set:Ne=>Ee.value=Ne})}if(a)for(const O in a)fu(a[O],r,n,O);if(l){const O=fe(l)?l.call(n):l;Reflect.ownKeys(O).forEach(D=>{qs(D,O[D])})}c&&dl(c,t,"c");function z(O,D){ce(D)?D.forEach(J=>O(J.bind(n))):D&&O(D.bind(n))}if(z(nf,d),z(Ot,h),z(rf,f),z(sf,p),z(Zh,y),z(ef,w),z(uf,N),z(cf,S),z(lf,k),z(of,m),z(Ra,E),z(af,I),ce(Y))if(Y.length){const O=t.exposed||(t.exposed={});Y.forEach(D=>{Object.defineProperty(O,D,{get:()=>n[D],set:J=>n[D]=J,enumerable:!0})})}else t.exposed||(t.exposed={});T&&t.render===Et&&(t.render=T),Q!=null&&(t.inheritAttrs=Q),ue&&(t.components=ue),x&&(t.directives=x),I&&cu(t)}function mf(t,e,n=Et){ce(t)&&(t=wo(t));for(const r in t){const s=t[r];let i;je(s)?"default"in s?i=gt(s.from||r,s.default,!0):i=gt(s.from||r):i=gt(s),$e(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function dl(t,e,n){$t(ce(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function fu(t,e,n,r){let s=r.includes(".")?Au(n,r):()=>n[r];if(qe(t)){const i=e[t];fe(i)&&bn(s,i)}else if(fe(t))bn(s,t.bind(n));else if(je(t))if(ce(t))t.forEach(i=>fu(i,e,n,r));else{const i=fe(t.handler)?t.handler.bind(n):e[t.handler];fe(i)&&bn(s,i,t)}}function xa(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!n&&!r?l=e:(l={},s.length&&s.forEach(u=>ri(l,u,o,!0)),ri(l,e,o)),je(e)&&i.set(e,l),l}function ri(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&ri(t,i,n,!0),s&&s.forEach(o=>ri(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=gf[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const gf={data:hl,props:fl,emits:fl,methods:jr,computed:jr,beforeCreate:Xe,created:Xe,beforeMount:Xe,mounted:Xe,beforeUpdate:Xe,updated:Xe,beforeDestroy:Xe,beforeUnmount:Xe,destroyed:Xe,unmounted:Xe,activated:Xe,deactivated:Xe,errorCaptured:Xe,serverPrefetch:Xe,components:jr,directives:jr,watch:vf,provide:hl,inject:yf};function hl(t,e){return e?t?function(){return Ke(fe(t)?t.call(this,this):t,fe(e)?e.call(this,this):e)}:e:t}function yf(t,e){return jr(wo(t),wo(e))}function wo(t){if(ce(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Xe(t,e){return t?[...new Set([].concat(t,e))]:e}function jr(t,e){return t?Ke(Object.create(null),t,e):e}function fl(t,e){return t?ce(t)&&ce(e)?[...new Set([...t,...e])]:Ke(Object.create(null),ul(t),ul(e??{})):e}function vf(t,e){if(!t)return e;if(!e)return t;const n=Ke(Object.create(null),t);for(const r in e)n[r]=Xe(t[r],e[r]);return n}function pu(){return{app:null,config:{isNativeTag:Oc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let _f=0;function bf(t,e){return function(r,s=null){fe(r)||(r=Ke({},r)),s!=null&&!je(s)&&(s=null);const i=pu(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:_f++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:tp,get config(){return i.config},set config(c){},use(c,...d){return o.has(c)||(c&&fe(c.install)?(o.add(c),c.install(u,...d)):fe(c)&&(o.add(c),c(u,...d))),u},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),u},component(c,d){return d?(i.components[c]=d,u):i.components[c]},directive(c,d){return d?(i.directives[c]=d,u):i.directives[c]},mount(c,d,h){if(!l){const f=u._ceVNode||yt(r,s);return f.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),d&&e?e(f,c):t(f,c,h),l=!0,u._container=c,c.__vue_app__=u,Ai(f.component)}},onUnmount(c){a.push(c)},unmount(){l&&($t(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(c,d){return i.provides[c]=d,u},runWithContext(c){const d=Dn;Dn=u;try{return c()}finally{Dn=d}}};return u}}let Dn=null;function qs(t,e){if(et){let n=et.provides;const r=et.parent&&et.parent.provides;r===n&&(n=et.provides=Object.create(r)),n[t]=e}}function gt(t,e,n=!1){const r=xu();if(r||Dn){let s=Dn?Dn._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&fe(e)?e.call(r&&r.proxy):e}}function wf(){return!!(xu()||Dn)}const mu={},gu=()=>Object.create(mu),yu=t=>Object.getPrototypeOf(t)===mu;function Ef(t,e,n,r=!1){const s={},i=gu();t.propsDefaults=Object.create(null),vu(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:eu(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function Tf(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=ve(s),[l]=t.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let d=0;d<c.length;d++){let h=c[d];if(Ti(t.emitsOptions,h))continue;const f=e[h];if(l)if(be(i,h))f!==i[h]&&(i[h]=f,u=!0);else{const p=wn(h);s[p]=Eo(l,a,p,f,t,!1)}else f!==i[h]&&(i[h]=f,u=!0)}}}else{vu(t,e,s,i)&&(u=!0);let c;for(const d in a)(!e||!be(e,d)&&((c=Wn(d))===d||!be(e,c)))&&(l?n&&(n[d]!==void 0||n[c]!==void 0)&&(s[d]=Eo(l,a,d,void 0,t,!0)):delete s[d]);if(i!==a)for(const d in i)(!e||!be(e,d))&&(delete i[d],u=!0)}u&&Vt(t.attrs,"set","")}function vu(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Fr(l))continue;const u=e[l];let c;s&&be(s,c=wn(l))?!i||!i.includes(c)?n[c]=u:(a||(a={}))[c]=u:Ti(t.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(i){const l=ve(n),u=a||Se;for(let c=0;c<i.length;c++){const d=i[c];n[d]=Eo(s,l,d,u[d],t,!be(u,d))}}return o}function Eo(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=be(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&fe(l)){const{propsDefaults:u}=s;if(n in u)r=u[n];else{const c=ws(s);r=u[n]=l.call(null,e),c()}}else r=l;s.ce&&s.ce._setProp(n,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Wn(n))&&(r=!0))}return r}const Sf=new WeakMap;function _u(t,e,n=!1){const r=n?Sf:e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let l=!1;if(!fe(t)){const c=d=>{l=!0;const[h,f]=_u(d,e,!0);Ke(o,h),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!i&&!l)return je(t)&&r.set(t,dr),dr;if(ce(i))for(let c=0;c<i.length;c++){const d=wn(i[c]);pl(d)&&(o[d]=Se)}else if(i)for(const c in i){const d=wn(c);if(pl(d)){const h=i[c],f=o[d]=ce(h)||fe(h)?{type:h}:Ke({},h),p=f.type;let y=!1,w=!0;if(ce(p))for(let v=0;v<p.length;++v){const m=p[v],_=fe(m)&&m.name;if(_==="Boolean"){y=!0;break}else _==="String"&&(w=!1)}else y=fe(p)&&p.name==="Boolean";f[0]=y,f[1]=w,(y||be(f,"default"))&&a.push(d)}}const u=[o,a];return je(t)&&r.set(t,u),u}function pl(t){return t[0]!=="$"&&!Fr(t)}const Pa=t=>t==="_"||t==="_ctx"||t==="$stable",La=t=>ce(t)?t.map(Nt):[Nt(t)],kf=(t,e,n)=>{if(e._n)return e;const r=Vn((...s)=>La(e(...s)),n);return r._c=!1,r},bu=(t,e,n)=>{const r=t._ctx;for(const s in t){if(Pa(s))continue;const i=t[s];if(fe(i))e[s]=kf(s,i,r);else if(i!=null){const o=La(i);e[s]=()=>o}}},wu=(t,e)=>{const n=La(e);t.slots.default=()=>n},Eu=(t,e,n)=>{for(const r in e)(n||!Pa(r))&&(t[r]=e[r])},Af=(t,e,n)=>{const r=t.slots=gu();if(t.vnode.shapeFlag&32){const s=e._;s?(Eu(r,e,n),n&&Lc(r,"_",s,!0)):bu(e,r)}else e&&wu(t,e)},Of=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=Se;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:Eu(s,e,n):(i=!e.$stable,bu(e,s)),o=e}else e&&(wu(t,e),o={default:1});if(i)for(const a in s)!Pa(a)&&o[a]==null&&delete s[a]},ut=qf;function Cf(t){return If(t)}function If(t,e){const n=bi();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:d,nextSibling:h,setScopeId:f=Et,insertStaticContent:p}=t,y=(g,b,A,P=null,R=null,L=null,W=void 0,q=null,B=!!b.dynamicChildren)=>{if(g===b)return;g&&!Rr(g,b)&&(P=C(g),Ne(g,R,L,!0),g=null),b.patchFlag===-2&&(B=!1,b.dynamicChildren=null);const{type:U,ref:ie,shapeFlag:V}=b;switch(U){case Si:w(g,b,A,P);break;case en:v(g,b,A,P);break;case Vi:g==null&&m(b,A,P,W);break;case mt:ue(g,b,A,P,R,L,W,q,B);break;default:V&1?T(g,b,A,P,R,L,W,q,B):V&6?x(g,b,A,P,R,L,W,q,B):(V&64||V&128)&&U.process(g,b,A,P,R,L,W,q,B,X)}ie!=null&&R?qr(ie,g&&g.ref,L,b||g,!b):ie==null&&g&&g.ref!=null&&qr(g.ref,null,L,g,!0)},w=(g,b,A,P)=>{if(g==null)r(b.el=a(b.children),A,P);else{const R=b.el=g.el;b.children!==g.children&&u(R,b.children)}},v=(g,b,A,P)=>{g==null?r(b.el=l(b.children||""),A,P):b.el=g.el},m=(g,b,A,P)=>{[g.el,g.anchor]=p(g.children,b,A,P,g.el,g.anchor)},_=({el:g,anchor:b},A,P)=>{let R;for(;g&&g!==b;)R=h(g),r(g,A,P),g=R;r(b,A,P)},E=({el:g,anchor:b})=>{let A;for(;g&&g!==b;)A=h(g),s(g),g=A;s(b)},T=(g,b,A,P,R,L,W,q,B)=>{b.type==="svg"?W="svg":b.type==="math"&&(W="mathml"),g==null?S(b,A,P,R,L,W,q,B):I(g,b,R,L,W,q,B)},S=(g,b,A,P,R,L,W,q)=>{let B,U;const{props:ie,shapeFlag:V,transition:ee,dirs:le}=g;if(B=g.el=o(g.type,L,ie&&ie.is,ie),V&8?c(B,g.children):V&16&&N(g.children,B,null,P,R,Hi(g,L),W,q),le&&On(g,null,P,"created"),k(B,g,g.scopeId,W,P),ie){for(const Ce in ie)Ce!=="value"&&!Fr(Ce)&&i(B,Ce,null,ie[Ce],L,P);"value"in ie&&i(B,"value",null,ie.value,L),(U=ie.onVnodeBeforeMount)&&Rt(U,P,g)}le&&On(g,null,P,"beforeMount");const ge=Rf(R,ee);ge&&ee.beforeEnter(B),r(B,b,A),((U=ie&&ie.onVnodeMounted)||ge||le)&&ut(()=>{U&&Rt(U,P,g),ge&&ee.enter(B),le&&On(g,null,P,"mounted")},R)},k=(g,b,A,P,R)=>{if(A&&f(g,A),P)for(let L=0;L<P.length;L++)f(g,P[L]);if(R){let L=R.subTree;if(b===L||Cu(L.type)&&(L.ssContent===b||L.ssFallback===b)){const W=R.vnode;k(g,W,W.scopeId,W.slotScopeIds,R.parent)}}},N=(g,b,A,P,R,L,W,q,B=0)=>{for(let U=B;U<g.length;U++){const ie=g[U]=q?pn(g[U]):Nt(g[U]);y(null,ie,b,A,P,R,L,W,q)}},I=(g,b,A,P,R,L,W)=>{const q=b.el=g.el;let{patchFlag:B,dynamicChildren:U,dirs:ie}=b;B|=g.patchFlag&16;const V=g.props||Se,ee=b.props||Se;let le;if(A&&Cn(A,!1),(le=ee.onVnodeBeforeUpdate)&&Rt(le,A,b,g),ie&&On(b,g,A,"beforeUpdate"),A&&Cn(A,!0),(V.innerHTML&&ee.innerHTML==null||V.textContent&&ee.textContent==null)&&c(q,""),U?Y(g.dynamicChildren,U,q,A,P,Hi(b,R),L):W||D(g,b,q,null,A,P,Hi(b,R),L,!1),B>0){if(B&16)Q(q,V,ee,A,R);else if(B&2&&V.class!==ee.class&&i(q,"class",null,ee.class,R),B&4&&i(q,"style",V.style,ee.style,R),B&8){const ge=b.dynamicProps;for(let Ce=0;Ce<ge.length;Ce++){const we=ge[Ce],rt=V[we],He=ee[we];(He!==rt||we==="value")&&i(q,we,rt,He,R,A)}}B&1&&g.children!==b.children&&c(q,b.children)}else!W&&U==null&&Q(q,V,ee,A,R);((le=ee.onVnodeUpdated)||ie)&&ut(()=>{le&&Rt(le,A,b,g),ie&&On(b,g,A,"updated")},P)},Y=(g,b,A,P,R,L,W)=>{for(let q=0;q<b.length;q++){const B=g[q],U=b[q],ie=B.el&&(B.type===mt||!Rr(B,U)||B.shapeFlag&198)?d(B.el):A;y(B,U,ie,null,P,R,L,W,!0)}},Q=(g,b,A,P,R)=>{if(b!==A){if(b!==Se)for(const L in b)!Fr(L)&&!(L in A)&&i(g,L,b[L],null,R,P);for(const L in A){if(Fr(L))continue;const W=A[L],q=b[L];W!==q&&L!=="value"&&i(g,L,q,W,R,P)}"value"in A&&i(g,"value",b.value,A.value,R)}},ue=(g,b,A,P,R,L,W,q,B)=>{const U=b.el=g?g.el:a(""),ie=b.anchor=g?g.anchor:a("");let{patchFlag:V,dynamicChildren:ee,slotScopeIds:le}=b;le&&(q=q?q.concat(le):le),g==null?(r(U,A,P),r(ie,A,P),N(b.children||[],A,ie,R,L,W,q,B)):V>0&&V&64&&ee&&g.dynamicChildren?(Y(g.dynamicChildren,ee,A,R,L,W,q),(b.key!=null||R&&b===R.subTree)&&Tu(g,b,!0)):D(g,b,A,ie,R,L,W,q,B)},x=(g,b,A,P,R,L,W,q,B)=>{b.slotScopeIds=q,g==null?b.shapeFlag&512?R.ctx.activate(b,A,P,W,B):$(b,A,P,R,L,W,B):re(g,b,B)},$=(g,b,A,P,R,L,W)=>{const q=g.component=Yf(g,P,R);if(uu(g)&&(q.ctx.renderer=X),Jf(q,!1,W),q.asyncDep){if(R&&R.registerDep(q,z,W),!g.el){const B=q.subTree=yt(en);v(null,B,b,A),g.placeholder=B.el}}else z(q,g,b,A,R,L,W)},re=(g,b,A)=>{const P=b.component=g.component;if(Bf(g,b,A))if(P.asyncDep&&!P.asyncResolved){O(P,b,A);return}else P.next=b,P.update();else b.el=g.el,P.vnode=b},z=(g,b,A,P,R,L,W)=>{const q=()=>{if(g.isMounted){let{next:V,bu:ee,u:le,parent:ge,vnode:Ce}=g;{const at=Su(g);if(at){V&&(V.el=Ce.el,O(g,V,W)),at.asyncDep.then(()=>{g.isUnmounted||q()});return}}let we=V,rt;Cn(g,!1),V?(V.el=Ce.el,O(g,V,W)):V=Ce,ee&&Di(ee),(rt=V.props&&V.props.onVnodeBeforeUpdate)&&Rt(rt,ge,V,Ce),Cn(g,!0);const He=Wi(g),_t=g.subTree;g.subTree=He,y(_t,He,d(_t.el),C(_t),g,R,L),V.el=He.el,we===null&&Mf(g,He.el),le&&ut(le,R),(rt=V.props&&V.props.onVnodeUpdated)&&ut(()=>Rt(rt,ge,V,Ce),R)}else{let V;const{el:ee,props:le}=b,{bm:ge,m:Ce,parent:we,root:rt,type:He}=g,_t=pr(b);if(Cn(g,!1),ge&&Di(ge),!_t&&(V=le&&le.onVnodeBeforeMount)&&Rt(V,we,b),Cn(g,!0),ee&&Pe){const at=()=>{g.subTree=Wi(g),Pe(ee,g.subTree,g,R,null)};_t&&He.__asyncHydrate?He.__asyncHydrate(ee,g,at):at()}else{rt.ce&&rt.ce._def.shadowRoot!==!1&&rt.ce._injectChildStyle(He);const at=g.subTree=Wi(g);y(null,at,A,P,g,R,L),b.el=at.el}if(Ce&&ut(Ce,R),!_t&&(V=le&&le.onVnodeMounted)){const at=b;ut(()=>Rt(V,we,at),R)}(b.shapeFlag&256||we&&pr(we.vnode)&&we.vnode.shapeFlag&256)&&g.a&&ut(g.a,R),g.isMounted=!0,b=A=P=null}};g.scope.on();const B=g.effect=new Bc(q);g.scope.off();const U=g.update=B.run.bind(B),ie=g.job=B.runIfDirty.bind(B);ie.i=g,ie.id=g.uid,B.scheduler=()=>Oa(ie),Cn(g,!0),U()},O=(g,b,A)=>{b.component=g;const P=g.vnode.props;g.vnode=b,g.next=null,Tf(g,b.props,P,A),Of(g,b.children,A),Qt(),ll(g),Zt()},D=(g,b,A,P,R,L,W,q,B=!1)=>{const U=g&&g.children,ie=g?g.shapeFlag:0,V=b.children,{patchFlag:ee,shapeFlag:le}=b;if(ee>0){if(ee&128){de(U,V,A,P,R,L,W,q,B);return}else if(ee&256){J(U,V,A,P,R,L,W,q,B);return}}le&8?(ie&16&&ae(U,R,L),V!==U&&c(A,V)):ie&16?le&16?de(U,V,A,P,R,L,W,q,B):ae(U,R,L,!0):(ie&8&&c(A,""),le&16&&N(V,A,P,R,L,W,q,B))},J=(g,b,A,P,R,L,W,q,B)=>{g=g||dr,b=b||dr;const U=g.length,ie=b.length,V=Math.min(U,ie);let ee;for(ee=0;ee<V;ee++){const le=b[ee]=B?pn(b[ee]):Nt(b[ee]);y(g[ee],le,A,null,R,L,W,q,B)}U>ie?ae(g,R,L,!0,!1,V):N(b,A,P,R,L,W,q,B,V)},de=(g,b,A,P,R,L,W,q,B)=>{let U=0;const ie=b.length;let V=g.length-1,ee=ie-1;for(;U<=V&&U<=ee;){const le=g[U],ge=b[U]=B?pn(b[U]):Nt(b[U]);if(Rr(le,ge))y(le,ge,A,null,R,L,W,q,B);else break;U++}for(;U<=V&&U<=ee;){const le=g[V],ge=b[ee]=B?pn(b[ee]):Nt(b[ee]);if(Rr(le,ge))y(le,ge,A,null,R,L,W,q,B);else break;V--,ee--}if(U>V){if(U<=ee){const le=ee+1,ge=le<ie?b[le].el:P;for(;U<=ee;)y(null,b[U]=B?pn(b[U]):Nt(b[U]),A,ge,R,L,W,q,B),U++}}else if(U>ee)for(;U<=V;)Ne(g[U],R,L,!0),U++;else{const le=U,ge=U,Ce=new Map;for(U=ge;U<=ee;U++){const lt=b[U]=B?pn(b[U]):Nt(b[U]);lt.key!=null&&Ce.set(lt.key,U)}let we,rt=0;const He=ee-ge+1;let _t=!1,at=0;const Cr=new Array(He);for(U=0;U<He;U++)Cr[U]=0;for(U=le;U<=V;U++){const lt=g[U];if(rt>=He){Ne(lt,R,L,!0);continue}let Ct;if(lt.key!=null)Ct=Ce.get(lt.key);else for(we=ge;we<=ee;we++)if(Cr[we-ge]===0&&Rr(lt,b[we])){Ct=we;break}Ct===void 0?Ne(lt,R,L,!0):(Cr[Ct-ge]=U+1,Ct>=at?at=Ct:_t=!0,y(lt,b[Ct],A,null,R,L,W,q,B),rt++)}const nl=_t?xf(Cr):dr;for(we=nl.length-1,U=He-1;U>=0;U--){const lt=ge+U,Ct=b[lt],rl=b[lt+1],sl=lt+1<ie?rl.el||rl.placeholder:P;Cr[U]===0?y(null,Ct,A,sl,R,L,W,q,B):_t&&(we<0||U!==nl[we]?Ee(Ct,A,sl,2):we--)}}},Ee=(g,b,A,P,R=null)=>{const{el:L,type:W,transition:q,children:B,shapeFlag:U}=g;if(U&6){Ee(g.component.subTree,b,A,P);return}if(U&128){g.suspense.move(b,A,P);return}if(U&64){W.move(g,b,A,X);return}if(W===mt){r(L,b,A);for(let V=0;V<B.length;V++)Ee(B[V],b,A,P);r(g.anchor,b,A);return}if(W===Vi){_(g,b,A);return}if(P!==2&&U&1&&q)if(P===0)q.beforeEnter(L),r(L,b,A),ut(()=>q.enter(L),R);else{const{leave:V,delayLeave:ee,afterLeave:le}=q,ge=()=>{g.ctx.isUnmounted?s(L):r(L,b,A)},Ce=()=>{L._isLeaving&&L[Qh](!0),V(L,()=>{ge(),le&&le()})};ee?ee(L,ge,Ce):Ce()}else r(L,b,A)},Ne=(g,b,A,P=!1,R=!1)=>{const{type:L,props:W,ref:q,children:B,dynamicChildren:U,shapeFlag:ie,patchFlag:V,dirs:ee,cacheIndex:le}=g;if(V===-2&&(R=!1),q!=null&&(Qt(),qr(q,null,A,g,!0),Zt()),le!=null&&(b.renderCache[le]=void 0),ie&256){b.ctx.deactivate(g);return}const ge=ie&1&&ee,Ce=!pr(g);let we;if(Ce&&(we=W&&W.onVnodeBeforeUnmount)&&Rt(we,b,g),ie&6)K(g.component,A,P);else{if(ie&128){g.suspense.unmount(A,P);return}ge&&On(g,null,b,"beforeUnmount"),ie&64?g.type.remove(g,b,A,X,P):U&&!U.hasOnce&&(L!==mt||V>0&&V&64)?ae(U,b,A,!1,!0):(L===mt&&V&384||!R&&ie&16)&&ae(B,b,A),P&&F(g)}(Ce&&(we=W&&W.onVnodeUnmounted)||ge)&&ut(()=>{we&&Rt(we,b,g),ge&&On(g,null,b,"unmounted")},A)},F=g=>{const{type:b,el:A,anchor:P,transition:R}=g;if(b===mt){j(A,P);return}if(b===Vi){E(g);return}const L=()=>{s(A),R&&!R.persisted&&R.afterLeave&&R.afterLeave()};if(g.shapeFlag&1&&R&&!R.persisted){const{leave:W,delayLeave:q}=R,B=()=>W(A,L);q?q(g.el,L,B):B()}else L()},j=(g,b)=>{let A;for(;g!==b;)A=h(g),s(g),g=A;s(b)},K=(g,b,A)=>{const{bum:P,scope:R,job:L,subTree:W,um:q,m:B,a:U}=g;ml(B),ml(U),P&&Di(P),R.stop(),L&&(L.flags|=8,Ne(W,g,b,A)),q&&ut(q,b),ut(()=>{g.isUnmounted=!0},b)},ae=(g,b,A,P=!1,R=!1,L=0)=>{for(let W=L;W<g.length;W++)Ne(g[W],b,A,P,R)},C=g=>{if(g.shapeFlag&6)return C(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const b=h(g.anchor||g.el),A=b&&b[Jh];return A?h(A):b};let H=!1;const M=(g,b,A)=>{g==null?b._vnode&&Ne(b._vnode,null,null,!0):y(b._vnode||null,g,b,null,null,null,A),b._vnode=g,H||(H=!0,ll(),ou(),H=!1)},X={p:y,um:Ne,m:Ee,r:F,mt:$,mc:N,pc:D,pbc:Y,n:C,o:t};let me,Pe;return e&&([me,Pe]=e(X)),{render:M,hydrate:me,createApp:bf(M,me)}}function Hi({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Cn({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Rf(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Tu(t,e,n=!1){const r=t.children,s=e.children;if(ce(r)&&ce(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=pn(s[i]),a.el=o.el),!n&&a.patchFlag!==-2&&Tu(o,a)),a.type===Si&&a.patchFlag!==-1&&(a.el=o.el),a.type===en&&!a.el&&(a.el=o.el)}}function xf(t){const e=t.slice(),n=[0];let r,s,i,o,a;const l=t.length;for(r=0;r<l;r++){const u=t[r];if(u!==0){if(s=n[n.length-1],t[s]<u){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function Su(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Su(e)}function ml(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Pf=Symbol.for("v-scx"),Lf=()=>gt(Pf);function bn(t,e,n){return ku(t,e,n)}function ku(t,e,n=Se){const{immediate:r,deep:s,flush:i,once:o}=n,a=Ke({},n),l=e&&r||!e&&i!=="post";let u;if(as){if(i==="sync"){const f=Lf();u=f.__watcherHandles||(f.__watcherHandles=[])}else if(!l){const f=()=>{};return f.stop=Et,f.resume=Et,f.pause=Et,f}}const c=et;a.call=(f,p,y)=>$t(f,c,p,y);let d=!1;i==="post"?a.scheduler=f=>{ut(f,c&&c.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(f,p)=>{p?f():Oa(f)}),a.augmentJob=f=>{e&&(f.flags|=4),d&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const h=Vh(t,e,a);return as&&(u?u.push(h):l&&h()),h}function Nf(t,e,n){const r=this.proxy,s=qe(t)?t.includes(".")?Au(r,t):()=>r[t]:t.bind(r,r);let i;fe(e)?i=e:(i=e.handler,n=e);const o=ws(this),a=ku(s,i.bind(r),n);return o(),a}function Au(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}const jf=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${wn(e)}Modifiers`]||t[`${Wn(e)}Modifiers`];function $f(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Se;let s=n;const i=e.startsWith("update:"),o=i&&jf(r,e.slice(7));o&&(o.trim&&(s=n.map(c=>qe(c)?c.trim():c)),o.number&&(s=n.map(uh)));let a,l=r[a=Ui(e)]||r[a=Ui(wn(e))];!l&&i&&(l=r[a=Ui(Wn(e))]),l&&$t(l,t,6,s);const u=r[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,$t(u,t,6,s)}}const Uf=new WeakMap;function Ou(t,e,n=!1){const r=n?Uf:e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!fe(t)){const l=u=>{const c=Ou(u,e,!0);c&&(a=!0,Ke(o,c))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!a?(je(t)&&r.set(t,null),null):(ce(i)?i.forEach(l=>o[l]=null):Ke(o,i),je(t)&&r.set(t,o),o)}function Ti(t,e){return!t||!yi(e)?!1:(e=e.slice(2).replace(/Once$/,""),be(t,e[0].toLowerCase()+e.slice(1))||be(t,Wn(e))||be(t,e))}function Wi(t){const{type:e,vnode:n,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:d,data:h,setupState:f,ctx:p,inheritAttrs:y}=t,w=ti(t);let v,m;try{if(n.shapeFlag&4){const E=s||r,T=E;v=Nt(u.call(T,E,c,d,f,h,p)),m=a}else{const E=e;v=Nt(E.length>1?E(d,{attrs:a,slots:o,emit:l}):E(d,null)),m=e.props?a:Df(a)}}catch(E){Hr.length=0,wi(E,t,1),v=yt(en)}let _=v;if(m&&y!==!1){const E=Object.keys(m),{shapeFlag:T}=_;E.length&&T&7&&(i&&E.some(fa)&&(m=Ff(m,i)),_=vr(_,m,!1,!0))}return n.dirs&&(_=vr(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&Ia(_,n.transition),v=_,ti(w),v}const Df=t=>{let e;for(const n in t)(n==="class"||n==="style"||yi(n))&&((e||(e={}))[n]=t[n]);return e},Ff=(t,e)=>{const n={};for(const r in t)(!fa(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function Bf(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?gl(r,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let d=0;d<c.length;d++){const h=c[d];if(o[h]!==r[h]&&!Ti(u,h))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?gl(r,o,u):!0:!!o;return!1}function gl(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Ti(n,i))return!0}return!1}function Mf({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const Cu=t=>t.__isSuspense;function qf(t,e){e&&e.pendingBranch?ce(t)?e.effects.push(...t):e.effects.push(t):Yh(t)}const mt=Symbol.for("v-fgt"),Si=Symbol.for("v-txt"),en=Symbol.for("v-cmt"),Vi=Symbol.for("v-stc"),Hr=[];let ht=null;function Te(t=!1){Hr.push(ht=t?null:[])}function Kf(){Hr.pop(),ht=Hr[Hr.length-1]||null}let is=1;function si(t,e=!1){is+=t,t<0&&ht&&e&&(ht.hasOnce=!0)}function Iu(t){return t.dynamicChildren=is>0?ht||dr:null,Kf(),is>0&&ht&&ht.push(t),t}function Be(t,e,n,r,s,i){return Iu(te(t,e,n,r,s,i,!0))}function tn(t,e,n,r,s){return Iu(yt(t,e,n,r,s,!0))}function os(t){return t?t.__v_isVNode===!0:!1}function Rr(t,e){return t.type===e.type&&t.key===e.key}const Ru=({key:t})=>t??null,Ks=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?qe(t)||$e(t)||fe(t)?{i:ze,r:t,k:e,f:!!n}:t:null);function te(t,e=null,n=null,r=0,s=null,i=t===mt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ru(e),ref:e&&Ks(e),scopeId:lu,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ze};return a?(Na(l,n),i&128&&t.normalize(l)):n&&(l.shapeFlag|=qe(n)?8:16),is>0&&!o&&ht&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&ht.push(l),l}const yt=Hf;function Hf(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===df)&&(t=en),os(t)){const a=vr(t,e,!0);return n&&Na(a,n),is>0&&!i&&ht&&(a.shapeFlag&6?ht[ht.indexOf(t)]=a:ht.push(a)),a.patchFlag=-2,a}if(ep(t)&&(t=t.__vccOpts),e){e=Wf(e);let{class:a,style:l}=e;a&&!qe(a)&&(e.class=ya(a)),je(l)&&(ka(l)&&!ce(l)&&(l=Ke({},l)),e.style=ga(l))}const o=qe(t)?1:Cu(t)?128:Xh(t)?64:je(t)?4:fe(t)?2:0;return te(t,e,n,r,s,o,i,!0)}function Wf(t){return t?ka(t)||yu(t)?Ke({},t):t:null}function vr(t,e,n=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=t,u=e?Vf(s||{},e):s,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Ru(u),ref:e&&e.ref?n&&i?ce(i)?i.concat(Ks(e)):[i,Ks(e)]:Ks(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==mt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&vr(t.ssContent),ssFallback:t.ssFallback&&vr(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&r&&Ia(c,l.clone(c)),c}function ki(t=" ",e=0){return yt(Si,null,t,e)}function ft(t="",e=!1){return e?(Te(),tn(en,null,t)):yt(en,null,t)}function Nt(t){return t==null||typeof t=="boolean"?yt(en):ce(t)?yt(mt,null,t.slice()):os(t)?pn(t):yt(Si,null,String(t))}function pn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:vr(t)}function Na(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ce(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Na(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!yu(e)?e._ctx=ze:s===3&&ze&&(ze.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else fe(e)?(e={default:e,_ctx:ze},n=32):(e=String(e),r&64?(n=16,e=[ki(e)]):n=8);t.children=e,t.shapeFlag|=n}function Vf(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=ya([e.class,r.class]));else if(s==="style")e.style=ga([e.style,r.style]);else if(yi(s)){const i=e[s],o=r[s];o&&i!==o&&!(ce(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Rt(t,e,n,r=null){$t(t,e,7,[n,r])}const Gf=pu();let zf=0;function Yf(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||Gf,i={uid:zf++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Uc(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_u(r,s),emitsOptions:Ou(r,s),emit:null,emitted:null,propsDefaults:Se,inheritAttrs:r.inheritAttrs,ctx:Se,data:Se,props:Se,attrs:Se,slots:Se,refs:Se,setupState:Se,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=$f.bind(null,i),t.ce&&t.ce(i),i}let et=null;const xu=()=>et||ze;let ii,To;{const t=bi(),e=(n,r)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};ii=e("__VUE_INSTANCE_SETTERS__",n=>et=n),To=e("__VUE_SSR_SETTERS__",n=>as=n)}const ws=t=>{const e=et;return ii(t),t.scope.on(),()=>{t.scope.off(),ii(e)}},yl=()=>{et&&et.scope.off(),ii(null)};function Pu(t){return t.vnode.shapeFlag&4}let as=!1;function Jf(t,e=!1,n=!1){e&&To(e);const{props:r,children:s}=t.vnode,i=Pu(t);Ef(t,r,i,e),Af(t,s,n||e);const o=i?Xf(t,e):void 0;return e&&To(!1),o}function Xf(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,ff);const{setup:r}=n;if(r){Qt();const s=t.setupContext=r.length>1?Zf(t):null,i=ws(t),o=_s(r,t,0,[t.props,s]),a=Ic(o);if(Zt(),i(),(a||t.sp)&&!pr(t)&&cu(t),a){if(o.then(yl,yl),e)return o.then(l=>{vl(t,l,e)}).catch(l=>{wi(l,t,0)});t.asyncDep=o}else vl(t,o,e)}else Lu(t,e)}function vl(t,e,n){fe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:je(e)&&(t.setupState=ru(e)),Lu(t,n)}let _l;function Lu(t,e,n){const r=t.type;if(!t.render){if(!e&&_l&&!r.render){const s=r.template||xa(t).template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=r,u=Ke(Ke({isCustomElement:i,delimiters:a},o),l);r.render=_l(s,u)}}t.render=r.render||Et}{const s=ws(t);Qt();try{pf(t)}finally{Zt(),s()}}}const Qf={get(t,e){return Ve(t,"get",""),t[e]}};function Zf(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Qf),slots:t.slots,emit:t.emit,expose:e}}function Ai(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(ru(Aa(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Kr)return Kr[n](t)},has(e,n){return n in e||n in Kr}})):t.proxy}function ep(t){return fe(t)&&"__vccOpts"in t}const Oe=(t,e)=>Hh(t,e,as);function Nu(t,e,n){const r=(i,o,a)=>{si(-1);try{return yt(i,o,a)}finally{si(1)}},s=arguments.length;return s===2?je(e)&&!ce(e)?os(e)?r(t,null,[e]):r(t,e):r(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&os(n)&&(n=[n]),r(t,e,n))}const tp="3.5.21";/**
* @vue/runtime-dom v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let So;const bl=typeof window<"u"&&window.trustedTypes;if(bl)try{So=bl.createPolicy("vue",{createHTML:t=>t})}catch{}const ju=So?t=>So.createHTML(t):t=>t,np="http://www.w3.org/2000/svg",rp="http://www.w3.org/1998/Math/MathML",Kt=typeof document<"u"?document:null,wl=Kt&&Kt.createElement("template"),sp={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e==="svg"?Kt.createElementNS(np,t):e==="mathml"?Kt.createElementNS(rp,t):n?Kt.createElement(t,{is:n}):Kt.createElement(t);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>Kt.createTextNode(t),createComment:t=>Kt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Kt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{wl.innerHTML=ju(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=wl.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},ip=Symbol("_vtc");function op(t,e,n){const r=t[ip];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const oi=Symbol("_vod"),$u=Symbol("_vsh"),ja={name:"show",beforeMount(t,{value:e},{transition:n}){t[oi]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):xr(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:r}){!e!=!n&&(r?e?(r.beforeEnter(t),xr(t,!0),r.enter(t)):r.leave(t,()=>{xr(t,!1)}):xr(t,e))},beforeUnmount(t,{value:e}){xr(t,e)}};function xr(t,e){t.style.display=e?t[oi]:"none",t[$u]=!e}const ap=Symbol(""),lp=/(?:^|;)\s*display\s*:/;function cp(t,e,n){const r=t.style,s=qe(n);let i=!1;if(n&&!s){if(e)if(qe(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Hs(r,a,"")}else for(const o in e)n[o]==null&&Hs(r,o,"");for(const o in n)o==="display"&&(i=!0),Hs(r,o,n[o])}else if(s){if(e!==n){const o=r[ap];o&&(n+=";"+o),r.cssText=n,i=lp.test(n)}}else e&&t.removeAttribute("style");oi in t&&(t[oi]=i?r.display:"",t[$u]&&(r.display="none"))}const El=/\s*!important$/;function Hs(t,e,n){if(ce(n))n.forEach(r=>Hs(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=up(t,e);El.test(n)?t.setProperty(Wn(r),n.replace(El,""),"important"):t[r]=n}}const Tl=["Webkit","Moz","ms"],Gi={};function up(t,e){const n=Gi[e];if(n)return n;let r=wn(e);if(r!=="filter"&&r in t)return Gi[e]=r;r=Pc(r);for(let s=0;s<Tl.length;s++){const i=Tl[s]+r;if(i in t)return Gi[e]=i}return e}const Sl="http://www.w3.org/1999/xlink";function kl(t,e,n,r,s,i=gh(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Sl,e.slice(6,e.length)):t.setAttributeNS(Sl,e,n):n==null||i&&!Nc(n)?t.removeAttribute(e):t.setAttribute(e,i?"":rn(n)?String(n):n)}function Al(t,e,n,r,s){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?ju(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=Nc(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(s||e)}function dp(t,e,n,r){t.addEventListener(e,n,r)}function hp(t,e,n,r){t.removeEventListener(e,n,r)}const Ol=Symbol("_vei");function fp(t,e,n,r,s=null){const i=t[Ol]||(t[Ol]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=pp(e);if(r){const u=i[e]=yp(r,s);dp(t,a,u,l)}else o&&(hp(t,a,o,l),i[e]=void 0)}}const Cl=/(?:Once|Passive|Capture)$/;function pp(t){let e;if(Cl.test(t)){e={};let r;for(;r=t.match(Cl);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Wn(t.slice(2)),e]}let zi=0;const mp=Promise.resolve(),gp=()=>zi||(mp.then(()=>zi=0),zi=Date.now());function yp(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;$t(vp(r,n.value),e,5,[r])};return n.value=t,n.attached=gp(),n}function vp(t,e){if(ce(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Il=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,_p=(t,e,n,r,s,i)=>{const o=s==="svg";e==="class"?op(t,r,o):e==="style"?cp(t,n,r):yi(e)?fa(e)||fp(t,e,n,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):bp(t,e,r,o))?(Al(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&kl(t,e,r,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!qe(r))?Al(t,wn(e),r,i,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),kl(t,e,r,o))};function bp(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&Il(e)&&fe(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Il(e)&&qe(n)?!1:e in t}const wp=Ke({patchProp:_p},sp);let Rl;function Ep(){return Rl||(Rl=Cf(wp))}const Tp=(...t)=>{const e=Ep().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=kp(r);if(!s)return;const i=e._component;!fe(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,Sp(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Sp(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function kp(t){return qe(t)?document.querySelector(t):t}var Ap=!1;/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Uu;const Oi=t=>Uu=t,Du=Symbol();function ko(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Wr;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Wr||(Wr={}));function Op(){const t=Dc(!0),e=t.run(()=>Z({}));let n=[],r=[];const s=Aa({install(i){Oi(s),s._a=i,i.provide(Du,s),i.config.globalProperties.$pinia=s,r.forEach(o=>n.push(o)),r=[]},use(i){return!this._a&&!Ap?r.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return s}const Fu=()=>{};function xl(t,e,n,r=Fu){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),r())};return!n&&Fc()&&yh(s),s}function Jn(t,...e){t.slice().forEach(n=>{n(...e)})}const Cp=t=>t(),Pl=Symbol(),Yi=Symbol();function Ao(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,r)=>t.set(r,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],s=t[n];ko(s)&&ko(r)&&t.hasOwnProperty(n)&&!$e(r)&&!Un(r)?t[n]=Ao(s,r):t[n]=r}return t}const Ip=Symbol();function Rp(t){return!ko(t)||!t.hasOwnProperty(Ip)}const{assign:un}=Object;function xp(t){return!!($e(t)&&t.effect)}function Pp(t,e,n,r){const{state:s,actions:i,getters:o}=e,a=n.state.value[t];let l;function u(){a||(n.state.value[t]=s?s():{});const c=Bh(n.state.value[t]);return un(c,i,Object.keys(o||{}).reduce((d,h)=>(d[h]=Aa(Oe(()=>{Oi(n);const f=n._s.get(t);return o[h].call(f,f)})),d),{}))}return l=Bu(t,u,e,n,r,!0),l}function Bu(t,e,n={},r,s,i){let o;const a=un({actions:{}},n),l={deep:!0};let u,c,d=[],h=[],f;const p=r.state.value[t];!i&&!p&&(r.state.value[t]={}),Z({});let y;function w(N){let I;u=c=!1,typeof N=="function"?(N(r.state.value[t]),I={type:Wr.patchFunction,storeId:t,events:f}):(Ao(r.state.value[t],N),I={type:Wr.patchObject,payload:N,storeId:t,events:f});const Y=y=Symbol();bs().then(()=>{y===Y&&(u=!0)}),c=!0,Jn(d,I,r.state.value[t])}const v=i?function(){const{state:I}=n,Y=I?I():{};this.$patch(Q=>{un(Q,Y)})}:Fu;function m(){o.stop(),d=[],h=[],r._s.delete(t)}const _=(N,I="")=>{if(Pl in N)return N[Yi]=I,N;const Y=function(){Oi(r);const Q=Array.from(arguments),ue=[],x=[];function $(O){ue.push(O)}function re(O){x.push(O)}Jn(h,{args:Q,name:Y[Yi],store:T,after:$,onError:re});let z;try{z=N.apply(this&&this.$id===t?this:T,Q)}catch(O){throw Jn(x,O),O}return z instanceof Promise?z.then(O=>(Jn(ue,O),O)).catch(O=>(Jn(x,O),Promise.reject(O))):(Jn(ue,z),z)};return Y[Pl]=!0,Y[Yi]=I,Y},E={_p:r,$id:t,$onAction:xl.bind(null,h),$patch:w,$reset:v,$subscribe(N,I={}){const Y=xl(d,N,I.detached,()=>Q()),Q=o.run(()=>bn(()=>r.state.value[t],ue=>{(I.flush==="sync"?c:u)&&N({storeId:t,type:Wr.direct,events:f},ue)},un({},l,I)));return Y},$dispose:m},T=vs(E);r._s.set(t,T);const k=(r._a&&r._a.runWithContext||Cp)(()=>r._e.run(()=>(o=Dc()).run(()=>e({action:_}))));for(const N in k){const I=k[N];if($e(I)&&!xp(I)||Un(I))i||(p&&Rp(I)&&($e(I)?I.value=p[N]:Ao(I,p[N])),r.state.value[t][N]=I);else if(typeof I=="function"){const Y=_(I,N);k[N]=Y,a.actions[N]=I}}return un(T,k),un(ve(T),k),Object.defineProperty(T,"$state",{get:()=>r.state.value[t],set:N=>{w(I=>{un(I,N)})}}),r._p.forEach(N=>{un(T,o.run(()=>N({store:T,app:r._a,pinia:r,options:a})))}),p&&i&&n.hydrate&&n.hydrate(T.$state,p),u=!0,c=!0,T}/*! #__NO_SIDE_EFFECTS__ */function Mu(t,e,n){let r,s;const i=typeof e=="function";typeof t=="string"?(r=t,s=i?n:e):(s=t,r=t.id);function o(a,l){const u=wf();return a=a||(u?gt(Du,null):null),a&&Oi(a),a=Uu,a._s.has(r)||(i?Bu(r,e,s,a):Pp(r,s,a)),a._s.get(r)}return o.$id=r,o}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const ar=typeof document<"u";function qu(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Lp(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&qu(t.default)}const _e=Object.assign;function Ji(t,e){const n={};for(const r in e){const s=e[r];n[r]=At(s)?s.map(t):t(s)}return n}const Vr=()=>{},At=Array.isArray,Ku=/#/g,Np=/&/g,jp=/\//g,$p=/=/g,Up=/\?/g,Hu=/\+/g,Dp=/%5B/g,Fp=/%5D/g,Wu=/%5E/g,Bp=/%60/g,Vu=/%7B/g,Mp=/%7C/g,Gu=/%7D/g,qp=/%20/g;function $a(t){return encodeURI(""+t).replace(Mp,"|").replace(Dp,"[").replace(Fp,"]")}function Kp(t){return $a(t).replace(Vu,"{").replace(Gu,"}").replace(Wu,"^")}function Oo(t){return $a(t).replace(Hu,"%2B").replace(qp,"+").replace(Ku,"%23").replace(Np,"%26").replace(Bp,"`").replace(Vu,"{").replace(Gu,"}").replace(Wu,"^")}function Hp(t){return Oo(t).replace($p,"%3D")}function Wp(t){return $a(t).replace(Ku,"%23").replace(Up,"%3F")}function Vp(t){return t==null?"":Wp(t).replace(jp,"%2F")}function ls(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const Gp=/\/$/,zp=t=>t.replace(Gp,"");function Xi(t,e,n="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=t(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=Qp(r??e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:ls(o)}}function Yp(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Ll(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Jp(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&_r(e.matched[r],n.matched[s])&&zu(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function _r(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function zu(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Xp(t[n],e[n]))return!1;return!0}function Xp(t,e){return At(t)?Nl(t,e):At(e)?Nl(e,t):t===e}function Nl(t,e){return At(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function Qp(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=n.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const ln={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var cs;(function(t){t.pop="pop",t.push="push"})(cs||(cs={}));var Gr;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Gr||(Gr={}));function Zp(t){if(!t)if(ar){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),zp(t)}const em=/^[^#]+#/;function tm(t,e){return t.replace(em,"#")+e}function nm(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Ci=()=>({left:window.scrollX,top:window.scrollY});function rm(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=nm(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function jl(t,e){return(history.state?history.state.position-e:-1)+t}const Co=new Map;function sm(t,e){Co.set(t,e)}function im(t){const e=Co.get(t);return Co.delete(t),e}let om=()=>location.protocol+"//"+location.host;function Yu(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),Ll(l,"")}return Ll(n,t)+r+s}function am(t,e,n,r){let s=[],i=[],o=null;const a=({state:h})=>{const f=Yu(t,location),p=n.value,y=e.value;let w=0;if(h){if(n.value=f,e.value=h,o&&o===p){o=null;return}w=y?h.position-y.position:0}else r(f);s.forEach(v=>{v(n.value,p,{delta:w,type:cs.pop,direction:w?w>0?Gr.forward:Gr.back:Gr.unknown})})};function l(){o=n.value}function u(h){s.push(h);const f=()=>{const p=s.indexOf(h);p>-1&&s.splice(p,1)};return i.push(f),f}function c(){const{history:h}=window;h.state&&h.replaceState(_e({},h.state,{scroll:Ci()}),"")}function d(){for(const h of i)h();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:u,destroy:d}}function $l(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?Ci():null}}function lm(t){const{history:e,location:n}=window,r={value:Yu(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,u,c){const d=t.indexOf("#"),h=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+l:om()+t+l;try{e[c?"replaceState":"pushState"](u,"",h),s.value=u}catch(f){console.error(f),n[c?"replace":"assign"](h)}}function o(l,u){const c=_e({},e.state,$l(s.value.back,l,s.value.forward,!0),u,{position:s.value.position});i(l,c,!0),r.value=l}function a(l,u){const c=_e({},s.value,e.state,{forward:l,scroll:Ci()});i(c.current,c,!0);const d=_e({},$l(r.value,l,null),{position:c.position+1},u);i(l,d,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function cm(t){t=Zp(t);const e=lm(t),n=am(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=_e({location:"",base:t,go:r,createHref:tm.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function um(t){return typeof t=="string"||t&&typeof t=="object"}function Ju(t){return typeof t=="string"||typeof t=="symbol"}const Xu=Symbol("");var Ul;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Ul||(Ul={}));function br(t,e){return _e(new Error,{type:t,[Xu]:!0},e)}function Bt(t,e){return t instanceof Error&&Xu in t&&(e==null||!!(t.type&e))}const Dl="[^/]+?",dm={sensitive:!1,strict:!1,start:!0,end:!0},hm=/[.+*?^${}()[\]/\\]/g;function fm(t,e){const n=_e({},dm,e),r=[];let s=n.start?"^":"";const i=[];for(const u of t){const c=u.length?[]:[90];n.strict&&!u.length&&(s+="/");for(let d=0;d<u.length;d++){const h=u[d];let f=40+(n.sensitive?.25:0);if(h.type===0)d||(s+="/"),s+=h.value.replace(hm,"\\$&"),f+=40;else if(h.type===1){const{value:p,repeatable:y,optional:w,regexp:v}=h;i.push({name:p,repeatable:y,optional:w});const m=v||Dl;if(m!==Dl){f+=10;try{new RegExp(`(${m})`)}catch(E){throw new Error(`Invalid custom RegExp for param "${p}" (${m}): `+E.message)}}let _=y?`((?:${m})(?:/(?:${m}))*)`:`(${m})`;d||(_=w&&u.length<2?`(?:/${_})`:"/"+_),w&&(_+="?"),s+=_,f+=20,w&&(f+=-8),y&&(f+=-20),m===".*"&&(f+=-50)}c.push(f)}r.push(c)}if(n.strict&&n.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function a(u){const c=u.match(o),d={};if(!c)return null;for(let h=1;h<c.length;h++){const f=c[h]||"",p=i[h-1];d[p.name]=f&&p.repeatable?f.split("/"):f}return d}function l(u){let c="",d=!1;for(const h of t){(!d||!c.endsWith("/"))&&(c+="/"),d=!1;for(const f of h)if(f.type===0)c+=f.value;else if(f.type===1){const{value:p,repeatable:y,optional:w}=f,v=p in u?u[p]:"";if(At(v)&&!y)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const m=At(v)?v.join("/"):v;if(!m)if(w)h.length<2&&(c.endsWith("/")?c=c.slice(0,-1):d=!0);else throw new Error(`Missing required param "${p}"`);c+=m}}return c||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function pm(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Qu(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=pm(r[n],s[n]);if(i)return i;n++}if(Math.abs(s.length-r.length)===1){if(Fl(r))return 1;if(Fl(s))return-1}return s.length-r.length}function Fl(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const mm={type:0,value:""},gm=/[a-zA-Z0-9_]/;function ym(t){if(!t)return[[]];if(t==="/")return[[mm]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${u}": ${f}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,u="",c="";function d(){u&&(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function h(){u+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:l==="/"?(u&&d(),o()):l===":"?(d(),n=1):h();break;case 4:h(),n=r;break;case 1:l==="("?n=2:gm.test(l)?h():(d(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:n=3:c+=l;break;case 3:d(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,c="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),d(),o(),s}function vm(t,e,n){const r=fm(ym(t.path),n),s=_e(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function _m(t,e){const n=[],r=new Map;e=Kl({strict:!1,end:!0,sensitive:!1},e);function s(d){return r.get(d)}function i(d,h,f){const p=!f,y=Ml(d);y.aliasOf=f&&f.record;const w=Kl(e,d),v=[y];if("alias"in d){const E=typeof d.alias=="string"?[d.alias]:d.alias;for(const T of E)v.push(Ml(_e({},y,{components:f?f.record.components:y.components,path:T,aliasOf:f?f.record:y})))}let m,_;for(const E of v){const{path:T}=E;if(h&&T[0]!=="/"){const S=h.record.path,k=S[S.length-1]==="/"?"":"/";E.path=h.record.path+(T&&k+T)}if(m=vm(E,h,w),f?f.alias.push(m):(_=_||m,_!==m&&_.alias.push(m),p&&d.name&&!ql(m)&&o(d.name)),Zu(m)&&l(m),y.children){const S=y.children;for(let k=0;k<S.length;k++)i(S[k],m,f&&f.children[k])}f=f||m}return _?()=>{o(_)}:Vr}function o(d){if(Ju(d)){const h=r.get(d);h&&(r.delete(d),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(d);h>-1&&(n.splice(h,1),d.record.name&&r.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return n}function l(d){const h=Em(d,n);n.splice(h,0,d),d.record.name&&!ql(d)&&r.set(d.record.name,d)}function u(d,h){let f,p={},y,w;if("name"in d&&d.name){if(f=r.get(d.name),!f)throw br(1,{location:d});w=f.record.name,p=_e(Bl(h.params,f.keys.filter(_=>!_.optional).concat(f.parent?f.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),d.params&&Bl(d.params,f.keys.map(_=>_.name))),y=f.stringify(p)}else if(d.path!=null)y=d.path,f=n.find(_=>_.re.test(y)),f&&(p=f.parse(y),w=f.record.name);else{if(f=h.name?r.get(h.name):n.find(_=>_.re.test(h.path)),!f)throw br(1,{location:d,currentLocation:h});w=f.record.name,p=_e({},h.params,d.params),y=f.stringify(p)}const v=[];let m=f;for(;m;)v.unshift(m.record),m=m.parent;return{name:w,path:y,params:p,matched:v,meta:wm(v)}}t.forEach(d=>i(d));function c(){n.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:c,getRoutes:a,getRecordMatcher:s}}function Bl(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function Ml(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:bm(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function bm(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function ql(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function wm(t){return t.reduce((e,n)=>_e(e,n.meta),{})}function Kl(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function Em(t,e){let n=0,r=e.length;for(;n!==r;){const i=n+r>>1;Qu(t,e[i])<0?r=i:n=i+1}const s=Tm(t);return s&&(r=e.lastIndexOf(s,r-1)),r}function Tm(t){let e=t;for(;e=e.parent;)if(Zu(e)&&Qu(t,e)===0)return e}function Zu({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function Sm(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(Hu," "),o=i.indexOf("="),a=ls(o<0?i:i.slice(0,o)),l=o<0?null:ls(i.slice(o+1));if(a in e){let u=e[a];At(u)||(u=e[a]=[u]),u.push(l)}else e[a]=l}return e}function Hl(t){let e="";for(let n in t){const r=t[n];if(n=Hp(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(At(r)?r.map(i=>i&&Oo(i)):[r&&Oo(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function km(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=At(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const Am=Symbol(""),Wl=Symbol(""),Ii=Symbol(""),Ua=Symbol(""),Io=Symbol("");function Pr(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function mn(t,e,n,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const u=h=>{h===!1?l(br(4,{from:n,to:e})):h instanceof Error?l(h):um(h)?l(br(2,{from:e,to:h})):(o&&r.enterCallbacks[s]===o&&typeof h=="function"&&o.push(h),a())},c=i(()=>t.call(r&&r.instances[s],e,n,u));let d=Promise.resolve(c);t.length<3&&(d=d.then(u)),d.catch(h=>l(h))})}function Qi(t,e,n,r,s=i=>i()){const i=[];for(const o of t)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(qu(l)){const c=(l.__vccOpts||l)[e];c&&i.push(mn(c,n,r,o,a,s))}else{let u=l();i.push(()=>u.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=Lp(c)?c.default:c;o.mods[a]=c,o.components[a]=d;const f=(d.__vccOpts||d)[e];return f&&mn(f,n,r,o,a,s)()}))}}return i}function Vl(t){const e=gt(Ii),n=gt(Ua),r=Oe(()=>{const l=Ae(t.to);return e.resolve(l)}),s=Oe(()=>{const{matched:l}=r.value,{length:u}=l,c=l[u-1],d=n.matched;if(!c||!d.length)return-1;const h=d.findIndex(_r.bind(null,c));if(h>-1)return h;const f=Gl(l[u-2]);return u>1&&Gl(c)===f&&d[d.length-1].path!==f?d.findIndex(_r.bind(null,l[u-2])):h}),i=Oe(()=>s.value>-1&&xm(n.params,r.value.params)),o=Oe(()=>s.value>-1&&s.value===n.matched.length-1&&zu(n.params,r.value.params));function a(l={}){if(Rm(l)){const u=e[Ae(t.replace)?"replace":"push"](Ae(t.to)).catch(Vr);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:Oe(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function Om(t){return t.length===1?t[0]:t}const Cm=ot({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Vl,setup(t,{slots:e}){const n=vs(Vl(t)),{options:r}=gt(Ii),s=Oe(()=>({[zl(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[zl(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&Om(e.default(n));return t.custom?i:Nu("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),Im=Cm;function Rm(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function xm(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!At(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Gl(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const zl=(t,e,n)=>t??e??n,Pm=ot({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=gt(Io),s=Oe(()=>t.route||r.value),i=gt(Wl,0),o=Oe(()=>{let u=Ae(i);const{matched:c}=s.value;let d;for(;(d=c[u])&&!d.components;)u++;return u}),a=Oe(()=>s.value.matched[o.value]);qs(Wl,Oe(()=>o.value+1)),qs(Am,a),qs(Io,s);const l=Z();return bn(()=>[l.value,a.value,t.name],([u,c,d],[h,f,p])=>{c&&(c.instances[d]=u,f&&f!==c&&u&&u===h&&(c.leaveGuards.size||(c.leaveGuards=f.leaveGuards),c.updateGuards.size||(c.updateGuards=f.updateGuards))),u&&c&&(!f||!_r(c,f)||!h)&&(c.enterCallbacks[d]||[]).forEach(y=>y(u))},{flush:"post"}),()=>{const u=s.value,c=t.name,d=a.value,h=d&&d.components[c];if(!h)return Yl(n.default,{Component:h,route:u});const f=d.props[c],p=f?f===!0?u.params:typeof f=="function"?f(u):f:null,w=Nu(h,_e({},p,e,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(d.instances[c]=null)},ref:l}));return Yl(n.default,{Component:w,route:u})||w}}});function Yl(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const ed=Pm;function Lm(t){const e=_m(t.routes,t),n=t.parseQuery||Sm,r=t.stringifyQuery||Hl,s=t.history,i=Pr(),o=Pr(),a=Pr(),l=Uh(ln);let u=ln;ar&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=Ji.bind(null,C=>""+C),d=Ji.bind(null,Vp),h=Ji.bind(null,ls);function f(C,H){let M,X;return Ju(C)?(M=e.getRecordMatcher(C),X=H):X=C,e.addRoute(X,M)}function p(C){const H=e.getRecordMatcher(C);H&&e.removeRoute(H)}function y(){return e.getRoutes().map(C=>C.record)}function w(C){return!!e.getRecordMatcher(C)}function v(C,H){if(H=_e({},H||l.value),typeof C=="string"){const b=Xi(n,C,H.path),A=e.resolve({path:b.path},H),P=s.createHref(b.fullPath);return _e(b,A,{params:h(A.params),hash:ls(b.hash),redirectedFrom:void 0,href:P})}let M;if(C.path!=null)M=_e({},C,{path:Xi(n,C.path,H.path).path});else{const b=_e({},C.params);for(const A in b)b[A]==null&&delete b[A];M=_e({},C,{params:d(b)}),H.params=d(H.params)}const X=e.resolve(M,H),me=C.hash||"";X.params=c(h(X.params));const Pe=Yp(r,_e({},C,{hash:Kp(me),path:X.path})),g=s.createHref(Pe);return _e({fullPath:Pe,hash:me,query:r===Hl?km(C.query):C.query||{}},X,{redirectedFrom:void 0,href:g})}function m(C){return typeof C=="string"?Xi(n,C,l.value.path):_e({},C)}function _(C,H){if(u!==C)return br(8,{from:H,to:C})}function E(C){return k(C)}function T(C){return E(_e(m(C),{replace:!0}))}function S(C){const H=C.matched[C.matched.length-1];if(H&&H.redirect){const{redirect:M}=H;let X=typeof M=="function"?M(C):M;return typeof X=="string"&&(X=X.includes("?")||X.includes("#")?X=m(X):{path:X},X.params={}),_e({query:C.query,hash:C.hash,params:X.path!=null?{}:C.params},X)}}function k(C,H){const M=u=v(C),X=l.value,me=C.state,Pe=C.force,g=C.replace===!0,b=S(M);if(b)return k(_e(m(b),{state:typeof b=="object"?_e({},me,b.state):me,force:Pe,replace:g}),H||M);const A=M;A.redirectedFrom=H;let P;return!Pe&&Jp(r,X,M)&&(P=br(16,{to:A,from:X}),Ee(X,X,!0,!1)),(P?Promise.resolve(P):Y(A,X)).catch(R=>Bt(R)?Bt(R,2)?R:de(R):D(R,A,X)).then(R=>{if(R){if(Bt(R,2))return k(_e({replace:g},m(R.to),{state:typeof R.to=="object"?_e({},me,R.to.state):me,force:Pe}),H||A)}else R=ue(A,X,!0,g,me);return Q(A,X,R),R})}function N(C,H){const M=_(C,H);return M?Promise.reject(M):Promise.resolve()}function I(C){const H=j.values().next().value;return H&&typeof H.runWithContext=="function"?H.runWithContext(C):C()}function Y(C,H){let M;const[X,me,Pe]=Nm(C,H);M=Qi(X.reverse(),"beforeRouteLeave",C,H);for(const b of X)b.leaveGuards.forEach(A=>{M.push(mn(A,C,H))});const g=N.bind(null,C,H);return M.push(g),ae(M).then(()=>{M=[];for(const b of i.list())M.push(mn(b,C,H));return M.push(g),ae(M)}).then(()=>{M=Qi(me,"beforeRouteUpdate",C,H);for(const b of me)b.updateGuards.forEach(A=>{M.push(mn(A,C,H))});return M.push(g),ae(M)}).then(()=>{M=[];for(const b of Pe)if(b.beforeEnter)if(At(b.beforeEnter))for(const A of b.beforeEnter)M.push(mn(A,C,H));else M.push(mn(b.beforeEnter,C,H));return M.push(g),ae(M)}).then(()=>(C.matched.forEach(b=>b.enterCallbacks={}),M=Qi(Pe,"beforeRouteEnter",C,H,I),M.push(g),ae(M))).then(()=>{M=[];for(const b of o.list())M.push(mn(b,C,H));return M.push(g),ae(M)}).catch(b=>Bt(b,8)?b:Promise.reject(b))}function Q(C,H,M){a.list().forEach(X=>I(()=>X(C,H,M)))}function ue(C,H,M,X,me){const Pe=_(C,H);if(Pe)return Pe;const g=H===ln,b=ar?history.state:{};M&&(X||g?s.replace(C.fullPath,_e({scroll:g&&b&&b.scroll},me)):s.push(C.fullPath,me)),l.value=C,Ee(C,H,M,g),de()}let x;function $(){x||(x=s.listen((C,H,M)=>{if(!K.listening)return;const X=v(C),me=S(X);if(me){k(_e(me,{replace:!0,force:!0}),X).catch(Vr);return}u=X;const Pe=l.value;ar&&sm(jl(Pe.fullPath,M.delta),Ci()),Y(X,Pe).catch(g=>Bt(g,12)?g:Bt(g,2)?(k(_e(m(g.to),{force:!0}),X).then(b=>{Bt(b,20)&&!M.delta&&M.type===cs.pop&&s.go(-1,!1)}).catch(Vr),Promise.reject()):(M.delta&&s.go(-M.delta,!1),D(g,X,Pe))).then(g=>{g=g||ue(X,Pe,!1),g&&(M.delta&&!Bt(g,8)?s.go(-M.delta,!1):M.type===cs.pop&&Bt(g,20)&&s.go(-1,!1)),Q(X,Pe,g)}).catch(Vr)}))}let re=Pr(),z=Pr(),O;function D(C,H,M){de(C);const X=z.list();return X.length?X.forEach(me=>me(C,H,M)):console.error(C),Promise.reject(C)}function J(){return O&&l.value!==ln?Promise.resolve():new Promise((C,H)=>{re.add([C,H])})}function de(C){return O||(O=!C,$(),re.list().forEach(([H,M])=>C?M(C):H()),re.reset()),C}function Ee(C,H,M,X){const{scrollBehavior:me}=t;if(!ar||!me)return Promise.resolve();const Pe=!M&&im(jl(C.fullPath,0))||(X||!M)&&history.state&&history.state.scroll||null;return bs().then(()=>me(C,H,Pe)).then(g=>g&&rm(g)).catch(g=>D(g,C,H))}const Ne=C=>s.go(C);let F;const j=new Set,K={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,clearRoutes:e.clearRoutes,hasRoute:w,getRoutes:y,resolve:v,options:t,push:E,replace:T,go:Ne,back:()=>Ne(-1),forward:()=>Ne(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:z.add,isReady:J,install(C){const H=this;C.component("RouterLink",Im),C.component("RouterView",ed),C.config.globalProperties.$router=H,Object.defineProperty(C.config.globalProperties,"$route",{enumerable:!0,get:()=>Ae(l)}),ar&&!F&&l.value===ln&&(F=!0,E(s.location).catch(me=>{}));const M={};for(const me in ln)Object.defineProperty(M,me,{get:()=>l.value[me],enumerable:!0});C.provide(Ii,H),C.provide(Ua,eu(M)),C.provide(Io,l);const X=C.unmount;j.add(C),C.unmount=function(){j.delete(C),j.size<1&&(u=ln,x&&x(),x=null,l.value=ln,F=!1,O=!1),X()}}};function ae(C){return C.reduce((H,M)=>H.then(()=>I(M)),Promise.resolve())}return K}function Nm(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>_r(u,a))?r.push(a):n.push(a));const l=t.matched[o];l&&(e.matched.find(u=>_r(u,l))||s.push(l))}return[n,r,s]}function on(){return gt(Ii)}function td(t){return gt(Ua)}const jm="modulepreload",$m=function(t){return"/"+t},Jl={},En=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=$m(i),i in Jl)return;Jl[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=s.length-1;c>=0;c--){const d=s[c];if(d.href===i&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":jm,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((c,d)=>{u.addEventListener("load",c),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Um=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>En(()=>Promise.resolve().then(()=>Tr),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Da extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Dm extends Da{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Xl extends Da{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ql extends Da{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ro;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Ro||(Ro={}));var Fm=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};class Bm{constructor(e,{headers:n={},customFetch:r,region:s=Ro.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=Um(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return Fm(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=n;let a={},{region:l}=n;l||(l=this.region);const u=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const d=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:c}).catch(y=>{throw new Dm(y)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new Xl(d);if(!d.ok)throw new Ql(d);let f=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield d.json():f==="application/octet-stream"?p=yield d.blob():f==="text/event-stream"?p=d:f==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null,response:d}}catch(s){return{data:null,error:s,response:s instanceof Ql||s instanceof Xl?s.context:void 0}}})}}var vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var it={},Fa={},Ri={},Es={},xi={},Pi={},qm=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},wr=qm();const Km=wr.fetch,nd=wr.fetch.bind(wr),rd=wr.Headers,Hm=wr.Request,Wm=wr.Response,Tr=Object.freeze(Object.defineProperty({__proto__:null,Headers:rd,Request:Hm,Response:Wm,default:nd,fetch:Km},Symbol.toStringTag,{value:"Module"})),Vm=Mm(Tr);var Li={};Object.defineProperty(Li,"__esModule",{value:!0});let Gm=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Li.default=Gm;var sd=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pi,"__esModule",{value:!0});const zm=sd(Vm),Ym=sd(Li);let Jm=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=zm.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,l,u;let c=null,d=null,h=null,f=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const m=await i.text();m===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?d=m:d=JSON.parse(m))}const w=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const w=await i.text();try{c=JSON.parse(w),Array.isArray(c)&&i.status===404&&(d=[],c=null,f=200,p="OK")}catch{i.status===404&&w===""?(f=204,p="No Content"):c={message:w}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&this.shouldThrowOnError)throw new Ym.default(c)}return{error:c,data:d,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,a,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}returns(){return this}overrideTypes(){return this}};Pi.default=Jm;var Xm=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xi,"__esModule",{value:!0});const Qm=Xm(Pi);let Zm=class extends Qm.default{select(e){let n=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};xi.default=Zm;var eg=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Es,"__esModule",{value:!0});const tg=eg(xi);let ng=class extends tg.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Es.default=ng;var rg=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ri,"__esModule",{value:!0});const Lr=rg(Es);let sg=class{constructor(e,{headers:n={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=s}select(e,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new Lr.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var s;const i="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Lr.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){var o;const a="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Lr.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:n}={}){var r;const s="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Lr.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Lr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Ri.default=sg;var id=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Fa,"__esModule",{value:!0});const ig=id(Ri),og=id(Es);let ag=class od{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new ig.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new od(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(a="POST",u=n);const c=new Headers(this.headers);return i&&c.set("Prefer",`count=${i}`),new og.default({method:a,url:l,headers:c,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Fa.default=ag;var Sr=vt&&vt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(it,"__esModule",{value:!0});it.PostgrestError=it.PostgrestBuilder=it.PostgrestTransformBuilder=it.PostgrestFilterBuilder=it.PostgrestQueryBuilder=it.PostgrestClient=void 0;const ad=Sr(Fa);it.PostgrestClient=ad.default;const ld=Sr(Ri);it.PostgrestQueryBuilder=ld.default;const cd=Sr(Es);it.PostgrestFilterBuilder=cd.default;const ud=Sr(xi);it.PostgrestTransformBuilder=ud.default;const dd=Sr(Pi);it.PostgrestBuilder=dd.default;const hd=Sr(Li);it.PostgrestError=hd.default;var lg=it.default={PostgrestClient:ad.default,PostgrestQueryBuilder:ld.default,PostgrestFilterBuilder:cd.default,PostgrestTransformBuilder:ud.default,PostgrestBuilder:dd.default,PostgrestError:hd.default};const{PostgrestClient:cg,PostgrestQueryBuilder:nb,PostgrestFilterBuilder:rb,PostgrestTransformBuilder:sb,PostgrestBuilder:ib,PostgrestError:ob}=lg;class ug{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const dg="2.15.5",hg=`realtime-js/${dg}`,fg="1.0.0",xo=1e4,pg=1e3,mg=100;var zr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(zr||(zr={}));var De;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(De||(De={}));var wt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(wt||(wt={}));var Po;(function(t){t.websocket="websocket"})(Po||(Po={}));var Nn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Nn||(Nn={}));class gg{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const s=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class fd{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ie;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ie||(Ie={}));const Zl=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=yg(o,t,e,s),i),{})},yg=(t,e,n,r)=>{const s=e.find(a=>a.name===t),i=s==null?void 0:s.type,o=n[t];return i&&!r.includes(i)?pd(i,o):Lo(o)},pd=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return wg(e,n)}switch(t){case Ie.bool:return vg(e);case Ie.float4:case Ie.float8:case Ie.int2:case Ie.int4:case Ie.int8:case Ie.numeric:case Ie.oid:return _g(e);case Ie.json:case Ie.jsonb:return bg(e);case Ie.timestamp:return Eg(e);case Ie.abstime:case Ie.date:case Ie.daterange:case Ie.int4range:case Ie.int8range:case Ie.money:case Ie.reltime:case Ie.text:case Ie.time:case Ie.timestamptz:case Ie.timetz:case Ie.tsrange:case Ie.tstzrange:return Lo(e);default:return Lo(e)}},Lo=t=>t,vg=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},_g=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},bg=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},wg=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>pd(e,a))}return t},Eg=t=>typeof t=="string"?t.replace(" ","T"):t,md=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Zi{constructor(e,n,r={},s=xo){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ec;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ec||(ec={}));class Yr{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Yr.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Yr.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Yr.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(u,c)=>{o[u]||(l[u]=c)}),this.map(o,(u,c)=>{const d=i[u];if(d){const h=c.map(w=>w.presence_ref),f=d.map(w=>w.presence_ref),p=c.filter(w=>f.indexOf(w.presence_ref)<0),y=d.filter(w=>h.indexOf(w.presence_ref)<0);p.length>0&&(a[u]=p),y.length>0&&(l[u]=y)}else a[u]=c}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var u;const c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){const d=e[a].map(f=>f.presence_ref),h=c.filter(f=>d.indexOf(f.presence_ref)<0);e[a].unshift(...h)}r(a,c,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const c=l.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tc;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(tc||(tc={}));var Jr;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Jr||(Jr={}));var Ht;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ht||(Ht={}));class Ba{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=De.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Zi(this,wt.join,this.params,this.timeout),this.rejoinTimer=new fd(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=De.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=De.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=De.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=De.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=De.errored,this.rejoinTimer.scheduleTimeout())}),this._on(wt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Yr(this),this.broadcastEndpointURL=md(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==De.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,u=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&s!==void 0?s:[],c=!!this.bindings[Jr.PRESENCE]&&this.bindings[Jr.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},h={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:c}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(Ht.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(Ht.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket.setAuth(),f===void 0){e==null||e(Ht.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,w=(p=y==null?void 0:y.length)!==null&&p!==void 0?p:0,v=[];for(let m=0;m<w;m++){const _=y[m],{filter:{event:E,schema:T,table:S,filter:k}}=_,N=f&&f[m];if(N&&N.event===E&&N.schema===T&&N.table===S&&N.filter===k)v.push(Object.assign(Object.assign({},_),{id:N.id}));else{this.unsubscribe(),this.state=De.errored,e==null||e(Ht.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Ht.SUBSCRIBED);return}}).receive("error",f=>{this.state=De.errored,e==null||e(Ht.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ht.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===De.joined&&e===Jr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=De.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(wt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Zi(this,wt.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=De.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Zi(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>mg){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=wt;if(r&&[a,l,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let h=this._onMessage(o,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var p,y,w;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((w=(y=f.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(f=>f.callback(h,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,y,w,v,m,_;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const E=f.id,T=(p=f.filter)===null||p===void 0?void 0:p.event;return E&&((y=n.ids)===null||y===void 0?void 0:y.includes(E))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((w=n.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const E=(m=(v=f==null?void 0:f.filter)===null||v===void 0?void 0:v.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return E==="*"||E===((_=n==null?void 0:n.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:y,table:w,commit_timestamp:v,type:m,errors:_}=p;h=Object.assign(Object.assign({},{schema:y,table:w,commit_timestamp:v,eventType:m,new:{},old:{},errors:_}),this._getPayloadRecords(p))}f.callback(h,r)})}_isClosed(){return this.state===De.closed}_isJoined(){return this.state===De.joined}_isJoining(){return this.state===De.joining}_isLeaving(){return this.state===De.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Ba.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(wt.close,{},e)}_onError(e){this._on(wt.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=De.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Zl(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Zl(e.columns,e.old_record)),n}}const eo=()=>{},xs={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Tg=[1e3,2e3,5e3,1e4],Sg=1e4,kg=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ag{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xo,this.transport=null,this.heartbeatIntervalMs=xs.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=eo,this.ref=0,this.reconnectTimer=null,this.logger=eo,this.conn=null,this.sendBuffer=[],this.serializer=new gg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>En(()=>Promise.resolve().then(()=>Tr),void 0).then(({default:a})=>a(...o)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Po.websocket}`,this.httpEndpoint=md(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ug.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fg}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case zr.connecting:return Nn.Connecting;case zr.open:return Nn.Open;case zr.closing:return Nn.Closing;default:return Nn.Closed}}isConnected(){return this.connectionState()===Nn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Ba(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(pg,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},xs.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${r} ${s} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(s,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(wt.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([kg],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:hg};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(wt.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new fd(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xs.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,i,o,a,l,u,c;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:xo,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:xs.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:eo,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:d=>Tg[d-1]||Sg,this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(d,h)=>h(JSON.stringify(d)),this.decode=(c=e==null?void 0:e.decode)!==null&&c!==void 0?c:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Ma extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Fe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Og extends Ma{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class No extends Ma{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Cg=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};const gd=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>En(()=>Promise.resolve().then(()=>Tr),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Ig=()=>Cg(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield En(()=>Promise.resolve().then(()=>Tr),void 0)).Response:Response}),jo=t=>{if(Array.isArray(t))return t.map(n=>jo(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=jo(r)}),e},Rg=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Gn=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};const to=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),xg=(t,e,n)=>Gn(void 0,void 0,void 0,function*(){const r=yield Ig();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const i=t.status||500,o=(s==null?void 0:s.statusCode)||i+"";e(new Og(to(s),i,o))}).catch(s=>{e(new No(to(s),s))}):e(new No(to(t),t))}),Pg=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(Rg(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),n))};function Ts(t,e,n,r,s,i){return Gn(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(n,Pg(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>xg(l,a,r))})})}function ai(t,e,n,r){return Gn(this,void 0,void 0,function*(){return Ts(t,"GET",e,n,r)})}function Pt(t,e,n,r,s){return Gn(this,void 0,void 0,function*(){return Ts(t,"POST",e,r,s,n)})}function $o(t,e,n,r,s){return Gn(this,void 0,void 0,function*(){return Ts(t,"PUT",e,r,s,n)})}function Lg(t,e,n,r){return Gn(this,void 0,void 0,function*(){return Ts(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function yd(t,e,n,r,s){return Gn(this,void 0,void 0,function*(){return Ts(t,"DELETE",e,r,s,n)})}var Je=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};const Ng={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class jg{constructor(e,n={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=gd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,s){return Je(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},nc),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const u=this._removeEmptyFolders(n),c=this._getFinalPath(u),d=yield(e=="PUT"?$o:Pt)(this.fetch,`${this.url}/object/${c}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Fe(i))return{data:null,error:i};throw i}})}upload(e,n,r){return Je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,s){return Je(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",n);try{let l;const u=Object.assign({upsert:nc.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield $o(this.fetch,a.toString(),l,{headers:c});return{data:{path:i,fullPath:d.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Fe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return Je(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const i=yield Pt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Ma("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fe(r))return{data:null,error:r};throw r}})}update(e,n,r){return Je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Je(this,void 0,void 0,function*(){try{return{data:yield Pt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}})}copy(e,n,r){return Je(this,void 0,void 0,function*(){try{return{data:{path:(yield Pt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}})}createSignedUrl(e,n,r){return Je(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Pt(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,r){return Je(this,void 0,void 0,function*(){try{const s=yield Pt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}})}download(e,n){return Je(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ai(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fe(a))return{data:null,error:a};throw a}})}info(e){return Je(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield ai(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:jo(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fe(r))return{data:null,error:r};throw r}})}exists(e){return Je(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Lg(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fe(r)&&r instanceof No){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),s=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${u}`)}}}remove(e){return Je(this,void 0,void 0,function*(){try{return{data:yield yd(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}})}list(e,n,r){return Je(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Ng),n),{prefix:e||""});return{data:yield Pt(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}})}listV2(e,n){return Je(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Pt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fe(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const $g="2.12.1",Ug={"X-Client-Info":`storage-js/${$g}`};var Xn=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};class Dg{constructor(e,n={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Ug),n),this.fetch=gd(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Xn(this,void 0,void 0,function*(){try{return{data:yield ai(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Fe(e))return{data:null,error:e};throw e}})}getBucket(e){return Xn(this,void 0,void 0,function*(){try{return{data:yield ai(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Xn(this,void 0,void 0,function*(){try{return{data:yield Pt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fe(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Xn(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fe(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Xn(this,void 0,void 0,function*(){try{return{data:yield Pt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Xn(this,void 0,void 0,function*(){try{return{data:yield yd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}})}}class Fg extends Dg{constructor(e,n={},r,s){super(e,n,r,s)}from(e){return new jg(this.url,this.headers,e,this.fetch)}}const Bg="2.57.4";let $r="";typeof Deno<"u"?$r="deno":typeof document<"u"?$r="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$r="react-native":$r="node";const Mg={"X-Client-Info":`supabase-js-${$r}/${Bg}`},qg={headers:Mg},Kg={schema:"public"},Hg={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wg={};var Vg=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};const Gg=t=>{let e;return t?e=t:typeof fetch>"u"?e=nd:e=fetch,(...n)=>e(...n)},zg=()=>typeof Headers>"u"?rd:Headers,Yg=(t,e,n)=>{const r=Gg(n),s=zg();return(i,o)=>Vg(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var Jg=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};function Xg(t){return t.endsWith("/")?t:t+"/"}function Qg(t,e){var n,r;const{db:s,auth:i,realtime:o,global:a}=t,{db:l,auth:u,realtime:c,global:d}=e,h={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},c),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Jg(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function Zg(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Xg(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const vd="2.71.1",lr=30*1e3,Uo=3,no=Uo*lr,ey="http://localhost:9999",ty="supabase.auth.token",ny={"X-Client-Info":`gotrue-js/${vd}`},Do="X-Supabase-Api-Version",_d={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ry=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,sy=10*60*1e3;class qa extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function he(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class iy extends qa{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function oy(t){return he(t)&&t.name==="AuthApiError"}class bd extends qa{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class An extends qa{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class dn extends An{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ay(t){return he(t)&&t.name==="AuthSessionMissingError"}class Ps extends An{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ls extends An{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ns extends An{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ly(t){return he(t)&&t.name==="AuthImplicitGrantRedirectError"}class rc extends An{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fo extends An{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function ro(t){return he(t)&&t.name==="AuthRetryableFetchError"}class sc extends An{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Bo extends An{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ic=` 	
\r=`.split(""),cy=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ic.length;e+=1)t[ic[e].charCodeAt(0)]=-2;for(let e=0;e<li.length;e+=1)t[li[e].charCodeAt(0)]=e;return t})();function oc(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(li[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(li[r]),e.queuedBits-=6}}function wd(t,e,n){const r=cy[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ac(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{hy(o,r,n)};for(let o=0;o<t.length;o+=1)wd(t.charCodeAt(o),s,i);return e.join("")}function uy(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function dy(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}uy(r,e)}}function hy(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function fy(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)wd(t.charCodeAt(s),n,r);return new Uint8Array(e)}function py(t){const e=[];return dy(t,n=>e.push(n)),new Uint8Array(e)}function my(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>oc(s,n,r)),oc(null,n,r),e.join("")}function gy(t){return Math.round(Date.now()/1e3)+t}function yy(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const bt=()=>typeof window<"u"&&typeof document<"u",In={tested:!1,writable:!1},Ed=()=>{if(!bt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(In.tested)return In.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),In.tested=!0,In.writable=!0}catch{In.tested=!0,In.writable=!1}return In.writable};function vy(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const Td=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>En(()=>Promise.resolve().then(()=>Tr),void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},_y=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",cr=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Rn=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},cn=async(t,e)=>{await t.removeItem(e)};class Ni{constructor(){this.promise=new Ni.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Ni.promiseConstructor=Promise;function so(t){const e=t.split(".");if(e.length!==3)throw new Bo("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!ry.test(e[r]))throw new Bo("JWT not in base64url format");return{header:JSON.parse(ac(e[0])),payload:JSON.parse(ac(e[1])),signature:fy(e[2]),raw:{header:e[0],payload:e[1]}}}async function by(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function wy(t,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Ey(t){return("0"+t.toString(16)).substr(-2)}function Ty(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Ey).join("")}async function Sy(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function ky(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Sy(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qn(t,e,n=!1){const r=Ty();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await cr(t,`${e}-code-verifier`,s);const i=await ky(r);return[i,r===i?"plain":"s256"]}const Ay=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Oy(t){const e=t.headers.get(Do);if(!e||!e.match(Ay))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Cy(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Iy(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ry=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zn(t){if(!Ry.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function io(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function lc(t){return JSON.parse(JSON.stringify(t))}var xy=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const Ln=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Py=[502,503,504];async function cc(t){var e;if(!_y(t))throw new Fo(Ln(t),0);if(Py.includes(t.status))throw new Fo(Ln(t),t.status);let n;try{n=await t.json()}catch(i){throw new bd(Ln(i),i)}let r;const s=Oy(t);if(s&&s.getTime()>=_d["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new sc(Ln(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new dn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new sc(Ln(n),t.status,n.weak_password.reasons);throw new iy(Ln(n),t.status||500,r)}const Ly=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function pe(t,e,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Do]||(i[Do]=_d["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Ny(t,e,n+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Ny(t,e,n,r,s,i){const o=Ly(e,r,s,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new Fo(Ln(l),0)}if(a.ok||await cc(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await cc(l)}}function qt(t){var e;let n=null;Dy(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=gy(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function uc(t){const e=qt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function yn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function jy(t){return{data:t,error:null}}function $y(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=t,o=xy(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Uy(t){return t}function Dy(t){return t.access_token&&t.refresh_token&&t.expires_in}const oo=["global","local","others"];var Fy=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class By{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=Td(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=oo[0]){if(oo.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${oo.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:yn})}catch(r){if(he(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Fy(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:$y,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(he(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yn})}catch(n){if(he(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Uy});if(c.error)throw c.error;const d=await c.json(),h=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const y=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(p.split(";")[1].split("=")[1]);u[`${w}Page`]=y}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(he(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Zn(e);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yn})}catch(n){if(he(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Zn(e);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:yn})}catch(r){if(he(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Zn(e);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:yn})}catch(r){if(he(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Zn(e.userId);try{const{data:n,error:r}=await pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(he(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Zn(e.userId),Zn(e.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}}}function dc(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function My(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const er={debug:!!(globalThis&&Ed()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Sd extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qy extends Sd{}async function Ky(t,e,n){er.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),er.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){er.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{er.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw er.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new qy(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(er.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}My();const Hy={url:ey,storageKey:ty,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ny,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hc(t,e,n){return await n()}const tr={};class us{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=us.nextInstanceID,us.nextInstanceID+=1,this.instanceID>0&&bt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Hy),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new By({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Td(s.fetch),this.lock=s.lock||hc,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:bt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Ky:this.lock=hc,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Ed()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dc(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=dc(this.memoryStorage)),bt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=tr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){tr[this.storageKey]=Object.assign(Object.assign({},tr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=tr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){tr[this.storageKey]=Object.assign(Object.assign({},tr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${vd}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=vy(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),bt()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),ly(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return he(n)?{error:n}:{error:new bd("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:qt}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(he(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,s;try{let i;if("email"in e){const{email:c,password:d,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Qn(this.storage,this.storageKey)),i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},xform:qt})}else if("phone"in e){const{phone:c,password:d,options:h}=e;i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:qt})}else throw new Ls("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(he(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:uc})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:uc})}else throw new Ls("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ps}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,s,i,o,a,l,u,c,d,h,f;let p,y;if("message"in e)p=e.message,y=e.signature;else{const{chain:w,wallet:v,statement:m,options:_}=e;let E;if(bt())if(typeof v=="object")E=v;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))E=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=v}const T=new URL((n=_==null?void 0:_.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in E&&E.signIn){const S=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),m?{statement:m}:null));let k;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")k=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)k=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)p=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),y=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${T.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(s=(r=_==null?void 0:_.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((d=(c=_==null?void 0:_.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||d===void 0)&&d.length?["Resources",..._.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const S=await E.signMessage(new TextEncoder().encode(p),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=S}}try{const{data:w,error:v}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:my(y)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:qt});if(v)throw v;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new Ps}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:v})}catch(w){if(he(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const n=await Rn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:o}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:qt});if(await cn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ps}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(he(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=e,a=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:qt}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ps}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Qn(this.storage,this.storageKey));const{error:d}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Ls("You must provide either an email or phone number.")}catch(a){if(he(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,r;try{let s,i;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:qt});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(he(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Qn(this.storage,this.storageKey)),await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:jy})}catch(i){if(he(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new dn;const{error:s}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(he(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await pe(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await pe(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Ls("You must provide either an email or phone number and a type")}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Rn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<no:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Rn(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=io()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yn}):await this._useSession(async n=>{var r,s,i;const{data:o,error:a}=n;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dn}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:yn})})}catch(n){if(he(n))return ay(n)&&(await this._removeSession(),await cn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new dn;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Qn(this.storage,this.storageKey));const{data:u,error:c}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:yn});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(he(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new dn;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=so(e.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(he(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new dn;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!bt())throw new Ns("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ns(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new rc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ns("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new rc("No code detected.");const{data:m,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new Ns("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(a);let h=c+d;l&&(h=parseInt(l));const f=h-c;f*1e3<=lr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const p=h-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,c);const{data:y,error:w}=await this._getUser(i);if(w)throw w;const v={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:h,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(r){if(he(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Rn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(oy(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await cn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=yy(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Qn(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(he(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,u,c;const{data:d,error:h}=i;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return bt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(he(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await wy(async s=>(s>0&&await by(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:qt})),(s,i)=>{const o=200*Math.pow(2,s);return i&&ro(i)&&Date.now()+o-r<lr})}catch(r){if(this._debug(n,"error",r),he(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),bt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Rn(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Rn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await cr(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:io()}else if(s&&!s.user&&!s.user){const o=await Rn(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await cn(this.storage,this.storageKey+"-user"),await cr(this.storage,this.storageKey,s)):s.user=io()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<no;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${no}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),ro(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new dn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ni;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new dn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),he(i)){const o={session:null,error:i};return ro(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await cr(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=lc(s);await cr(this.storage,this.storageKey,i)}else{const s=lc(n);await cr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await cn(this.storage,this.storageKey),await cn(this.storage,this.storageKey+"-code-verifier"),await cn(this.storage,this.storageKey+"-user"),this.userStorage&&await cn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&bt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),lr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/lr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${lr}ms, refresh threshold is ${Uo} ticks`),s<=Uo&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Sd)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!bt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Qn(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(he(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:a}=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(n){if(he(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(he(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=so(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+sy>s)return r;const{data:i,error:o}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};r=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=so(r);n!=null&&n.allowExpired||Cy(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const c=Iy(s.alg),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,o,py(`${a}.${l}`)))throw new Bo("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}}}us.nextInstanceID=0;const Wy=us;class Vy extends Wy{constructor(e){super(e)}}var Gy=globalThis&&globalThis.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})};class zy{constructor(e,n,r){var s,i,o;this.supabaseUrl=e,this.supabaseKey=n;const a=Zg(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,u={db:Kg,realtime:Wg,auth:Object.assign(Object.assign({},Hg),{storageKey:l}),global:qg},c=Qg(r??{},u);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Yg(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new cg(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Fg(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Bm(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Gy(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:o,flowType:a,lock:l,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Vy({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:i,flowType:a,lock:l,debug:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ag(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Yy=(t,e,n)=>new zy(t,e,n);function Jy(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Jy()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const fc={url:"https://fqotyjqilndumvbbbzdb.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZxb3R5anFpbG5kdW12YmJiemRiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5MDI1OTUsImV4cCI6MjA3MzQ3ODU5NX0.ptgCn5HqEm5nxdHeMh9E0crWwEKPRDa1GzFEErqBebI"},se=Yy(fc.url,fc.anonKey,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Xy=`
-- Enable UUID extension
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Users table (extends Supabase auth.users)
CREATE TABLE IF NOT EXISTS public.users (
  id UUID REFERENCES auth.users(id) PRIMARY KEY,
  email TEXT UNIQUE NOT NULL,
  full_name TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Families table
CREATE TABLE IF NOT EXISTS public.families (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  name TEXT NOT NULL,
  family_code TEXT UNIQUE NOT NULL,
  created_by UUID REFERENCES public.users(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Family members table (junction table)
CREATE TABLE IF NOT EXISTS public.family_members (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES public.users(id) NOT NULL,
  family_id UUID REFERENCES public.families(id) ON DELETE CASCADE NOT NULL,
  role TEXT CHECK (role IN ('owner', 'member')) NOT NULL DEFAULT 'member',
  joined_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, family_id)
);

-- Accounts table
CREATE TABLE IF NOT EXISTS public.accounts (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  family_id UUID REFERENCES public.families(id) ON DELETE CASCADE NOT NULL,
  name TEXT NOT NULL,
  type TEXT CHECK (type IN ('cash', 'bank', 'credit', 'investment')) NOT NULL,
  balance DECIMAL(15,2) DEFAULT 0,
  created_by UUID REFERENCES public.users(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Categories table
CREATE TABLE IF NOT EXISTS public.categories (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  family_id UUID REFERENCES public.families(id) ON DELETE CASCADE NOT NULL,
  name TEXT NOT NULL,
  type TEXT CHECK (type IN ('income', 'expense')) NOT NULL,
  icon TEXT DEFAULT 'dollar-sign',
  color TEXT DEFAULT '#6B7280',
  created_by UUID REFERENCES public.users(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Transactions table
CREATE TABLE IF NOT EXISTS public.transactions (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  family_id UUID REFERENCES public.families(id) ON DELETE CASCADE NOT NULL,
  account_id UUID REFERENCES public.accounts(id) NOT NULL,
  category_id UUID REFERENCES public.categories(id) NOT NULL,
  type TEXT CHECK (type IN ('income', 'expense')) NOT NULL,
  amount DECIMAL(15,2) NOT NULL CHECK (amount > 0),
  description TEXT,
  date DATE NOT NULL DEFAULT CURRENT_DATE,
  created_by UUID REFERENCES public.users(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Budgets table
CREATE TABLE IF NOT EXISTS public.budgets (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  family_id UUID REFERENCES public.families(id) ON DELETE CASCADE NOT NULL,
  category_id UUID REFERENCES public.categories(id) NOT NULL,
  amount DECIMAL(15,2) NOT NULL CHECK (amount > 0),
  period TEXT CHECK (period IN ('monthly', 'yearly')) NOT NULL DEFAULT 'monthly',
  start_date DATE NOT NULL,
  end_date DATE NOT NULL,
  created_by UUID REFERENCES public.users(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Goals table
CREATE TABLE IF NOT EXISTS public.goals (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  family_id UUID REFERENCES public.families(id) ON DELETE CASCADE NOT NULL,
  name TEXT NOT NULL,
  description TEXT,
  target_amount DECIMAL(15,2) NOT NULL CHECK (target_amount > 0),
  current_amount DECIMAL(15,2) DEFAULT 0 CHECK (current_amount >= 0),
  target_date DATE,
  status TEXT CHECK (status IN ('active', 'completed', 'cancelled')) NOT NULL DEFAULT 'active',
  created_by UUID REFERENCES public.users(id) NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Function to generate family code
CREATE OR REPLACE FUNCTION generate_family_code()
RETURNS TEXT AS $$
DECLARE
  chars TEXT := 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  result TEXT := '';
  i INTEGER;
BEGIN
  FOR i IN 1..3 LOOP
    result := result || substr(chars, floor(random() * length(chars) + 1)::int, 1);
  END LOOP;
  result := result || '-';
  FOR i IN 1..3 LOOP
    result := result || substr(chars, floor(random() * length(chars) + 1)::int, 1);
  END LOOP;
  result := result || '-';
  FOR i IN 1..3 LOOP
    result := result || substr(chars, floor(random() * length(chars) + 1)::int, 1);
  END LOOP;
  RETURN result;
END;
$$ LANGUAGE plpgsql;

-- Trigger to auto-generate family code
CREATE OR REPLACE FUNCTION set_family_code()
RETURNS TRIGGER AS $$
BEGIN
  IF NEW.family_code IS NULL OR NEW.family_code = '' THEN
    NEW.family_code := generate_family_code();
    WHILE EXISTS (SELECT 1 FROM families WHERE family_code = NEW.family_code) LOOP
      NEW.family_code := generate_family_code();
    END LOOP;
  END IF;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_set_family_code
  BEFORE INSERT ON public.families
  FOR EACH ROW
  EXECUTE FUNCTION set_family_code();

-- Update timestamp triggers
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON public.users FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_families_updated_at BEFORE UPDATE ON public.families FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_accounts_updated_at BEFORE UPDATE ON public.accounts FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_categories_updated_at BEFORE UPDATE ON public.categories FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_transactions_updated_at BEFORE UPDATE ON public.transactions FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_budgets_updated_at BEFORE UPDATE ON public.budgets FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_goals_updated_at BEFORE UPDATE ON public.goals FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

-- Row Level Security (RLS) Policies
ALTER TABLE public.users ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.families ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.family_members ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.accounts ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.transactions ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.budgets ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.goals ENABLE ROW LEVEL SECURITY;

-- Users policies
CREATE POLICY "Users can view own data" ON public.users FOR SELECT USING (auth.uid() = id);
CREATE POLICY "Users can update own data" ON public.users FOR UPDATE USING (auth.uid() = id);

-- Family members policies
CREATE POLICY "Family members can view own memberships" ON public.family_members FOR SELECT USING (auth.uid() = user_id);
CREATE POLICY "Family owners can manage memberships" ON public.family_members FOR ALL USING (
  EXISTS (
    SELECT 1 FROM public.family_members fm 
    WHERE fm.family_id = family_members.family_id 
    AND fm.user_id = auth.uid() 
    AND fm.role = 'owner'
  )
);

-- Families policies
CREATE POLICY "Family members can view their family" ON public.families FOR SELECT USING (
  EXISTS (
    SELECT 1 FROM public.family_members fm 
    WHERE fm.family_id = families.id 
    AND fm.user_id = auth.uid()
  )
);
CREATE POLICY "Family owners can update their family" ON public.families FOR UPDATE USING (
  EXISTS (
    SELECT 1 FROM public.family_members fm 
    WHERE fm.family_id = families.id 
    AND fm.user_id = auth.uid() 
    AND fm.role = 'owner'
  )
);

-- Helper function for family access
CREATE OR REPLACE FUNCTION user_has_family_access(family_id_param UUID)
RETURNS BOOLEAN AS $$
BEGIN
  RETURN EXISTS (
    SELECT 1 FROM public.family_members fm
    WHERE fm.family_id = family_id_param
    AND fm.user_id = auth.uid()
  );
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- Accounts policies
CREATE POLICY "Family members can view family accounts" ON public.accounts FOR SELECT USING (user_has_family_access(family_id));
CREATE POLICY "Family members can create accounts" ON public.accounts FOR INSERT WITH CHECK (user_has_family_access(family_id) AND auth.uid() = created_by);
CREATE POLICY "Family members can update accounts" ON public.accounts FOR UPDATE USING (user_has_family_access(family_id));
CREATE POLICY "Family members can delete accounts" ON public.accounts FOR DELETE USING (user_has_family_access(family_id));

-- Categories policies
CREATE POLICY "Family members can view family categories" ON public.categories FOR SELECT USING (user_has_family_access(family_id));
CREATE POLICY "Family members can create categories" ON public.categories FOR INSERT WITH CHECK (user_has_family_access(family_id) AND auth.uid() = created_by);
CREATE POLICY "Family members can update categories" ON public.categories FOR UPDATE USING (user_has_family_access(family_id));
CREATE POLICY "Family members can delete categories" ON public.categories FOR DELETE USING (user_has_family_access(family_id));

-- Transactions policies
CREATE POLICY "Family members can view family transactions" ON public.transactions FOR SELECT USING (user_has_family_access(family_id));
CREATE POLICY "Family members can create transactions" ON public.transactions FOR INSERT WITH CHECK (user_has_family_access(family_id) AND auth.uid() = created_by);
CREATE POLICY "Family members can update own transactions" ON public.transactions FOR UPDATE USING (user_has_family_access(family_id) AND auth.uid() = created_by);
CREATE POLICY "Family members can delete own transactions" ON public.transactions FOR DELETE USING (user_has_family_access(family_id) AND auth.uid() = created_by);

-- Budgets policies
CREATE POLICY "Family members can view family budgets" ON public.budgets FOR SELECT USING (user_has_family_access(family_id));
CREATE POLICY "Family members can create budgets" ON public.budgets FOR INSERT WITH CHECK (user_has_family_access(family_id) AND auth.uid() = created_by);
CREATE POLICY "Family members can update budgets" ON public.budgets FOR UPDATE USING (user_has_family_access(family_id));
CREATE POLICY "Family members can delete budgets" ON public.budgets FOR DELETE USING (user_has_family_access(family_id));

-- Goals policies
CREATE POLICY "Family members can view family goals" ON public.goals FOR SELECT USING (user_has_family_access(family_id));
CREATE POLICY "Family members can create goals" ON public.goals FOR INSERT WITH CHECK (user_has_family_access(family_id) AND auth.uid() = created_by);
CREATE POLICY "Family members can update goals" ON public.goals FOR UPDATE USING (user_has_family_access(family_id));
CREATE POLICY "Family members can delete goals" ON public.goals FOR DELETE USING (user_has_family_access(family_id));

-- Insert default categories function
CREATE OR REPLACE FUNCTION create_default_categories(family_id_param UUID, user_id_param UUID)
RETURNS VOID AS $$
BEGIN
  -- Income categories
  INSERT INTO public.categories (family_id, name, type, icon, color, created_by) VALUES
  (family_id_param, 'Gaji', 'income', 'briefcase', '#10B981', user_id_param),
  (family_id_param, 'Bonus', 'income', 'gift', '#059669', user_id_param),
  (family_id_param, 'Investasi', 'income', 'trending-up', '#047857', user_id_param),
  (family_id_param, 'Lain-lain', 'income', 'plus-circle', '#065F46', user_id_param);
  
  -- Expense categories
  INSERT INTO public.categories (family_id, name, type, icon, color, created_by) VALUES
  (family_id_param, 'Makanan', 'expense', 'coffee', '#EF4444', user_id_param),
  (family_id_param, 'Transportasi', 'expense', 'car', '#DC2626', user_id_param),
  (family_id_param, 'Belanja', 'expense', 'shopping-bag', '#B91C1C', user_id_param),
  (family_id_param, 'Tagihan', 'expense', 'file-text', '#991B1B', user_id_param),
  (family_id_param, 'Kesehatan', 'expense', 'heart', '#7F1D1D', user_id_param),
  (family_id_param, 'Hiburan', 'expense', 'smile', '#F59E0B', user_id_param),
  (family_id_param, 'Lain-lain', 'expense', 'minus-circle', '#78716C', user_id_param);
END;
$$ LANGUAGE plpgsql;
`,Qy=Object.freeze(Object.defineProperty({__proto__:null,createDatabaseSchema:Xy,supabase:se},Symbol.toStringTag,{value:"Module"}));class Zy{async register(e){try{const{data:n,error:r}=await se.auth.signUp({email:e.email,password:e.password,options:{data:{full_name:e.full_name},emailRedirectTo:`${window.location.origin}/auth/confirm`}});return r?{data:null,error:r.message,status:400}:{data:null,error:null,status:201}}catch(n){return console.error("Registration error:",n),{data:null,error:"Terjadi kesalahan saat mendaftar",status:500}}}async login(e){try{const{data:n,error:r}=await se.auth.signInWithPassword({email:e.email,password:e.password});return r?{data:null,error:r.message,status:400}:n.user?{data:await this.getUserProfile(n.user.id),error:null,status:200}:{data:null,error:"Gagal masuk ke akun",status:400}}catch(n){return console.error("Login error:",n),{data:null,error:"Terjadi kesalahan saat masuk",status:500}}}async logout(){try{const{error:e}=await se.auth.signOut();return e?{data:null,error:e.message,status:400}:{data:null,error:null,status:200}}catch(e){return console.error("Logout error:",e),{data:null,error:"Terjadi kesalahan saat keluar",status:500}}}async getUserProfile(e){var n;try{await this.ensureUserProfile(e);const{data:r,error:s}=await se.from("users").select("*").eq("id",e).single();if(s)throw new Error("Failed to get user profile: "+s.message);const{data:i,error:o}=await se.from("family_members").select(`
          role,
          family:families(id, name, family_code)
        `).eq("user_id",e).maybeSingle();return o&&o.code!=="PGRST116"&&console.error("Error getting family membership:",o),{id:r.id,email:r.email,full_name:r.full_name,family_id:((n=i==null?void 0:i.family)==null?void 0:n.id)||null,role:(i==null?void 0:i.role)||null}}catch(r){throw console.error("Error getting user profile:",r),r}}async getCurrentUser(){try{const{data:{session:e}}=await se.auth.getSession();return e!=null&&e.user?await this.getUserProfile(e.user.id):null}catch(e){return console.error("Error getting current user:",e),null}}async resetPassword(e){try{const{error:n}=await se.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth/reset-password`});return n?{data:null,error:n.message,status:400}:{data:null,error:null,status:200}}catch(n){return console.error("Reset password error:",n),{data:null,error:"Terjadi kesalahan saat reset password",status:500}}}async updateProfile(e,n){try{const{error:r}=await se.from("users").update(n).eq("id",e);return r?{data:null,error:r.message,status:400}:{data:await this.getUserProfile(e),error:null,status:200}}catch(r){return console.error("Update profile error:",r),{data:null,error:"Terjadi kesalahan saat update profil",status:500}}}async ensureUserProfile(e){var n;try{const{data:r}=await se.from("users").select("id").eq("id",e).single();if(r)return;const{data:s}=await se.auth.getUser();if(!s.user||s.user.id!==e)throw new Error("Invalid auth user");const{error:i}=await se.from("users").insert({id:e,email:s.user.email||"",full_name:((n=s.user.user_metadata)==null?void 0:n.full_name)||"User"});if(i)throw new Error("Failed to create user profile: "+i.message)}catch(r){throw console.error("Error ensuring user profile:",r),r}}async checkUserFamily(e){try{const{data:n,error:r}=await se.from("family_members").select("id").eq("user_id",e).single();return!r&&!!n}catch{return!1}}}const nr=new Zy,Ut=Mu("auth",()=>{const t=Z(null),e=Z(!1),n=Z(null),r=Oe(()=>!!t.value),s=Oe(()=>{var f;return!!((f=t.value)!=null&&f.family_id)}),i=Oe(()=>{var f;return(f=t.value)==null?void 0:f.role});async function o(f){e.value=!0,n.value=null;try{const p=await nr.register(f);return p.error?(n.value=p.error,!1):(t.value=p.data,!0)}catch{return n.value="Terjadi kesalahan saat mendaftar",!1}finally{e.value=!1}}async function a(f){e.value=!0,n.value=null;try{const p=await nr.login(f);return p.error?(n.value=p.error,!1):(t.value=p.data,!0)}catch{return n.value="Terjadi kesalahan saat masuk",!1}finally{e.value=!1}}async function l(){e.value=!0,n.value=null;try{const f=await nr.logout();return f.error?(n.value=f.error,!1):(t.value=null,!0)}catch{return n.value="Terjadi kesalahan saat keluar",!1}finally{e.value=!1}}async function u(){e.value=!0;try{const f=await nr.getCurrentUser();t.value=f}catch(f){console.error("Error getting current user:",f),t.value=null}finally{e.value=!1}}async function c(f){if(!t.value)return!1;e.value=!0,n.value=null;try{const p=await nr.updateProfile(t.value.id,f);return p.error?(n.value=p.error,!1):(t.value=p.data,!0)}catch{return n.value="Terjadi kesalahan saat update profil",!1}finally{e.value=!1}}async function d(f){e.value=!0,n.value=null;try{const p=await nr.resetPassword(f);return p.error?(n.value=p.error,!1):!0}catch{return n.value="Terjadi kesalahan saat reset password",!1}finally{e.value=!1}}function h(){n.value=null}return{user:t,isLoading:e,error:n,isAuthenticated:r,hasFamily:s,userRole:i,register:o,login:a,logout:l,getCurrentUser:u,updateProfile:c,resetPassword:d,clearError:h}}),ev={id:"app"},tv=ot({__name:"App",setup(t){const e=Ut();return Ot(async()=>{await e.getCurrentUser()}),(n,r)=>(Te(),Be("div",ev,[yt(Ae(ed))]))}});const nv={key:0,class:"error-message"},rv={key:1,class:"loading-overlay"},sv=["innerHTML"],iv=ot({__name:"LoginView",setup(t){const e=Z(""),n=Ut(),r=on(),s=Z({email:"",password:""});Z(!1),Ot(async()=>{try{const u=await fetch("/src/templates/login.html");e.value=await u.text()}catch(u){console.error("Failed to load login template:",u)}}),bn(e,async u=>{u&&(await bs(),l())});const i=async u=>{if(u.preventDefault(),!s.value.email||!s.value.password)return;await n.login(s.value)&&(n.hasFamily?r.push("/dashboard"):r.push("/family/setup"))},o=()=>{r.push("/auth/register")},a=()=>{const u=document.getElementById("email"),c=document.getElementById("password");u&&c&&(u.value=s.value.email,c.value=s.value.password,u.addEventListener("input",d=>{s.value.email=d.target.value}),c.addEventListener("input",d=>{s.value.password=d.target.value}))},l=()=>{a();const u=document.querySelector(".auth-form"),c=document.querySelector(".link");u&&u.addEventListener("submit",i),c&&c.addEventListener("click",d=>{d.preventDefault(),o()})};return(u,c)=>(Te(),Be("div",null,[c[2]||(c[2]=te("link",{rel:"stylesheet",href:"/src/styles/auth.css"},null,-1)),Ae(n).error?(Te(),Be("div",nv,[ki(jt(Ae(n).error)+" ",1),te("button",{onClick:c[0]||(c[0]=(...d)=>Ae(n).clearError&&Ae(n).clearError(...d))},"")])):ft("",!0),Ae(n).isLoading?(Te(),Be("div",rv,[...c[1]||(c[1]=[te("div",{class:"loading-spinner"},null,-1),te("p",null,"Sedang masuk...",-1)])])):ft("",!0),te("div",{innerHTML:e.value},null,8,sv)]))}});const an=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},ov=an(iv,[["__scopeId","data-v-5aedf6dc"]]),av={key:0,class:"error-message"},lv={key:1,class:"error-message"},cv={key:2,class:"loading-overlay"},uv=["innerHTML"],dv=ot({__name:"RegisterView",setup(t){const e=Z(""),n=Ut(),r=on(),s=Z({full_name:"",email:"",password:""}),i=Z("");Z(!1),Z(!1),Ot(async()=>{try{const h=await fetch("/src/templates/register.html");e.value=await h.text()}catch(h){console.error("Failed to load register template:",h)}}),bn(e,async h=>{h&&(await bs(),d())});const o=()=>s.value.password===i.value,a=()=>s.value.full_name.trim()!==""&&s.value.email.trim()!==""&&s.value.password.length>=8&&o(),l=async h=>{if(h.preventDefault(),!a())return;await n.register(s.value)&&r.push("/family/setup")},u=()=>{r.push("/auth/login")},c=()=>{const h=document.getElementById("fullName"),f=document.getElementById("email"),p=document.getElementById("password"),y=document.getElementById("confirmPassword");h&&f&&p&&y&&(h.value=s.value.full_name,f.value=s.value.email,p.value=s.value.password,y.value=i.value,h.addEventListener("input",w=>{s.value.full_name=w.target.value}),f.addEventListener("input",w=>{s.value.email=w.target.value}),p.addEventListener("input",w=>{s.value.password=w.target.value}),y.addEventListener("input",w=>{i.value=w.target.value}))},d=()=>{c();const h=document.querySelector(".auth-form"),f=document.querySelector(".link");h&&h.addEventListener("submit",l),f&&f.addEventListener("click",p=>{p.preventDefault(),u()})};return(h,f)=>(Te(),Be("div",null,[f[2]||(f[2]=te("link",{rel:"stylesheet",href:"/src/styles/auth.css"},null,-1)),Ae(n).error?(Te(),Be("div",av,[ki(jt(Ae(n).error)+" ",1),te("button",{onClick:f[0]||(f[0]=(...p)=>Ae(n).clearError&&Ae(n).clearError(...p))},"")])):ft("",!0),!o()&&i.value?(Te(),Be("div",lv," Konfirmasi password tidak sesuai ")):ft("",!0),Ae(n).isLoading?(Te(),Be("div",cv,[...f[1]||(f[1]=[te("div",{class:"loading-spinner"},null,-1),te("p",null,"Sedang mendaftar...",-1)])])):ft("",!0),te("div",{innerHTML:e.value},null,8,uv)]))}});const hv=an(dv,[["__scopeId","data-v-893584d9"]]),fv={id:"email-confirm-root"},pv=ot({__name:"EmailConfirmView",setup(t){const e=on();async function n(r){return await(await fetch(r)).text()}return Ot(async()=>{const r=document.getElementById("email-confirm-root");if(!r)return;const s=await n("/src/templates/email_confirm.html");r.innerHTML=s;const i=r.querySelector(".confirm-status"),o=r.querySelector(".confirm-message"),a=r.querySelector(".success-icon"),l=r.querySelector(".error-icon"),u=r.querySelector(".go-login");i.style.display="none",a.style.display="none",l.style.display="none",u&&(u.style.display="none");try{const{data:c,error:d}=await se.auth.getSession();if(d)throw d;i.style.display="block",o.style.display="none",c.session?(a.style.display="flex",l.style.display="none",u&&(u.style.display="none"),setTimeout(()=>{e.push("/dashboard")},3e3)):(a.style.display="none",l.style.display="flex",u&&(u.style.display="inline-block"))}catch{i.style.display="block",a.style.display="none",l.style.display="flex",u&&(u.style.display="inline-block")}u&&u.addEventListener("click",()=>{e.push("/auth/login")})}),(r,s)=>(Te(),Be("div",fv))}});class mv{async getDashboardStats(e){try{const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),1),s=new Date(n.getFullYear(),n.getMonth()+1,0),{data:i,error:o}=await se.from("transactions").select(`
          *,
          account:accounts(name, type),
          category:categories(name, type, icon, color),
          user:users(full_name)
        `).eq("family_id",e).gte("date",r.toISOString().split("T")[0]).lte("date",s.toISOString().split("T")[0]).order("created_at",{ascending:!1});if(o)return{data:null,error:o.message,status:400};const a=i.filter(f=>f.type==="income").reduce((f,p)=>f+Number(p.amount),0),l=i.filter(f=>f.type==="expense").reduce((f,p)=>f+Number(p.amount),0),{data:u,error:c}=await se.from("accounts").select("balance").eq("family_id",e);if(c)return{data:null,error:c.message,status:400};const d=u.reduce((f,p)=>f+Number(p.balance),0),h=i.slice(0,5);return{data:{totalIncome:a,totalExpense:l,totalBalance:d,recentTransactions:h},error:null,status:200}}catch(n){return console.error("Error getting dashboard stats:",n),{data:null,error:"Terjadi kesalahan saat mengambil statistik",status:500}}}async getTransactions(e,n){try{let r=se.from("transactions").select(`
          *,
          account:accounts(name, type),
          category:categories(name, type, icon, color),
          user:users(full_name)
        `).eq("family_id",e);n!=null&&n.type&&n.type!=="all"&&(r=r.eq("type",n.type)),n!=null&&n.category_id&&(r=r.eq("category_id",n.category_id)),n!=null&&n.account_id&&(r=r.eq("account_id",n.account_id)),n!=null&&n.date_from&&(r=r.gte("date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("date",n.date_to)),n!=null&&n.member_id&&(r=r.eq("created_by",n.member_id));const{data:s,error:i}=await r.order("date",{ascending:!1});return i?{data:null,error:i.message,status:400}:{data:s||[],error:null,status:200}}catch(r){return console.error("Error getting transactions:",r),{data:null,error:"Terjadi kesalahan saat mengambil transaksi",status:500}}}async createTransaction(e,n,r){try{const{data:s,error:i}=await se.from("transactions").insert({...r,family_id:e,created_by:n}).select(`
          *,
          account:accounts(name, type),
          category:categories(name, type, icon, color),
          user:users(full_name)
        `).single();return i?{data:null,error:i.message,status:400}:(await this.updateAccountBalance(r.account_id,r.type,Number(r.amount)),{data:s,error:null,status:201})}catch(s){return console.error("Error creating transaction:",s),{data:null,error:"Terjadi kesalahan saat membuat transaksi",status:500}}}async updateTransaction(e,n){try{const{data:r}=await se.from("transactions").select("*").eq("id",e).single(),{data:s,error:i}=await se.from("transactions").update(n).eq("id",e).select(`
          *,
          account:accounts(name, type),
          category:categories(name, type, icon, color),
          user:users(full_name)
        `).single();return i?{data:null,error:i.message,status:400}:(r&&(n.amount||n.type)&&(await this.updateAccountBalance(r.account_id,r.type==="income"?"expense":"income",Number(r.amount)),await this.updateAccountBalance(s.account_id,s.type,Number(s.amount))),{data:s,error:null,status:200})}catch(r){return console.error("Error updating transaction:",r),{data:null,error:"Terjadi kesalahan saat mengupdate transaksi",status:500}}}async deleteTransaction(e){try{const{data:n}=await se.from("transactions").select("*").eq("id",e).single(),{error:r}=await se.from("transactions").delete().eq("id",e);return r?{data:null,error:r.message,status:400}:(n&&await this.updateAccountBalance(n.account_id,n.type==="income"?"expense":"income",Number(n.amount)),{data:null,error:null,status:200})}catch(n){return console.error("Error deleting transaction:",n),{data:null,error:"Terjadi kesalahan saat menghapus transaksi",status:500}}}async updateAccountBalance(e,n,r){try{const{data:s}=await se.from("accounts").select("balance").eq("id",e).single();if(s){const i=Number(s.balance),o=n==="income"?i+r:i-r;await se.from("accounts").update({balance:o}).eq("id",e)}}catch(s){console.error("Error updating account balance:",s)}}async getAccounts(e){try{const{data:n,error:r}=await se.from("accounts").select("*").eq("family_id",e).order("name");return r?{data:null,error:r.message,status:400}:{data:n||[],error:null,status:200}}catch(n){return console.error("Error getting accounts:",n),{data:null,error:"Terjadi kesalahan saat mengambil akun",status:500}}}async getCategories(e,n){try{let r=se.from("categories").select("*").eq("family_id",e);n&&(r=r.eq("type",n));const{data:s,error:i}=await r.order("name");return i?{data:null,error:i.message,status:400}:{data:s||[],error:null,status:200}}catch(r){return console.error("Error getting categories:",r),{data:null,error:"Terjadi kesalahan saat mengambil kategori",status:500}}}}const dt=new mv,xe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ue=Object.keys,Ye=Array.isArray;function nt(t,e){return typeof e!="object"||Ue(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||xe.Promise||(xe.Promise=Promise);const ds=Object.getPrototypeOf,gv={}.hasOwnProperty;function pt(t,e){return gv.call(t,e)}function Er(t,e){typeof e=="function"&&(e=e(ds(t))),(typeof Reflect>"u"?Ue:Reflect.ownKeys)(e).forEach(n=>{Jt(t,n,e[n])})}const kd=Object.defineProperty;function Jt(t,e,n,r){kd(t,e,nt(n&&pt(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function mr(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Jt(t.prototype,"constructor",t),{extend:Er.bind(null,t.prototype)}}}}const yv=Object.getOwnPropertyDescriptor;function Ka(t,e){let n;return yv(t,e)||(n=ds(t))&&Ka(n,e)}const vv=[].slice;function ci(t,e,n){return vv.call(t,e,n)}function Ad(t,e){return e(t)}function Ur(t){if(!t)throw new Error("Assertion Failed")}function Od(t){xe.setImmediate?setImmediate(t):setTimeout(t,0)}function Cd(t,e){return t.reduce((n,r,s)=>{var i=e(r,s);return i&&(n[i[0]]=i[1]),n},{})}function Xt(t,e){if(typeof e=="string"&&pt(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,s=e.length;r<s;++r){var i=Xt(t,e[r]);n.push(i)}return n}var o=e.indexOf(".");if(o!==-1){var a=t[e.substr(0,o)];return a==null?void 0:Xt(a,e.substr(o+1))}}function kt(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){Ur(typeof n!="string"&&"length"in n);for(var r=0,s=e.length;r<s;++r)kt(t,e[r],n[r])}else{var i=e.indexOf(".");if(i!==-1){var o=e.substr(0,i),a=e.substr(i+1);if(a==="")n===void 0?Ye(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=n;else{var l=t[o];l&&pt(t,o)||(l=t[o]={}),kt(l,a,n)}}else n===void 0?Ye(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Id(t){var e={};for(var n in t)pt(t,n)&&(e[n]=t[n]);return e}const _v=[].concat;function Rd(t){return _v.apply([],t)}const xd="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Rd([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>xe[t]),bv=xd.map(t=>xe[t]);Cd(xd,t=>[t,!0]);let gn=null;function Ss(t){gn=typeof WeakMap<"u"&&new WeakMap;const e=Mo(t);return gn=null,e}function Mo(t){if(!t||typeof t!="object")return t;let e=gn&&gn.get(t);if(e)return e;if(Ye(t)){e=[],gn&&gn.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Mo(t[n]))}else if(bv.indexOf(t.constructor)>=0)e=t;else{const i=ds(t);for(var s in e=i===Object.prototype?{}:Object.create(i),gn&&gn.set(t,e),t)pt(t,s)&&(e[s]=Mo(t[s]))}return e}const{toString:wv}={};function qo(t){return wv.call(t).slice(8,-1)}const Ko=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ev=typeof Ko=="symbol"?function(t){var e;return t!=null&&(e=t[Ko])&&e.apply(t)}:function(){return null},ur={};function zt(t){var e,n,r,s;if(arguments.length===1){if(Ye(t))return t.slice();if(this===ur&&typeof t=="string")return[t];if(s=Ev(t)){for(n=[];!(r=s.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const Ha=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Dt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Pd(t,e){Dt=t,Ld=e}var Ld=()=>!0;const Tv=!new Error("").stack;function zn(){if(Tv)try{throw zn.arguments,new Error}catch(t){return t}return new Error}function Ho(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Ld).map(r=>`
`+r).join("")):""}var Nd=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Wa=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Nd),Sv={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function gr(t,e){this._e=zn(),this.name=t,this.message=e}function jd(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,s)=>s.indexOf(n)===r).join(`
`)}function ui(t,e,n,r){this._e=zn(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=jd(t,e)}function Xr(t,e){this._e=zn(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=jd(t,e)}mr(gr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Ho(this._e,2))}},toString:function(){return this.name+": "+this.message}}),mr(ui).from(gr),mr(Xr).from(gr);var Va=Wa.reduce((t,e)=>(t[e]=e+"Error",t),{});const kv=gr;var oe=Wa.reduce((t,e)=>{var n=e+"Error";function r(s,i){this._e=zn(),this.name=n,s?typeof s=="string"?(this.message=`${s}${i?`
 `+i:""}`,this.inner=i||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=Sv[e]||n,this.inner=null)}return mr(r).from(kv),t[e]=r,t},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var pc=Nd.reduce((t,e)=>(t[e+"Error"]=oe[e],t),{}),Ws=Wa.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=oe[e]),t),{});function ke(){}function hs(t){return t}function Av(t,e){return t==null||t===hs?e:function(n){return e(t(n))}}function Kn(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Ov(t,e){return t===ke?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var i=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Kn(r,this.onsuccess):r),s&&(this.onerror=this.onerror?Kn(s,this.onerror):s),i!==void 0?i:n}}function Cv(t,e){return t===ke?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Kn(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Kn(r,this.onerror):r)}}function Iv(t,e){return t===ke?e:function(n){var r=t.apply(this,arguments);nt(n,r);var s=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Kn(s,this.onsuccess):s),i&&(this.onerror=this.onerror?Kn(i,this.onerror):i),r===void 0?o===void 0?void 0:o:nt(r,o)}}function Rv(t,e){return t===ke?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Ga(t,e){return t===ke?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,s=arguments.length,i=new Array(s);s--;)i[s]=arguments[s];return n.then(function(){return e.apply(r,i)})}return e.apply(this,arguments)}}Ws.ModifyError=ui,Ws.DexieError=gr,Ws.BulkError=Xr;var fs={};const $d=100,[Wo,di,Vo]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,ds(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ds(e),t]})(),Ud=di&&di.then,Vs=Wo&&Wo.constructor,za=!!Vo;var Go=!1,xv=Vo?()=>{Vo.then(js)}:xe.setImmediate?setImmediate.bind(null,js):xe.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{js(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(js,0)},Qr=function(t,e){Dr.push([t,e]),hi&&(xv(),hi=!1)},zo=!0,hi=!0,Fn=[],Gs=[],Yo=null,Jo=hs,yr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:yc,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{yc(t[0],t[1])}catch{}})}},ne=yr,Dr=[],Bn=0,zs=[];function G(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ke,this._lib=!1;var e=this._PSD=ne;if(Dt&&(this._stackHolder=zn(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==fs)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Qo(this,this._value))}this._state=null,this._value=null,++e.ref,Fd(this,t)}const Xo={get:function(){var t=ne,e=fi;function n(r,s){var i=!t.global&&(t!==ne||e!==fi);const o=i&&!nn();var a=new G((l,u)=>{Ya(this,new Dd(pi(r,t,i,o),pi(s,t,i,o),l,u,t))});return Dt&&qd(a,this),a}return n.prototype=fs,n},set:function(t){Jt(this,"then",t&&t.prototype===fs?Xo:{get:function(){return t},set:Xo.set})}};function Dd(t,e,n,r,s){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=s}function Fd(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&ks();n&&typeof n.then=="function"?Fd(t,(s,i)=>{n instanceof G?n._then(s,i):n.then(s,i)}):(t._state=!0,t._value=n,Bd(t)),r&&As()}},Qo.bind(null,t))}catch(n){Qo(t,n)}}function Qo(t,e){if(Gs.push(e),t._state===null){var n=t._lib&&ks();e=Jo(e),t._state=!1,t._value=e,Dt&&e!==null&&typeof e=="object"&&!e._promise&&function(r,s,i){try{r.apply(null,i)}catch(o){s&&s(o)}}(()=>{var r=Ka(e,"stack");e._promise=t,Jt(e,"stack",{get:()=>Go?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Fn.some(s=>s._value===r._value)||Fn.push(r)}(t),Bd(t),n&&As()}}function Bd(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Ya(t,e[n]);var s=t._PSD;--s.ref||s.finalize(),Bn===0&&(++Bn,Qr(()=>{--Bn==0&&Ja()},[]))}function Ya(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Bn,Qr(Pv,[n,t,e])}else t._listeners.push(e)}function Pv(t,e,n){try{Yo=e;var r,s=e._value;e._state?r=t(s):(Gs.length&&(Gs=[]),r=t(s),Gs.indexOf(s)===-1&&function(i){for(var o=Fn.length;o;)if(Fn[--o]._value===i._value)return void Fn.splice(o,1)}(e)),n.resolve(r)}catch(i){n.reject(i)}finally{Yo=null,--Bn==0&&Ja(),--n.psd.ref||n.psd.finalize()}}function Md(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var s,i,o=t._value;o!=null?(s=o.name||"Error",i=o.message||o,r=Ho(o,0)):(s=o,i=""),e.push(s+(i?": "+i:"")+r)}return Dt&&((r=Ho(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&Md(t._prev,e,n)),e}function qd(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function js(){ks()&&As()}function ks(){var t=zo;return zo=!1,hi=!1,t}function As(){var t,e,n;do for(;Dr.length>0;)for(t=Dr,Dr=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(Dr.length>0);zo=!0,hi=!0}function Ja(){var t=Fn;Fn=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=zs.slice(0),n=e.length;n;)e[--n]()}function $s(t){return new G(fs,!1,t)}function Le(t,e){var n=ne;return function(){var r=ks(),s=ne;try{return Sn(n,!0),t.apply(this,arguments)}catch(i){e&&e(i)}finally{Sn(s,!1),r&&As()}}}Er(G.prototype,{then:Xo,_then:function(t,e){Ya(this,new Dd(null,null,t,e,ne))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):$s(r)):this.then(null,r=>r&&r.name===e?n(r):$s(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),$s(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Go=!0;var t=Md(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{Go=!1}}},timeout:function(t,e){return t<1/0?new G((n,r)=>{var s=setTimeout(()=>r(new oe.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Jt(G.prototype,Symbol.toStringTag,"Dexie.Promise"),yr.env=Kd(),Er(G,{all:function(){var t=zt.apply(null,arguments).map(Us);return new G(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((s,i)=>G.resolve(s).then(o=>{t[i]=o,--r||e(t)},n))})},resolve:t=>{if(t instanceof G)return t;if(t&&typeof t.then=="function")return new G((n,r)=>{t.then(n,r)});var e=new G(fs,!0,t);return qd(e,Yo),e},reject:$s,race:function(){var t=zt.apply(null,arguments).map(Us);return new G((e,n)=>{t.map(r=>G.resolve(r).then(e,n))})},PSD:{get:()=>ne,set:t=>ne=t},totalEchoes:{get:()=>fi},newPSD:Tn,usePSD:Ar,scheduler:{get:()=>Qr,set:t=>{Qr=t}},rejectionMapper:{get:()=>Jo,set:t=>{Jo=t}},follow:(t,e)=>new G((n,r)=>Tn((s,i)=>{var o=ne;o.unhandleds=[],o.onunhandled=i,o.finalize=Kn(function(){(function(a){function l(){a(),zs.splice(zs.indexOf(l),1)}zs.push(l),++Bn,Qr(()=>{--Bn==0&&Ja()},[])})(()=>{this.unhandleds.length===0?s():i(this.unhandleds[0])})},o.finalize),t()},e,n,r))}),Vs&&(Vs.allSettled&&Jt(G,"allSettled",function(){const t=zt.apply(null,arguments).map(Us);return new G(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((s,i)=>G.resolve(s).then(o=>r[i]={status:"fulfilled",value:o},o=>r[i]={status:"rejected",reason:o}).then(()=>--n||e(r)))})}),Vs.any&&typeof AggregateError<"u"&&Jt(G,"any",function(){const t=zt.apply(null,arguments).map(Us);return new G((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const s=new Array(r);t.forEach((i,o)=>G.resolve(i).then(a=>e(a),a=>{s[o]=a,--r||n(new AggregateError(s))}))})}));const Ge={awaits:0,echoes:0,id:0};var Lv=0,Ys=[],ao=0,fi=0,Nv=0;function Tn(t,e,n,r){var s=ne,i=Object.create(s);i.parent=s,i.ref=0,i.global=!1,i.id=++Nv;var o=yr.env;i.env=za?{Promise:G,PromiseProp:{value:G,configurable:!0,writable:!0},all:G.all,race:G.race,allSettled:G.allSettled,any:G.any,resolve:G.resolve,reject:G.reject,nthen:mc(o.nthen,i),gthen:mc(o.gthen,i)}:{},e&&nt(i,e),++s.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Ar(i,t,n,r);return i.ref===0&&i.finalize(),a}function kr(){return Ge.id||(Ge.id=++Lv),++Ge.awaits,Ge.echoes+=$d,Ge.id}function nn(){return!!Ge.awaits&&(--Ge.awaits==0&&(Ge.id=0),Ge.echoes=Ge.awaits*$d,!0)}function Us(t){return Ge.echoes&&t&&t.constructor===Vs?(kr(),t.then(e=>(nn(),e),e=>(nn(),Me(e)))):t}function jv(t){++fi,Ge.echoes&&--Ge.echoes!=0||(Ge.echoes=Ge.id=0),Ys.push(ne),Sn(t,!0)}function $v(){var t=Ys[Ys.length-1];Ys.pop(),Sn(t,!1)}function Sn(t,e){var n=ne;if((e?!Ge.echoes||ao++&&t===ne:!ao||--ao&&t===ne)||Hd(e?jv.bind(null,t):$v),t!==ne&&(ne=t,n===yr&&(yr.env=Kd()),za)){var r=yr.env.Promise,s=t.env;di.then=s.nthen,r.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(xe,"Promise",s.PromiseProp),r.all=s.all,r.race=s.race,r.resolve=s.resolve,r.reject=s.reject,s.allSettled&&(r.allSettled=s.allSettled),s.any&&(r.any=s.any))}}function Kd(){var t=xe.Promise;return za?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(xe,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:di.then,gthen:t.prototype.then}:{}}function Ar(t,e,n,r,s){var i=ne;try{return Sn(t,!0),e(n,r,s)}finally{Sn(i,!1)}}function Hd(t){Ud.call(Wo,t)}function pi(t,e,n,r){return typeof t!="function"?t:function(){var s=ne;n&&kr(),Sn(e,!0);try{return t.apply(this,arguments)}finally{Sn(s,!1),r&&Hd(nn)}}}function mc(t,e){return function(n,r){return t.call(this,pi(n,e),pi(r,e))}}(""+Ud).indexOf("[native code]")===-1&&(kr=nn=ke);const gc="unhandledrejection";function yc(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,s={promise:e,reason:t};if(xe.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(gc,!0,!0),nt(r,s)):xe.CustomEvent&&nt(r=new CustomEvent(gc,{detail:s}),s),r&&xe.dispatchEvent&&(dispatchEvent(r),!xe.PromiseRejectionEvent&&xe.onunhandledrejection))try{xe.onunhandledrejection(r)}catch{}Dt&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Me=G.reject;function Zo(t,e,n,r){if(t.idbdb&&(t._state.openComplete||ne.letThrough||t._vip)){var s=t._createTransaction(e,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(i){return i.name===Va.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Zo(t,e,n,r))):Me(i)}return s._promise(e,(i,o)=>Tn(()=>(ne.trans=s,r(i,o,s)))).then(i=>s._completion.then(()=>i))}if(t._state.openComplete)return Me(new oe.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Me(new oe.DatabaseClosed);t.open().catch(ke)}return t._state.dbReadyPromise.then(()=>Zo(t,e,n,r))}const vc="3.2.7",jn=String.fromCharCode(65535),ea=-1/0,Mt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Wd="String expected.",Zr=[],ji=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Uv=ji,Dv=ji,Vd=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),$i="__dbnames",lo="readonly",co="readwrite";function Hn(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Gd={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ds(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Ss(e))[t],e)}class Fv{_trans(e,n,r){const s=this._tx||ne.trans,i=this.name;function o(l,u,c){if(!c.schema[i])throw new oe.NotFound("Table "+i+" not part of transaction");return n(c.idbtrans,c)}const a=ks();try{return s&&s.db===this.db?s===ne.trans?s._promise(e,o,r):Tn(()=>s._promise(e,o,r),{trans:s,transless:ne.transless||ne}):Zo(this.db,e,[this.name],o)}finally{a&&As()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(s=>this.hook.reading.fire(s))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Ye(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=Ue(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(u=>{if(u.compound&&n.every(c=>u.keyPath.indexOf(c)>=0)){for(let c=0;c<n.length;++c)if(n.indexOf(u.keyPath[c])===-1)return!1;return!0}return!1}).sort((u,c)=>u.keyPath.length-c.keyPath.length)[0];if(r&&this.db._maxKey!==jn){const u=r.keyPath.slice(0,n.length);return this.where(u).equals(u.map(c=>e[c]))}!r&&Dt&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,i=this.db._deps.indexedDB;function o(u,c){try{return i.cmp(u,c)===0}catch{return!1}}const[a,l]=n.reduce(([u,c],d)=>{const h=s[d],f=e[d];return[u||h,u||!h?Hn(c,h&&h.multi?p=>{const y=Xt(p,d);return Ye(y)&&y.some(w=>o(f,w))}:p=>o(f,Xt(p,d))):c]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Ye(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const s=Object.create(e.prototype);for(var i in r)if(pt(r,i))try{s[i]=r[i]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){nt(this,e)})}add(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let i=e;return s&&r&&(i=Ds(s)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:n!=null?[n]:null,values:[i]})).then(o=>o.numFailures?G.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{kt(e,s,o)}catch{}return o})}update(e,n){if(typeof e!="object"||Ye(e))return this.where(":id").equals(e).modify(n);{const r=Xt(e,this.schema.primKey.keyPath);if(r===void 0)return Me(new oe.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Ue(n).forEach(s=>{kt(e,s,n[s])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:s}=this.schema.primKey;let i=e;return s&&r&&(i=Ds(s)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[i],keys:n!=null?[n]:null})).then(o=>o.numFailures?G.reject(o.failures[0]):o.lastResult).then(o=>{if(s)try{kt(e,s,o)}catch{}return o})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?G.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Gd})).then(e=>e.numFailures?G.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(s=>this.hook.reading.fire(s))))}bulkAdd(e,n,r){const s=Array.isArray(n)?n:void 0,i=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&a?e.map(Ds(l)):e;return this.core.mutate({trans:o,type:"add",keys:s,values:c,wantResults:i}).then(({numFailures:d,results:h,lastResult:f,failures:p})=>{if(d===0)return i?h:f;throw new Xr(`${this.name}.bulkAdd(): ${d} of ${u} operations failed`,p)})})}bulkPut(e,n,r){const s=Array.isArray(n)?n:void 0,i=(r=r||(s?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",o=>{const{auto:a,keyPath:l}=this.schema.primKey;if(l&&s)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const u=e.length;let c=l&&a?e.map(Ds(l)):e;return this.core.mutate({trans:o,type:"put",keys:s,values:c,wantResults:i}).then(({numFailures:d,results:h,lastResult:f,failures:p})=>{if(d===0)return i?h:f;throw new Xr(`${this.name}.bulkPut(): ${d} of ${u} operations failed`,p)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:s,failures:i})=>{if(r===0)return s;throw new Xr(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,i)})}}function es(t){var e={},n=function(o,a){if(a){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return e[o].subscribe.apply(null,u),t}if(typeof o=="string")return e[o]};n.addEventType=i;for(var r=1,s=arguments.length;r<s;++r)i(arguments[r]);return n;function i(o,a,l){if(typeof o!="object"){var u;a||(a=Rv),l||(l=ke);var c={subscribers:[],fire:l,subscribe:function(d){c.subscribers.indexOf(d)===-1&&(c.subscribers.push(d),c.fire=a(c.fire,d))},unsubscribe:function(d){c.subscribers=c.subscribers.filter(function(h){return h!==d}),c.fire=c.subscribers.reduce(a,l)}};return e[o]=n[o]=c,c}Ue(u=o).forEach(function(d){var h=u[d];if(Ye(h))i(d,u[d][0],u[d][1]);else{if(h!=="asap")throw new oe.InvalidArgument("Invalid event config");var f=i(d,hs,function(){for(var p=arguments.length,y=new Array(p);p--;)y[p]=arguments[p];f.subscribers.forEach(function(w){Od(function(){w.apply(null,y)})})})}})}}function Nr(t,e){return mr(e).from({prototype:t}),e}function rr(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function uo(t,e){t.filter=Hn(t.filter,e)}function ho(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Hn(r(),e()):e,t.justLimit=n&&!r}function Js(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new oe.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function _c(t,e,n){const r=Js(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Fs(t,e,n,r){const s=t.replayFilter?Hn(t.filter,t.replayFilter()):t.filter;if(t.or){const i={},o=(a,l,u)=>{if(!s||s(l,u,h=>l.stop(h),h=>l.fail(h))){var c=l.primaryKey,d=""+c;d==="[object ArrayBuffer]"&&(d=""+new Uint8Array(c)),pt(i,d)||(i[d]=!0,e(a,l,u))}};return Promise.all([t.or._iterate(o,n),bc(_c(t,r,n),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}return bc(_c(t,r,n),Hn(t.algorithm,s),e,!t.keysOnly&&t.valueMapper)}function bc(t,e,n,r){var s=Le(r?(i,o,a)=>n(r(i),o,a):n);return t.then(i=>{if(i)return i.start(()=>{var o=()=>i.continue();e&&!e(i,a=>o=a,a=>{i.stop(a),o=ke},a=>{i.fail(a),o=ke})||s(i.value,i,a=>o=a),o()})})}function tt(t,e){try{const n=wc(t),r=wc(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(s,i){const o=s.length,a=i.length,l=o<a?o:a;for(let u=0;u<l;++u)if(s[u]!==i[u])return s[u]<i[u]?-1:1;return o===a?0:o<a?-1:1}(Ec(t),Ec(e));case"Array":return function(s,i){const o=s.length,a=i.length,l=o<a?o:a;for(let u=0;u<l;++u){const c=tt(s[u],i[u]);if(c!==0)return c}return o===a?0:o<a?-1:1}(t,e)}}catch{}return NaN}function wc(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=qo(t);return n==="ArrayBuffer"?"binary":n}function Ec(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Bv{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Me.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Me.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Hn(n.algorithm,e)}_iterate(e,n){return Fs(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&nt(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>Fs(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,s=r.table.core;if(rr(r,!0))return s.count({trans:n,query:{index:Js(r,s.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var i=0;return Fs(r,()=>(++i,!1),n,s).then(()=>i)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),s=r[0],i=r.length-1;function o(u,c){return c?o(u[r[c]],c-1):u[s]}var a=this._ctx.dir==="next"?1:-1;function l(u,c){var d=o(u,i),h=o(c,i);return d<h?-a:d>h?a:0}return this.toArray(function(u){return u.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&rr(r,!0)&&r.limit>0){const{valueMapper:s}=r,i=Js(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then(({result:o})=>s?o.map(s):o)}{const s=[];return Fs(r,i=>s.push(i),n,r.table.core).then(()=>s)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,rr(n)?ho(n,()=>{var r=e;return(s,i)=>r===0||(r===1?(--r,!1):(i(()=>{s.advance(r),r=0}),!1))}):ho(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),ho(this._ctx,()=>{var n=e;return function(r,s,i){return--n<=0&&s(i),n>=0}},!0),this}until(e,n){return uo(this._ctx,function(r,s,i){return!e(r.value)||(s(i),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return uo(this._ctx,function(s){return e(s.value)}),n=this._ctx,r=e,n.isMatch=Hn(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.key,s)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,s){e(s.primaryKey,s)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,i){r.push(i.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&rr(n,!0)&&n.limit>0)return this._read(s=>{var i=Js(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:i,range:n.range}})}).then(({result:s})=>s).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(s,i){r.push(i.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return uo(this._ctx,function(s){var i=s.primaryKey.toString(),o=pt(r,i);return r[i]=!0,!o}),this}modify(e){var n=this._ctx;return this._write(r=>{var s;if(typeof e=="function")s=e;else{var i=Ue(e),o=i.length;s=function(y){for(var w=!1,v=0;v<o;++v){var m=i[v],_=e[m];Xt(y,m)!==_&&(kt(y,m,_),w=!0)}return w}}const a=n.table.core,{outbound:l,extractKey:u}=a.schema.primaryKey,c=this.db._options.modifyChunkSize||200,d=[];let h=0;const f=[],p=(y,w)=>{const{failures:v,numFailures:m}=w;h+=y-m;for(let _ of Ue(v))d.push(v[_])};return this.clone().primaryKeys().then(y=>{const w=v=>{const m=Math.min(c,y.length-v);return a.getMany({trans:r,keys:y.slice(v,v+m),cache:"immutable"}).then(_=>{const E=[],T=[],S=l?[]:null,k=[];for(let I=0;I<m;++I){const Y=_[I],Q={value:Ss(Y),primKey:y[v+I]};s.call(Q,Q.value,Q)!==!1&&(Q.value==null?k.push(y[v+I]):l||tt(u(Y),u(Q.value))===0?(T.push(Q.value),l&&S.push(y[v+I])):(k.push(y[v+I]),E.push(Q.value)))}const N=rr(n)&&n.limit===1/0&&(typeof e!="function"||e===fo)&&{index:n.index,range:n.range};return Promise.resolve(E.length>0&&a.mutate({trans:r,type:"add",values:E}).then(I=>{for(let Y in I.failures)k.splice(parseInt(Y),1);p(E.length,I)})).then(()=>(T.length>0||N&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:S,values:T,criteria:N,changeSpec:typeof e!="function"&&e}).then(I=>p(T.length,I))).then(()=>(k.length>0||N&&e===fo)&&a.mutate({trans:r,type:"delete",keys:k,criteria:N}).then(I=>p(k.length,I))).then(()=>y.length>v+m&&w(v+c))})};return w(0).then(()=>{if(d.length>0)throw new ui("Error modifying one or more objects",d,h,f);return y.length})})})}delete(){var e=this._ctx,n=e.range;return rr(e)&&(e.isPrimKey&&!Dv||n.type===3)?this._write(r=>{const{primaryKey:s}=e.table.core.schema,i=n;return e.table.core.count({trans:r,query:{index:s,range:i}}).then(o=>e.table.core.mutate({trans:r,type:"deleteRange",range:i}).then(({failures:a,lastResult:l,results:u,numFailures:c})=>{if(c)throw new ui("Could not delete some values",Object.keys(a).map(d=>a[d]),o-c);return o-c}))}):this.modify(fo)}}const fo=(t,e)=>e.value=null;function Mv(t,e){return t<e?-1:t===e?0:1}function qv(t,e){return t>e?-1:t===e?0:1}function ct(t,e,n){var r=t instanceof Yd?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function sr(t){return new t.Collection(t,()=>zd("")).limit(0)}function Kv(t,e,n,r,s,i){for(var o=Math.min(t.length,r.length),a=-1,l=0;l<o;++l){var u=e[l];if(u!==r[l])return s(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):s(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;s(t[l],u)<0&&(a=l)}return o<r.length&&i==="next"?t+n.substr(t.length):o<t.length&&i==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function Bs(t,e,n,r){var s,i,o,a,l,u,c,d=n.length;if(!n.every(y=>typeof y=="string"))return ct(t,Wd);function h(y){s=function(v){return v==="next"?m=>m.toUpperCase():m=>m.toLowerCase()}(y),i=function(v){return v==="next"?m=>m.toLowerCase():m=>m.toUpperCase()}(y),o=y==="next"?Mv:qv;var w=n.map(function(v){return{lower:i(v),upper:s(v)}}).sort(function(v,m){return o(v.lower,m.lower)});a=w.map(function(v){return v.upper}),l=w.map(function(v){return v.lower}),u=y,c=y==="next"?"":r}h("next");var f=new t.Collection(t,()=>hn(a[0],l[d-1]+r));f._ondirectionchange=function(y){h(y)};var p=0;return f._addAlgorithm(function(y,w,v){var m=y.key;if(typeof m!="string")return!1;var _=i(m);if(e(_,l,p))return!0;for(var E=null,T=p;T<d;++T){var S=Kv(m,_,a[T],l[T],o,u);S===null&&E===null?p=T+1:(E===null||o(E,S)>0)&&(E=S)}return w(E!==null?function(){y.continue(E+c)}:v),!1}),f}function hn(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function zd(t){return{type:1,lower:t,upper:t}}class Yd{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,s){r=r!==!1,s=s===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||s)&&(!r||!s)?sr(this):new this.Collection(this,()=>hn(e,n,!r,!s))}catch{return ct(this,Mt)}}equals(e){return e==null?ct(this,Mt):new this.Collection(this,()=>zd(e))}above(e){return e==null?ct(this,Mt):new this.Collection(this,()=>hn(e,void 0,!0))}aboveOrEqual(e){return e==null?ct(this,Mt):new this.Collection(this,()=>hn(e,void 0,!1))}below(e){return e==null?ct(this,Mt):new this.Collection(this,()=>hn(void 0,e,!1,!0))}belowOrEqual(e){return e==null?ct(this,Mt):new this.Collection(this,()=>hn(void 0,e))}startsWith(e){return typeof e!="string"?ct(this,Wd):this.between(e,e+jn,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Bs(this,(n,r)=>n.indexOf(r[0])===0,[e],jn)}equalsIgnoreCase(e){return Bs(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=zt.apply(ur,arguments);return e.length===0?sr(this):Bs(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=zt.apply(ur,arguments);return e.length===0?sr(this):Bs(this,(n,r)=>r.some(s=>n.indexOf(s)===0),e,jn)}anyOf(){const e=zt.apply(ur,arguments);let n=this._cmp;try{e.sort(n)}catch{return ct(this,Mt)}if(e.length===0)return sr(this);const r=new this.Collection(this,()=>hn(e[0],e[e.length-1]));r._ondirectionchange=i=>{n=i==="next"?this._ascending:this._descending,e.sort(n)};let s=0;return r._addAlgorithm((i,o,a)=>{const l=i.key;for(;n(l,e[s])>0;)if(++s,s===e.length)return o(a),!1;return n(l,e[s])===0||(o(()=>{i.continue(e[s])}),!1)}),r}notEqual(e){return this.inAnyRange([[ea,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=zt.apply(ur,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return ct(this,Mt)}const n=e.reduce((r,s)=>r?r.concat([[r[r.length-1][1],s]]):[[ea,s]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,s=this._ascending,i=this._descending,o=this._min,a=this._max;if(e.length===0)return sr(this);if(!e.every(m=>m[0]!==void 0&&m[1]!==void 0&&s(m[0],m[1])<=0))return ct(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);const l=!n||n.includeLowers!==!1,u=n&&n.includeUppers===!0;let c,d=s;function h(m,_){return d(m[0],_[0])}try{c=e.reduce(function(m,_){let E=0,T=m.length;for(;E<T;++E){const S=m[E];if(r(_[0],S[1])<0&&r(_[1],S[0])>0){S[0]=o(S[0],_[0]),S[1]=a(S[1],_[1]);break}}return E===T&&m.push(_),m},[]),c.sort(h)}catch{return ct(this,Mt)}let f=0;const p=u?m=>s(m,c[f][1])>0:m=>s(m,c[f][1])>=0,y=l?m=>i(m,c[f][0])>0:m=>i(m,c[f][0])>=0;let w=p;const v=new this.Collection(this,()=>hn(c[0][0],c[c.length-1][1],!l,!u));return v._ondirectionchange=m=>{m==="next"?(w=p,d=s):(w=y,d=i),c.sort(h)},v._addAlgorithm((m,_,E)=>{for(var T=m.key;w(T);)if(++f,f===c.length)return _(E),!1;return!!function(S){return!p(S)&&!y(S)}(T)||(this._cmp(T,c[f][1])===0||this._cmp(T,c[f][0])===0||_(()=>{d===s?m.continue(c[f][0]):m.continue(c[f][1])}),!1)}),v}startsWithAnyOf(){const e=zt.apply(ur,arguments);return e.every(n=>typeof n=="string")?e.length===0?sr(this):this.inAnyRange(e.map(n=>[n,n+jn])):ct(this,"startsWithAnyOf() only works with strings")}}function Lt(t){return Le(function(e){return ps(e),t(e.target.error),!1})}function ps(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const ms="storagemutated",vn="x-storagemutated-1",kn=es(null,ms);class Hv{_lock(){return Ur(!ne.global),++this._reculock,this._reculock!==1||ne.global||(ne.lockOwnerFor=this),this}_unlock(){if(Ur(!ne.global),--this._reculock==0)for(ne.global||(ne.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Ar(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&ne.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(Ur(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(r);case"MissingAPIError":throw new oe.MissingAPI(r.message,r);default:throw new oe.OpenFailed(r)}if(!this.active)throw new oe.TransactionInactive;return Ur(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Le(s=>{ps(s),this._reject(e.error)}),e.onabort=Le(s=>{ps(s),this.active&&this._reject(new oe.Abort(e.error)),this.active=!1,this.on("abort").fire(s)}),e.oncomplete=Le(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&kn.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Me(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return Me(new oe.TransactionInactive);if(this._locked())return new G((i,o)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(i,o)},ne])});if(r)return Tn(()=>{var i=new G((o,a)=>{this._lock();const l=n(o,a,this);l&&l.then&&l.then(o,a)});return i.finally(()=>this._unlock()),i._lib=!0,i});var s=new G((i,o)=>{var a=n(i,o,this);a&&a.then&&a.then(i,o)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=G.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=o)})()}var i=n._waitingFor;return new G((o,a)=>{r.then(l=>n._waitingQueue.push(Le(o.bind(null,l))),l=>n._waitingQueue.push(Le(a.bind(null,l)))).finally(()=>{n._waitingFor===i&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(pt(n,e))return n[e];const r=this.schema[e];if(!r)throw new oe.NotFound("Table "+e+" not part of transaction");const s=new this.db.Table(e,r,this);return s.core=this.db.core.table(e),n[e]=s,s}}function ta(t,e,n,r,s,i,o){return{name:t,keyPath:e,unique:n,multi:r,auto:s,compound:i,src:(n&&!o?"&":"")+(r?"*":"")+(s?"++":"")+Jd(e)}}function Jd(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Xd(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Cd(n,r=>[r.name,r])}}let gs=t=>{try{return t.only([[]]),gs=()=>[[]],[[]]}catch{return gs=()=>jn,jn}};function na(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>Xt(r,e)}(t):e=>Xt(e,t)}function Tc(t){return[].slice.call(t)}let Wv=0;function ts(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function Vv(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:d,upperOpen:h}=l;return u===void 0?c===void 0?null:e.upperBound(c,!!h):c===void 0?e.lowerBound(u,!!d):e.bound(u,c,!!d,!!h)}const{schema:s,hasGetAll:i}=function(l,u){const c=Tc(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(d=>u.objectStore(d)).map(d=>{const{keyPath:h,autoIncrement:f}=d,p=Ye(h),y=h==null,w={},v={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y,compound:p,keyPath:h,autoIncrement:f,unique:!0,extractKey:na(h)},indexes:Tc(d.indexNames).map(m=>d.index(m)).map(m=>{const{name:_,unique:E,multiEntry:T,keyPath:S}=m,k={name:_,compound:Ye(S),keyPath:S,unique:E,multiEntry:T,extractKey:na(S)};return w[ts(S)]=k,k}),getIndexByKeyPath:m=>w[ts(m)]};return w[":id"]=v.primaryKey,h!=null&&(w[ts(h)]=v.primaryKey),v})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),o=s.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:d,type:h,keys:f,values:p,range:y}){return new Promise((w,v)=>{w=Le(w);const m=d.objectStore(c),_=m.keyPath==null,E=h==="put"||h==="add";if(!E&&h!=="delete"&&h!=="deleteRange")throw new Error("Invalid operation type: "+h);const{length:T}=f||p||{length:1};if(f&&p&&f.length!==p.length)throw new Error("Given keys array must have same length as given values array.");if(T===0)return w({numFailures:0,failures:{},results:[],lastResult:void 0});let S;const k=[],N=[];let I=0;const Y=ue=>{++I,ps(ue)};if(h==="deleteRange"){if(y.type===4)return w({numFailures:I,failures:N,results:[],lastResult:void 0});y.type===3?k.push(S=m.clear()):k.push(S=m.delete(r(y)))}else{const[ue,x]=E?_?[p,f]:[p,null]:[f,null];if(E)for(let $=0;$<T;++$)k.push(S=x&&x[$]!==void 0?m[h](ue[$],x[$]):m[h](ue[$])),S.onerror=Y;else for(let $=0;$<T;++$)k.push(S=m[h](ue[$])),S.onerror=Y}const Q=ue=>{const x=ue.target.result;k.forEach(($,re)=>$.error!=null&&(N[re]=$.error)),w({numFailures:I,failures:N,results:h==="delete"?f:k.map($=>$.result),lastResult:x})};S.onerror=ue=>{Y(ue),Q(ue)},S.onsuccess=Q})},getMany:({trans:d,keys:h})=>new Promise((f,p)=>{f=Le(f);const y=d.objectStore(c),w=h.length,v=new Array(w);let m,_=0,E=0;const T=k=>{const N=k.target;v[N._pos]=N.result,++E===_&&f(v)},S=Lt(p);for(let k=0;k<w;++k)h[k]!=null&&(m=y.get(h[k]),m._pos=k,m.onsuccess=T,m.onerror=S,++_);_===0&&f(v)}),get:({trans:d,key:h})=>new Promise((f,p)=>{f=Le(f);const y=d.objectStore(c).get(h);y.onsuccess=w=>f(w.target.result),y.onerror=Lt(p)}),query:function(d){return h=>new Promise((f,p)=>{f=Le(f);const{trans:y,values:w,limit:v,query:m}=h,_=v===1/0?void 0:v,{index:E,range:T}=m,S=y.objectStore(c),k=E.isPrimaryKey?S:S.index(E.name),N=r(T);if(v===0)return f({result:[]});if(d){const I=w?k.getAll(N,_):k.getAllKeys(N,_);I.onsuccess=Y=>f({result:Y.target.result}),I.onerror=Lt(p)}else{let I=0;const Y=w||!("openKeyCursor"in k)?k.openCursor(N):k.openKeyCursor(N),Q=[];Y.onsuccess=ue=>{const x=Y.result;return x?(Q.push(w?x.value:x.primaryKey),++I===v?f({result:Q}):void x.continue()):f({result:Q})},Y.onerror=Lt(p)}})}(i),openCursor:function({trans:d,values:h,query:f,reverse:p,unique:y}){return new Promise((w,v)=>{w=Le(w);const{index:m,range:_}=f,E=d.objectStore(c),T=m.isPrimaryKey?E:E.index(m.name),S=p?y?"prevunique":"prev":y?"nextunique":"next",k=h||!("openKeyCursor"in T)?T.openCursor(r(_),S):T.openKeyCursor(r(_),S);k.onerror=Lt(v),k.onsuccess=Le(N=>{const I=k.result;if(!I)return void w(null);I.___id=++Wv,I.done=!1;const Y=I.continue.bind(I);let Q=I.continuePrimaryKey;Q&&(Q=Q.bind(I));const ue=I.advance.bind(I),x=()=>{throw new Error("Cursor not stopped")};I.trans=d,I.stop=I.continue=I.continuePrimaryKey=I.advance=()=>{throw new Error("Cursor not started")},I.fail=Le(v),I.next=function(){let $=1;return this.start(()=>$--?this.continue():this.stop()).then(()=>this)},I.start=$=>{const re=new Promise((O,D)=>{O=Le(O),k.onerror=Lt(D),I.fail=D,I.stop=J=>{I.stop=I.continue=I.continuePrimaryKey=I.advance=x,O(J)}}),z=()=>{if(k.result)try{$()}catch(O){I.fail(O)}else I.done=!0,I.start=()=>{throw new Error("Cursor behind last entry")},I.stop()};return k.onsuccess=Le(O=>{k.onsuccess=z,z()}),I.continue=Y,I.continuePrimaryKey=Q,I.advance=ue,z(),re},w(I)},v)})},count({query:d,trans:h}){const{index:f,range:p}=d;return new Promise((y,w)=>{const v=h.objectStore(c),m=f.isPrimaryKey?v:v.index(f.name),_=r(p),E=_?m.count(_):m.count();E.onsuccess=Le(T=>y(T.target.result)),E.onerror=Lt(w)})}}}(l)),a={};return o.forEach(l=>a[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!a[l])throw new Error(`Table '${l}' not found`);return a[l]},MIN_KEY:-1/0,MAX_KEY:gs(e),schema:s}}function ra({_novip:t},e){const n=e.db,r=function(s,i,{IDBKeyRange:o,indexedDB:a},l){return{dbcore:function(c,d){return d.reduce((h,{create:f})=>({...h,...f(h)}),c)}(Vv(i,o,l),s.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(s=>{const i=s.name;t.core.schema.tables.some(o=>o.name===i)&&(s.core=t.core.table(i),t[i]instanceof t.Table&&(t[i].core=s.core))})}function mi({_novip:t},e,n,r){n.forEach(s=>{const i=r[s];e.forEach(o=>{const a=Ka(o,s);(!a||"value"in a&&a.value===void 0)&&(o===t.Transaction.prototype||o instanceof t.Transaction?Jt(o,s,{get(){return this.table(s)},set(l){kd(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):o[s]=new t.Table(s,i))})})}function sa({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function Gv(t,e){return t._cfg.version-e._cfg.version}function zv(t,e,n,r){const s=t._dbSchema,i=t._createTransaction("readwrite",t._storeNames,s);i.create(n),i._completion.catch(r);const o=i._reject.bind(i),a=ne.transless||ne;Tn(()=>{ne.trans=i,ne.transless=a,e===0?(Ue(s).forEach(l=>{po(n,l,s[l].primKey,s[l].indexes)}),ra(t,n),G.follow(()=>t.on.populate.fire(i)).catch(o)):function({_novip:l},u,c,d){const h=[],f=l._versions;let p=l._dbSchema=oa(l,l.idbdb,d),y=!1;const w=f.filter(m=>m._cfg.version>=u);function v(){return h.length?G.resolve(h.shift()(c.idbtrans)).then(v):G.resolve()}return w.forEach(m=>{h.push(()=>{const _=p,E=m._cfg.dbschema;aa(l,_,d),aa(l,E,d),p=l._dbSchema=E;const T=Qd(_,E);T.add.forEach(k=>{po(d,k[0],k[1].primKey,k[1].indexes)}),T.change.forEach(k=>{if(k.recreate)throw new oe.Upgrade("Not yet support for changing primary key");{const N=d.objectStore(k.name);k.add.forEach(I=>ia(N,I)),k.change.forEach(I=>{N.deleteIndex(I.name),ia(N,I)}),k.del.forEach(I=>N.deleteIndex(I))}});const S=m._cfg.contentUpgrade;if(S&&m._cfg.version>u){ra(l,d),c._memoizedTables={},y=!0;let k=Id(E);T.del.forEach(Q=>{k[Q]=_[Q]}),sa(l,[l.Transaction.prototype]),mi(l,[l.Transaction.prototype],Ue(k),k),c.schema=k;const N=Ha(S);let I;N&&kr();const Y=G.follow(()=>{if(I=S(c),I&&N){var Q=nn.bind(null,null);I.then(Q,Q)}});return I&&typeof I.then=="function"?G.resolve(I):Y.then(()=>I)}}),h.push(_=>{(!y||!Uv)&&function(E,T){[].slice.call(T.db.objectStoreNames).forEach(S=>E[S]==null&&T.db.deleteObjectStore(S))}(m._cfg.dbschema,_),sa(l,[l.Transaction.prototype]),mi(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),v().then(()=>{var m,_;_=d,Ue(m=p).forEach(E=>{_.db.objectStoreNames.contains(E)||po(_,E,m[E].primKey,m[E].indexes)})})}(t,e,i,n).catch(o)})}function Qd(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const s=t[r],i=e[r];if(s){const o={name:r,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||s.primKey.auto!==i.primKey.auto&&!ji)o.recreate=!0,n.change.push(o);else{const a=s.idxByName,l=i.idxByName;let u;for(u in a)l[u]||o.del.push(u);for(u in l){const c=a[u],d=l[u];c?c.src!==d.src&&o.change.push(d):o.add.push(d)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}else n.add.push([r,i])}return n}function po(t,e,n,r){const s=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(i=>ia(s,i)),s}function ia(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function oa(t,e,n){const r={};return ci(e.objectStoreNames,0).forEach(s=>{const i=n.objectStore(s);let o=i.keyPath;const a=ta(Jd(o),o||"",!1,!1,!!i.autoIncrement,o&&typeof o!="string",!0),l=[];for(let c=0;c<i.indexNames.length;++c){const d=i.index(i.indexNames[c]);o=d.keyPath;var u=ta(d.name,o,!!d.unique,!!d.multiEntry,!1,o&&typeof o!="string",!1);l.push(u)}r[s]=Xd(s,a,l)}),r}function aa({_novip:t},e,n){const r=n.db.objectStoreNames;for(let s=0;s<r.length;++s){const i=r[s],o=n.objectStore(i);t._hasGetAll="getAll"in o;for(let a=0;a<o.indexNames.length;++a){const l=o.indexNames[a],u=o.index(l).keyPath,c=typeof u=="string"?u:"["+ci(u).join("+")+"]";if(e[i]){const d=e[i].idxByName[c];d&&(d.name=l,delete e[i].idxByName[c],e[i].idxByName[l]=d)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&xe.WorkerGlobalScope&&xe instanceof xe.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Yv{_parseStoresSpec(e,n){Ue(e).forEach(r=>{if(e[r]!==null){var s=e[r].split(",").map((o,a)=>{const l=(o=o.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return ta(l,u||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),Ye(u),a===0)}),i=s.shift();if(i.multi)throw new oe.Schema("Primary key cannot be multi-valued");s.forEach(o=>{if(o.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),n[r]=Xd(r,i,s)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?nt(this._cfg.storesSource,e):e;const r=n._versions,s={};let i={};return r.forEach(o=>{nt(s,o._cfg.storesSource),i=o._cfg.dbschema={},o._parseStoresSpec(s,i)}),n._dbSchema=i,sa(n,[n._allTables,n,n.Transaction.prototype]),mi(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Ue(i),i),n._storeNames=Ue(i),this}upgrade(e){return this._cfg.contentUpgrade=Ga(this._cfg.contentUpgrade||ke,e),this}}function Xa(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Mn($i,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Qa(t){return t&&typeof t.databases=="function"}function la(t){return Tn(function(){return ne.letThrough=!0,t()})}function Jv(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Xv(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Me(e.dbOpenError):t);Dt&&(e.openCanceller._stackHolder=zn()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function s(){if(e.openCanceller!==r)throw new oe.DatabaseClosed("db.open() was cancelled")}let i=e.dbReadyResolve,o=null,a=!1;const l=()=>new G((u,c)=>{if(s(),!n)throw new oe.MissingAPI;const d=t.name,h=e.autoSchema?n.open(d):n.open(d,Math.round(10*t.verno));if(!h)throw new oe.MissingAPI;h.onerror=Lt(c),h.onblocked=Le(t._fireOnBlocked),h.onupgradeneeded=Le(f=>{if(o=h.transaction,e.autoSchema&&!t._options.allowEmptyDB){h.onerror=ps,o.abort(),h.result.close();const y=n.deleteDatabase(d);y.onsuccess=y.onerror=Le(()=>{c(new oe.NoSuchDatabase(`Database ${d} doesnt exist`))})}else{o.onerror=Lt(c);var p=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;a=p<1,t._novip.idbdb=h.result,zv(t,p/10,o,c)}},c),h.onsuccess=Le(()=>{o=null;const f=t._novip.idbdb=h.result,p=ci(f.objectStoreNames);if(p.length>0)try{const w=f.transaction((y=p).length===1?y[0]:y,"readonly");e.autoSchema?function({_novip:v},m,_){v.verno=m.version/10;const E=v._dbSchema=oa(0,m,_);v._storeNames=ci(m.objectStoreNames,0),mi(v,[v._allTables],Ue(E),E)}(t,f,w):(aa(t,t._dbSchema,w),function(v,m){const _=Qd(oa(0,v.idbdb,m),v._dbSchema);return!(_.add.length||_.change.some(E=>E.add.length||E.change.length))}(t,w)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ra(t,w)}catch{}var y;Zr.push(t),f.onversionchange=Le(w=>{e.vcFired=!0,t.on("versionchange").fire(w)}),f.onclose=Le(w=>{t.on("close").fire(w)}),a&&function({indexedDB:w,IDBKeyRange:v},m){!Qa(w)&&m!==$i&&Xa(w,v).put({name:m}).catch(ke)}(t._deps,d),u()},c)}).catch(u=>u&&u.name==="UnknownError"&&e.PR1398_maxLoop>0?(e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):G.reject(u));return G.race([r,(typeof navigator>"u"?G.resolve():Jv()).then(l)]).then(()=>(s(),e.onReadyBeingFired=[],G.resolve(la(()=>t.on.ready.fire(t.vip))).then(function u(){if(e.onReadyBeingFired.length>0){let c=e.onReadyBeingFired.reduce(Ga,ke);return e.onReadyBeingFired=[],G.resolve(la(()=>c(t.vip))).then(u)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(u=>{e.dbOpenError=u;try{o&&o.abort()}catch{}return r===e.openCanceller&&t._close(),Me(u)}).finally(()=>{e.openComplete=!0,i()})}function ca(t){var e=i=>t.next(i),n=s(e),r=s(i=>t.throw(i));function s(i){return o=>{var a=i(o),l=a.value;return a.done?l:l&&typeof l.then=="function"?l.then(n,r):Ye(l)?Promise.all(l).then(n,r):n(l)}}return s(e)()}function Qv(t,e,n){var r=arguments.length;if(r<2)throw new oe.InvalidArgument("Too few arguments");for(var s=new Array(r-1);--r;)s[r-1]=arguments[r];return n=s.pop(),[t,Rd(s),n]}function Zd(t,e,n,r,s){return G.resolve().then(()=>{const i=ne.transless||ne,o=t._createTransaction(e,n,t._dbSchema,r),a={trans:o,transless:i};if(r)o.idbtrans=r.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(d){return d.name===Va.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Zd(t,e,n,null,s))):Me(d)}const l=Ha(s);let u;l&&kr();const c=G.follow(()=>{if(u=s.call(o,o),u)if(l){var d=nn.bind(null,null);u.then(d,d)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=ca(u))},a);return(u&&typeof u.then=="function"?G.resolve(u).then(d=>o.active?d:Me(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(d=>(r&&o._resolve(),o._completion.then(()=>d))).catch(d=>(o._reject(d),Me(d)))})}function Ms(t,e,n){const r=Ye(t)?t.slice():[t];for(let s=0;s<n;++s)r.push(e);return r}const Zv={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,s={},i=[];function o(c,d,h){const f=ts(c),p=s[f]=s[f]||[],y=c==null?0:typeof c=="string"?1:c.length,w=d>0,v={...h,isVirtual:w,keyTail:d,keyLength:y,extractKey:na(c),unique:!w&&h.unique};return p.push(v),v.isPrimaryKey||i.push(v),y>1&&o(y===2?c[0]:c.slice(0,y-1),d+1,h),p.sort((m,_)=>m.keyTail-_.keyTail),v}const a=o(r.primaryKey.keyPath,0,r.primaryKey);s[":id"]=[a];for(const c of r.indexes)o(c.keyPath,0,c);function l(c){const d=c.query.index;return d.isVirtual?{...c,query:{index:d,range:(h=c.query.range,f=d.keyTail,{type:h.type===1?2:h.type,lower:Ms(h.lower,h.lowerOpen?t.MAX_KEY:t.MIN_KEY,f),lowerOpen:!0,upper:Ms(h.upper,h.upperOpen?t.MIN_KEY:t.MAX_KEY,f),upperOpen:!0})}}:c;var h,f}return{...n,schema:{...r,primaryKey:a,indexes:i,getIndexByKeyPath:function(c){const d=s[ts(c)];return d&&d[0]}},count:c=>n.count(l(c)),query:c=>n.query(l(c)),openCursor(c){const{keyTail:d,isVirtual:h,keyLength:f}=c.query.index;return h?n.openCursor(l(c)).then(p=>p&&function(y){return Object.create(y,{continue:{value:function(v){v!=null?y.continue(Ms(v,c.reverse?t.MAX_KEY:t.MIN_KEY,d)):c.unique?y.continue(y.key.slice(0,f).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,d)):y.continue()}},continuePrimaryKey:{value(v,m){y.continuePrimaryKey(Ms(v,t.MAX_KEY,d),m)}},primaryKey:{get:()=>y.primaryKey},key:{get(){const v=y.key;return f===1?v[0]:v.slice(0,f)}},value:{get:()=>y.value}})}(p)):n.openCursor(c)}}}}}};function Za(t,e,n,r){return n=n||{},r=r||"",Ue(t).forEach(s=>{if(pt(e,s)){var i=t[s],o=e[s];if(typeof i=="object"&&typeof o=="object"&&i&&o){const a=qo(i);a!==qo(o)?n[r+s]=e[s]:a==="Object"?Za(i,o,n,r+s+"."):i!==o&&(n[r+s]=e[s])}else i!==o&&(n[r+s]=e[s])}else n[r+s]=void 0}),Ue(e).forEach(s=>{pt(t,s)||(n[r+s]=e[s])}),n}const e_={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(i){const o=ne.trans,{deleting:a,creating:l,updating:u}=o.table(e).hook;switch(i.type){case"add":if(l.fire===ke)break;return o._promise("readwrite",()=>c(i),!0);case"put":if(l.fire===ke&&u.fire===ke)break;return o._promise("readwrite",()=>c(i),!0);case"delete":if(a.fire===ke)break;return o._promise("readwrite",()=>c(i),!0);case"deleteRange":if(a.fire===ke)break;return o._promise("readwrite",()=>function(h){return d(h.trans,h.range,1e4)}(i),!0)}return n.mutate(i);function c(h){const f=ne.trans,p=h.keys||function(y,w){return w.type==="delete"?w.keys:w.keys||w.values.map(y.extractKey)}(r,h);if(!p)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?{...h,keys:p}:{...h}).type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),function(y,w,v){return w.type==="add"?Promise.resolve([]):y.getMany({trans:w.trans,keys:v,cache:"immutable"})}(n,h,p).then(y=>{const w=p.map((v,m)=>{const _=y[m],E={onerror:null,onsuccess:null};if(h.type==="delete")a.fire.call(E,v,_,f);else if(h.type==="add"||_===void 0){const T=l.fire.call(E,v,h.values[m],f);v==null&&T!=null&&(v=T,h.keys[m]=v,r.outbound||kt(h.values[m],r.keyPath,v))}else{const T=Za(_,h.values[m]),S=u.fire.call(E,T,v,_,f);if(S){const k=h.values[m];Object.keys(S).forEach(N=>{pt(k,N)?k[N]=S[N]:kt(k,N,S[N])})}}return E});return n.mutate(h).then(({failures:v,results:m,numFailures:_,lastResult:E})=>{for(let T=0;T<p.length;++T){const S=m?m[T]:p[T],k=w[T];S==null?k.onerror&&k.onerror(v[T]):k.onsuccess&&k.onsuccess(h.type==="put"&&y[T]?h.values[T]:S)}return{failures:v,results:m,numFailures:_,lastResult:E}}).catch(v=>(w.forEach(m=>m.onerror&&m.onerror(v)),Promise.reject(v)))})}function d(h,f,p){return n.query({trans:h,values:!1,query:{index:r,range:f},limit:p}).then(({result:y})=>c({type:"delete",keys:y,trans:h}).then(w=>w.numFailures>0?Promise.reject(w.failures[0]):y.length<p?{failures:[],numFailures:0,lastResult:void 0}:d(h,{...f,lower:y[y.length-1],lowerOpen:!0},p)))}}}}})};function eh(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let s=0,i=0;s<e.keys.length&&i<t.length;++s)tt(e.keys[s],t[i])===0&&(r.push(n?Ss(e.values[s]):e.values[s]),++i);return r.length===t.length?r:null}catch{return null}}const t_={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const s=eh(r.keys,r.trans._cache,r.cache==="clone");return s?G.resolve(s):n.getMany(r).then(i=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ss(i):i},i))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function el(t){return!("from"in t)}const Wt=function(t,e){if(!this){const n=new Wt;return t&&"d"in t&&nt(n,t),n}nt(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function ys(t,e,n){const r=tt(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(el(t))return nt(t,{from:e,to:n,d:1});const s=t.l,i=t.r;if(tt(n,t.from)<0)return s?ys(s,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Sc(t);if(tt(e,t.to)>0)return i?ys(i,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Sc(t);tt(e,t.from)<0&&(t.from=e,t.l=null,t.d=i?i.d+1:1),tt(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const o=!t.r;s&&!t.l&&gi(t,s),i&&o&&gi(t,i)}function gi(t,e){el(e)||function n(r,{from:s,to:i,l:o,r:a}){ys(r,s,i),o&&n(r,o),a&&n(r,a)}(t,e)}function n_(t,e){const n=ua(e);let r=n.next();if(r.done)return!1;let s=r.value;const i=ua(t);let o=i.next(s.from),a=o.value;for(;!r.done&&!o.done;){if(tt(a.from,s.to)<=0&&tt(a.to,s.from)>=0)return!0;tt(s.from,a.from)<0?s=(r=n.next(a.from)).value:a=(o=i.next(s.from)).value}return!1}function ua(t){let e=el(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&tt(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||tt(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Sc(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),s=r>1?"r":r<-1?"l":"";if(s){const i=s==="r"?"l":"r",o={...t},a=t[s];t.from=a.from,t.to=a.to,t[s]=a[s],o[s]=a[i],t[i]=o,o.d=kc(o)}t.d=kc(t)}function kc({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}Er(Wt.prototype,{add(t){return gi(this,t),this},addKey(t){return ys(this,t,t),this},addKeys(t){return t.forEach(e=>ys(this,e,e)),this},[Ko](){return ua(this)}});const r_={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new Wt(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const s=t.table(r),{schema:i}=s,{primaryKey:o}=i,{extractKey:a,outbound:l}=o,u={...s,mutate:h=>{const f=h.trans,p=f.mutatedParts||(f.mutatedParts={}),y=S=>{const k=`idb://${e}/${r}/${S}`;return p[k]||(p[k]=new Wt)},w=y(""),v=y(":dels"),{type:m}=h;let[_,E]=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[];const T=h.trans._cache;return s.mutate(h).then(S=>{if(Ye(_)){m!=="delete"&&(_=S.results),w.addKeys(_);const k=eh(_,T);k||m==="add"||v.addKeys(_),(k||E)&&function(N,I,Y,Q){function ue(x){const $=N(x.name||"");function re(O){return O!=null?x.extractKey(O):null}const z=O=>x.multiEntry&&Ye(O)?O.forEach(D=>$.addKey(D)):$.addKey(O);(Y||Q).forEach((O,D)=>{const J=Y&&re(Y[D]),de=Q&&re(Q[D]);tt(J,de)!==0&&(J!=null&&z(J),de!=null&&z(de))})}I.indexes.forEach(ue)}(y,i,k,E)}else if(_){const k={from:_.lower,to:_.upper};v.add(k),w.add(k)}else w.add(n),v.add(n),i.indexes.forEach(k=>y(k.name).add(n));return S})}},c=({query:{index:h,range:f}})=>{var p,y;return[h,new Wt((p=f.lower)!==null&&p!==void 0?p:t.MIN_KEY,(y=f.upper)!==null&&y!==void 0?y:t.MAX_KEY)]},d={get:h=>[o,new Wt(h.key)],getMany:h=>[o,new Wt().addKeys(h.keys)],count:c,query:c,openCursor:c};return Ue(d).forEach(h=>{u[h]=function(f){const{subscr:p}=ne;if(p){const y=E=>{const T=`idb://${e}/${r}/${E}`;return p[T]||(p[T]=new Wt)},w=y(""),v=y(":dels"),[m,_]=d[h](f);if(y(m.name||"").add(_),!m.isPrimaryKey){if(h!=="count"){const E=h==="query"&&l&&f.values&&s.query({...f,values:!1});return s[h].apply(this,arguments).then(T=>{if(h==="query"){if(l&&f.values)return E.then(({result:k})=>(w.addKeys(k),T));const S=f.values?T.result.map(a):T.result;f.values?w.addKeys(S):v.addKeys(S)}else if(h==="openCursor"){const S=T,k=f.values;return S&&Object.create(S,{key:{get:()=>(v.addKey(S.primaryKey),S.key)},primaryKey:{get(){const N=S.primaryKey;return v.addKey(N),N}},value:{get:()=>(k&&w.addKey(S.primaryKey),S.value)}})}return T})}v.add(n)}}return s[h].apply(this,arguments)}}),u}}}};class Mn{constructor(e,n){this._middlewares={},this.verno=0;const r=Mn.dependencies;this._options=n={addons:Mn.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;i.dbReadyPromise=new G(a=>{i.dbReadyResolve=a}),i.openCanceller=new G((a,l)=>{i.cancelOpen=l}),this._state=i,this.name=e,this.on=es(this,"populate","blocked","versionchange","close",{ready:[Ga,ke]}),this.on.ready.subscribe=Ad(this.on.ready.subscribe,a=>(l,u)=>{Mn.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||G.resolve().then(l),u&&a(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&a(l);else{a(l);const d=this;u||a(function h(){d.on.ready.unsubscribe(l),d.on.ready.unsubscribe(h)})}})}),this.Collection=(o=this,Nr(Bv.prototype,function(a,l){this.db=o;let u=Gd,c=null;if(l)try{u=l()}catch(p){c=p}const d=a._ctx,h=d.table,f=h.hook.reading.fire;this._ctx={table:h,index:d.index,isPrimKey:!d.index||h.schema.primKey.keyPath&&d.index===h.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:d.or,valueMapper:f!==hs?f:null}})),this.Table=function(a){return Nr(Fv.prototype,function(l,u,c){this.db=a,this._tx=c,this.name=l,this.schema=u,this.hook=a._allTables[l]?a._allTables[l].hook:es(null,{creating:[Ov,ke],reading:[Av,hs],updating:[Iv,ke],deleting:[Cv,ke]})})}(this),this.Transaction=function(a){return Nr(Hv.prototype,function(l,u,c,d,h){this.db=a,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=d,this.idbtrans=null,this.on=es(this,"complete","error","abort"),this.parent=h||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new G((f,p)=>{this._resolve=f,this._reject=p}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},f=>{var p=this.active;return this.active=!1,this.on.error.fire(f),this.parent?this.parent._reject(f):p&&this.idbtrans&&this.idbtrans.abort(),Me(f)})})}(this),this.Version=function(a){return Nr(Yv.prototype,function(l){this.db=a,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(a){return Nr(Yd.prototype,function(l,u,c){this.db=a,this._ctx={table:l,index:u===":id"?null:u,or:c};const d=a._deps.indexedDB;if(!d)throw new oe.MissingAPI;this._cmp=this._ascending=d.cmp.bind(d),this._descending=(h,f)=>d.cmp(f,h),this._max=(h,f)=>d.cmp(h,f)>0?h:f,this._min=(h,f)=>d.cmp(h,f)<0?h:f,this._IDBKeyRange=a._deps.IDBKeyRange})}(this),this.on("versionchange",a=>{a.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",a=>{!a.newVersion||a.newVersion<a.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${a.oldVersion/10}`)}),this._maxKey=gs(n.IDBKeyRange),this._createTransaction=(a,l,u,c)=>new this.Transaction(a,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=a=>{this.on("blocked").fire(a),Zr.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(a))},this.use(Zv),this.use(e_),this.use(r_),this.use(t_),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(a=>a(this))}version(e){if(isNaN(e)||e<.1)throw new oe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(s=>s._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(Gv),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||ne.letThrough||this._vip)?e():new G((n,r)=>{if(this._state.openComplete)return r(new oe.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new oe.DatabaseClosed);this.open().catch(ke)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:s}){s&&this.unuse({stack:e,name:s});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:n,level:r??10,name:s}),i.sort((o,a)=>o.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(s=>r?s.create!==r:!!n&&s.name!==n)),this}open(){return Xv(this)}_close(){const e=this._state,n=Zr.indexOf(this);if(n>=0&&Zr.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new G(r=>{e.dbReadyResolve=r}),e.openCanceller=new G((r,s)=>{e.cancelOpen=s})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new oe.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new G((r,s)=>{const i=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=Le(()=>{(function({indexedDB:a,IDBKeyRange:l},u){!Qa(a)&&u!==$i&&Xa(a,l).delete(u).catch(ke)})(this._deps,this.name),r()}),o.onerror=Lt(s),o.onblocked=this._fireOnBlocked};if(e)throw new oe.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Ue(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Qv.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let s=ne.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);const i=e.indexOf("?")!==-1;let o,a;e=e.replace("!","").replace("?","");try{if(a=n.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===lo)o=lo;else{if(e!="rw"&&e!=co)throw new oe.InvalidArgument("Invalid transaction mode: "+e);o=co}if(s){if(s.mode===lo&&o===co){if(!i)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&a.forEach(u=>{if(s&&s.storeNames.indexOf(u)===-1){if(!i)throw new oe.SubTransaction("Table "+u+" not included in parent transaction.");s=null}}),i&&s&&!s.active&&(s=null)}}catch(u){return s?s._promise(null,(c,d)=>{d(u)}):Me(u)}const l=Zd.bind(null,this,o,a,s,r);return s?s._promise(o,l,"lock"):ne.trans?Ar(ne.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!pt(this._allTables,e))throw new oe.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const s_=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class i_{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[s_](){return this}}function th(t,e){return Ue(e).forEach(n=>{gi(t[n]||(t[n]=new Wt),e[n])}),t}function o_(t){let e,n=!1;const r=new i_(s=>{const i=Ha(t);let o=!1,a={},l={};const u={get closed(){return o},unsubscribe:()=>{o=!0,kn.storagemutated.unsubscribe(f)}};s.start&&s.start(u);let c=!1,d=!1;function h(){return Ue(l).some(y=>a[y]&&n_(a[y],l[y]))}const f=y=>{th(a,y),h()&&p()},p=()=>{if(c||o)return;a={};const y={},w=function(v){i&&kr();const m=()=>Tn(t,{subscr:v,trans:null}),_=ne.trans?Ar(ne.transless,m):m();return i&&_.then(nn,nn),_}(y);d||(kn(ms,f),d=!0),c=!0,Promise.resolve(w).then(v=>{n=!0,e=v,c=!1,o||(h()?p():(a={},l=y,s.next&&s.next(v)))},v=>{c=!1,n=!1,s.error&&s.error(v),u.unsubscribe()})};return p(),u});return r.hasValue=()=>n,r.getValue=()=>e,r}let da;try{da={indexedDB:xe.indexedDB||xe.mozIndexedDB||xe.webkitIndexedDB||xe.msIndexedDB,IDBKeyRange:xe.IDBKeyRange||xe.webkitIDBKeyRange}}catch{da={indexedDB:null,IDBKeyRange:null}}const xn=Mn;function Xs(t){let e=Yt;try{Yt=!0,kn.storagemutated.fire(t)}finally{Yt=e}}Er(xn,{...Ws,delete:t=>new xn(t,{addons:[]}).delete(),exists:t=>new xn(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return Qa(e)?Promise.resolve(e.databases()).then(r=>r.map(s=>s.name).filter(s=>s!==$i)):Xa(e,n).toCollection().primaryKeys()}(xn.dependencies).then(t)}catch{return Me(new oe.MissingAPI)}},defineClass:()=>function(t){nt(this,t)},ignoreTransaction:t=>ne.trans?Ar(ne.transless,t):t(),vip:la,async:function(t){return function(){try{var e=ca(t.apply(this,arguments));return e&&typeof e.then=="function"?e:G.resolve(e)}catch(n){return Me(n)}}},spawn:function(t,e,n){try{var r=ca(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:G.resolve(r)}catch(s){return Me(s)}},currentTransaction:{get:()=>ne.trans||null},waitFor:function(t,e){const n=G.resolve(typeof t=="function"?xn.ignoreTransaction(t):t).timeout(e||6e4);return ne.trans?ne.trans.waitFor(n):n},Promise:G,debug:{get:()=>Dt,set:t=>{Pd(t,t==="dexie"?()=>!0:Vd)}},derive:mr,extend:nt,props:Er,override:Ad,Events:es,on:kn,liveQuery:o_,extendObservabilitySet:th,getByKeyPath:Xt,setByKeyPath:kt,delByKeyPath:function(t,e){typeof e=="string"?kt(t,e,void 0):"length"in e&&[].map.call(e,function(n){kt(t,n,void 0)})},shallowClone:Id,deepClone:Ss,getObjectDiff:Za,cmp:tt,asap:Od,minKey:ea,addons:[],connections:Zr,errnames:Va,dependencies:da,semVer:vc,version:vc.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),xn.maxKey=gs(xn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(kn(ms,t=>{if(!Yt){let e;ji?(e=document.createEvent("CustomEvent"),e.initCustomEvent(vn,!0,!0,t)):e=new CustomEvent(vn,{detail:t}),Yt=!0,dispatchEvent(e),Yt=!1}}),addEventListener(vn,({detail:t})=>{Yt||Xs(t)}));let Yt=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(vn);typeof t.unref=="function"&&t.unref(),kn(ms,e=>{Yt||t.postMessage(e)}),t.onmessage=e=>{e.data&&Xs(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){kn(ms,e=>{try{Yt||(typeof localStorage<"u"&&localStorage.setItem(vn,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:vn,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===vn){const n=JSON.parse(e.newValue);n&&Xs(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===vn&&Xs(e.changedParts)})}G.rejectionMapper=function(t,e){if(!t||t instanceof gr||t instanceof TypeError||t instanceof SyntaxError||!t.name||!pc[t.name])return t;var n=new pc[t.name](e||t.message,t);return"stack"in t&&Jt(n,"stack",{get:function(){return this.inner.stack}}),n},Pd(Dt,Vd);class a_ extends Mn{constructor(){super("FamilyFinanceDB");It(this,"transactions");It(this,"accounts");It(this,"categories");It(this,"offlineTransactions");It(this,"syncQueue");this.version(1).stores({transactions:"id, family_id, account_id, category_id, type, date, created_by, created_at",accounts:"id, family_id, name, type, created_by",categories:"id, family_id, name, type, created_by",offlineTransactions:"id, timestamp, synced",syncQueue:"++id, type, action, timestamp, synced"})}}const l_=new a_;class c_{constructor(){It(this,"db",l_)}async initialize(){try{await this.db.open(),console.log("Offline database initialized successfully")}catch(e){throw console.error("Failed to initialize offline database:",e),e}}async cacheTransactions(e,n){try{await this.db.transactions.where("family_id").equals(e).delete(),await this.db.transactions.bulkAdd(n),console.log(`Cached ${n.length} transactions for offline access`)}catch(r){console.error("Error caching transactions:",r)}}async cacheAccounts(e,n){try{await this.db.accounts.where("family_id").equals(e).delete(),await this.db.accounts.bulkAdd(n),console.log(`Cached ${n.length} accounts for offline access`)}catch(r){console.error("Error caching accounts:",r)}}async cacheCategories(e,n){try{await this.db.categories.where("family_id").equals(e).delete(),await this.db.categories.bulkAdd(n),console.log(`Cached ${n.length} categories for offline access`)}catch(r){console.error("Error caching categories:",r)}}async getCachedTransactions(e){try{return await this.db.transactions.where("family_id").equals(e).toArray()}catch(n){return console.error("Error getting cached transactions:",n),[]}}async getCachedAccounts(e){try{return await this.db.accounts.where("family_id").equals(e).toArray()}catch(n){return console.error("Error getting cached accounts:",n),[]}}async getCachedCategories(e){try{return await this.db.categories.where("family_id").equals(e).toArray()}catch(n){return console.error("Error getting cached categories:",n),[]}}async createOfflineTransaction(e,n,r){try{const s=`offline_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:s,family_id:e,account_id:r.account_id,category_id:r.category_id,type:r.type,amount:r.amount,description:r.description||"",date:r.date||new Date().toISOString().split("T")[0],created_by:n,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await this.db.transactions.add(i),await this.db.syncQueue.add({type:"transaction",action:"create",data:i,timestamp:Date.now(),synced:!1}),console.log("Created offline transaction:",s),s}catch(s){throw console.error("Error creating offline transaction:",s),s}}async updateOfflineTransaction(e,n){try{await this.db.transactions.update(e,{...n,updated_at:new Date().toISOString()}),await this.db.syncQueue.add({type:"transaction",action:"update",data:{id:e,...n},originalId:e,timestamp:Date.now(),synced:!1}),console.log("Updated offline transaction:",e)}catch(r){throw console.error("Error updating offline transaction:",r),r}}async deleteOfflineTransaction(e){try{await this.db.transactions.delete(e),await this.db.syncQueue.add({type:"transaction",action:"delete",data:{id:e},originalId:e,timestamp:Date.now(),synced:!1}),console.log("Deleted offline transaction:",e)}catch(n){throw console.error("Error deleting offline transaction:",n),n}}async getPendingSyncItems(){try{return await this.db.syncQueue.where("synced").equals(0).toArray()}catch(e){return console.error("Error getting pending sync items:",e),[]}}async markSyncItemComplete(e,n){try{if(await this.db.syncQueue.update(e,{synced:!0,serverData:n}),n&&n.id){const r=await this.db.syncQueue.get(e);if(r&&r.action==="create"&&r.type==="transaction"){const s=await this.db.transactions.get(r.data.id);s&&(await this.db.transactions.delete(r.data.id),await this.db.transactions.add({...s,id:n.id}))}}}catch(r){console.error("Error marking sync item complete:",r)}}async clearSyncedItems(){try{await this.db.syncQueue.where("synced").equals(1).delete(),console.log("Cleared synced items from queue")}catch(e){console.error("Error clearing synced items:",e)}}async isOnline(){return navigator.onLine}async getStorageSize(){try{if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate();return{used:e.usage||0,quota:e.quota||0}}}catch(e){console.error("Error getting storage size:",e)}return{used:0,quota:0}}async clearOfflineData(e){try{e?(await Promise.all([this.db.transactions.where("family_id").equals(e).delete(),this.db.accounts.where("family_id").equals(e).delete(),this.db.categories.where("family_id").equals(e).delete()]),console.log(`Cleared offline data for family: ${e}`)):(await Promise.all([this.db.transactions.clear(),this.db.accounts.clear(),this.db.categories.clear(),this.db.syncQueue.clear()]),console.log("Cleared all offline data"))}catch(n){console.error("Error clearing offline data:",n)}}}const ye=new c_;ye.initialize().catch(console.error);class u_{async createAccount(e,n,r){try{const{data:s,error:i}=await se.from("accounts").insert({...r,family_id:e,created_by:n}).select().single();return i?{data:null,error:i.message,status:400}:{data:s,error:null,status:201}}catch(s){return console.error("Error creating account:",s),{data:null,error:"Terjadi kesalahan saat membuat akun",status:500}}}async updateAccount(e,n){try{const{data:r,error:s}=await se.from("accounts").update(n).eq("id",e).select().single();return s?{data:null,error:s.message,status:400}:{data:r,error:null,status:200}}catch(r){return console.error("Error updating account:",r),{data:null,error:"Terjadi kesalahan saat mengupdate akun",status:500}}}async deleteAccount(e){try{const{data:n}=await se.from("transactions").select("id").eq("account_id",e).limit(1);if(n&&n.length>0)return{data:null,error:"Tidak dapat menghapus akun yang memiliki transaksi",status:400};const{error:r}=await se.from("accounts").delete().eq("id",e);return r?{data:null,error:r.message,status:400}:{data:null,error:null,status:200}}catch(n){return console.error("Error deleting account:",n),{data:null,error:"Terjadi kesalahan saat menghapus akun",status:500}}}async createCategory(e,n,r){try{const{data:s,error:i}=await se.from("categories").insert({...r,family_id:e,created_by:n}).select().single();return i?{data:null,error:i.message,status:400}:{data:s,error:null,status:201}}catch(s){return console.error("Error creating category:",s),{data:null,error:"Terjadi kesalahan saat membuat kategori",status:500}}}async updateCategory(e,n){try{const{data:r,error:s}=await se.from("categories").update(n).eq("id",e).select().single();return s?{data:null,error:s.message,status:400}:{data:r,error:null,status:200}}catch(r){return console.error("Error updating category:",r),{data:null,error:"Terjadi kesalahan saat mengupdate kategori",status:500}}}async deleteCategory(e){try{const{data:n}=await se.from("transactions").select("id").eq("category_id",e).limit(1);if(n&&n.length>0)return{data:null,error:"Tidak dapat menghapus kategori yang memiliki transaksi",status:400};const{error:r}=await se.from("categories").delete().eq("id",e);return r?{data:null,error:r.message,status:400}:{data:null,error:null,status:200}}catch(n){return console.error("Error deleting category:",n),{data:null,error:"Terjadi kesalahan saat menghapus kategori",status:500}}}async getAccountStats(e){try{const{data:n,error:r}=await se.from("accounts").select(`
          *,
          transactions(amount, type)
        `).eq("family_id",e);return r?{data:null,error:r.message,status:400}:{data:(n==null?void 0:n.map(i=>{const o=i.transactions||[],a=o.filter(u=>u.type==="income").reduce((u,c)=>u+Number(c.amount),0),l=o.filter(u=>u.type==="expense").reduce((u,c)=>u+Number(c.amount),0);return{...i,total_income:a,total_expense:l,transaction_count:o.length}}))||[],error:null,status:200}}catch(n){return console.error("Error getting account stats:",n),{data:null,error:"Terjadi kesalahan saat mengambil statistik akun",status:500}}}async getCategoryStats(e){try{const{data:n,error:r}=await se.from("categories").select(`
          *,
          transactions(amount, type)
        `).eq("family_id",e);return r?{data:null,error:r.message,status:400}:{data:(n==null?void 0:n.map(i=>{const o=i.transactions||[],a=o.reduce((l,u)=>l+Number(u.amount),0);return{...i,total_amount:a,transaction_count:o.length}}))||[],error:null,status:200}}catch(n){return console.error("Error getting category stats:",n),{data:null,error:"Terjadi kesalahan saat mengambil statistik kategori",status:500}}}}const st=new u_;class d_{constructor(){It(this,"syncInProgress",!1);It(this,"syncInterval",null);It(this,"onlineStatusListener",null)}async initialize(){try{this.setupNetworkListeners(),navigator.onLine&&this.startPeriodicSync(),console.log("Sync service initialized")}catch(e){console.error("Failed to initialize sync service:",e)}}setupNetworkListeners(){this.onlineStatusListener=()=>{navigator.onLine?(console.log("App is back online, starting sync..."),this.syncAll(),this.startPeriodicSync()):(console.log("App is offline, stopping periodic sync"),this.stopPeriodicSync())},window.addEventListener("online",this.onlineStatusListener),window.addEventListener("offline",this.onlineStatusListener)}startPeriodicSync(){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=window.setInterval(()=>{navigator.onLine&&!this.syncInProgress&&this.syncAll()},3e4)}stopPeriodicSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null)}async syncAll(){if(this.syncInProgress||!navigator.onLine)return{success:!1,errors:["Sync already in progress or offline"]};this.syncInProgress=!0;const e=[];try{console.log("Starting sync process...");const n=await ye.getPendingSyncItems();if(n.length===0)return console.log("No pending sync items"),{success:!0,errors:[]};console.log(`Found ${n.length} items to sync`);for(const r of n)try{await this.syncItem(r)}catch(s){console.error(`Failed to sync item ${r.id}:`,s),e.push(`Failed to sync ${r.type} ${r.action}: ${s}`)}return await ye.clearSyncedItems(),console.log(`Sync completed. ${e.length} errors.`),{success:e.length===0,errors:e}}catch(n){return console.error("Sync process failed:",n),e.push(`Sync process failed: ${n}`),{success:!1,errors:e}}finally{this.syncInProgress=!1}}async syncItem(e){const{type:n,action:r,data:s,id:i}=e;try{switch(n){case"transaction":await this.syncTransaction(r,s,i);break;case"account":await this.syncAccount(r,s,i);break;case"category":await this.syncCategory(r,s,i);break;default:throw new Error(`Unknown sync type: ${n}`)}await ye.markSyncItemComplete(i)}catch(o){throw console.error(`Failed to sync ${n} ${r}:`,o),o}}async syncTransaction(e,n,r){const s=n.family_id,i=n.created_by;switch(e){case"create":const{id:o,...a}=n,l=await dt.createTransaction(s,i,a);if(l.error)throw new Error(l.error);await ye.markSyncItemComplete(r,l.data);break;case"update":const u=await dt.updateTransaction(n.id,n);if(u.error)throw new Error(u.error);await ye.markSyncItemComplete(r,u.data);break;case"delete":const c=await dt.deleteTransaction(n.id);if(c.error)throw new Error(c.error);await ye.markSyncItemComplete(r);break;default:throw new Error(`Unknown transaction action: ${e}`)}}async syncAccount(e,n,r){const s=n.family_id,i=n.created_by;switch(e){case"create":const{id:o,...a}=n,l=await st.createAccount(s,i,a);if(l.error)throw new Error(l.error);await ye.markSyncItemComplete(r,l.data);break;case"update":const u=await st.updateAccount(n.id,n);if(u.error)throw new Error(u.error);await ye.markSyncItemComplete(r,u.data);break;case"delete":const c=await st.deleteAccount(n.id);if(c.error)throw new Error(c.error);await ye.markSyncItemComplete(r);break;default:throw new Error(`Unknown account action: ${e}`)}}async syncCategory(e,n,r){const s=n.family_id,i=n.created_by;switch(e){case"create":const{id:o,...a}=n,l=await st.createCategory(s,i,a);if(l.error)throw new Error(l.error);await ye.markSyncItemComplete(r,l.data);break;case"update":const u=await st.updateCategory(n.id,n);if(u.error)throw new Error(u.error);await ye.markSyncItemComplete(r,u.data);break;case"delete":const c=await st.deleteCategory(n.id);if(c.error)throw new Error(c.error);await ye.markSyncItemComplete(r);break;default:throw new Error(`Unknown category action: ${e}`)}}async downloadAndCache(e){if(!navigator.onLine){console.log("Cannot download data while offline");return}try{console.log("Downloading and caching data...");const[n,r,s]=await Promise.all([dt.getTransactions(e),dt.getAccounts(e),dt.getCategories(e)]);n.data&&await ye.cacheTransactions(e,n.data),r.data&&await ye.cacheAccounts(e,r.data),s.data&&await ye.cacheCategories(e,s.data),console.log("Data downloaded and cached successfully")}catch(n){throw console.error("Failed to download and cache data:",n),n}}async getSyncStatus(){const e=await ye.getPendingSyncItems();return{isOnline:navigator.onLine,pendingItems:e.length,lastSyncTime:localStorage.getItem("lastSyncTime"),syncInProgress:this.syncInProgress}}async forceSyncNow(){return navigator.onLine?await this.syncAll():{success:!1,errors:["Cannot sync while offline"]}}destroy(){this.stopPeriodicSync(),this.onlineStatusListener&&(window.removeEventListener("online",this.onlineStatusListener),window.removeEventListener("offline",this.onlineStatusListener))}}const ir=new d_,Os=Mu("transaction",()=>{const t=Z([]),e=Z([]),n=Z([]),r=Z(null),s=Z(!1),i=Z(null),o=Z({}),a=Z(!navigator.onLine),l=Z(0),u=Oe(()=>n.value.filter(x=>x.type==="income")),c=Oe(()=>n.value.filter(x=>x.type==="expense")),d=Oe(()=>{let x=t.value;return o.value.type&&o.value.type!=="all"&&(x=x.filter($=>$.type===o.value.type)),o.value.category_id&&(x=x.filter($=>$.category_id===o.value.category_id)),o.value.account_id&&(x=x.filter($=>$.account_id===o.value.account_id)),x});async function h(x){s.value=!0,i.value=null;try{let $;return navigator.onLine?($=await dt.getDashboardStats(x),$.error?(i.value=$.error,await f(x)):(r.value=$.data,!0)):await f(x)}catch{return i.value="Terjadi kesalahan saat memuat statistik",await f(x)}finally{s.value=!1}}async function f(x){try{const $=await ye.getCachedTransactions(x),re=await ye.getCachedAccounts(x),z=new Date,O=new Date(z.getFullYear(),z.getMonth(),1),D=new Date(z.getFullYear(),z.getMonth()+1,0),J=$.filter(j=>{const K=new Date(j.date);return K>=O&&K<=D}),de=J.filter(j=>j.type==="income").reduce((j,K)=>j+Number(K.amount),0),Ee=J.filter(j=>j.type==="expense").reduce((j,K)=>j+Number(K.amount),0),Ne=re.reduce((j,K)=>j+Number(K.balance),0),F=$.slice(0,5);return r.value={totalIncome:de,totalExpense:Ee,totalBalance:Ne,recentTransactions:F},!0}catch($){return console.error("Error loading cached dashboard stats:",$),!1}}async function p(x,$){s.value=!0,i.value=null;try{if(navigator.onLine){const re=await dt.getTransactions(x,$);return re.error?(i.value=re.error,t.value=await ye.getCachedTransactions(x),!1):(t.value=re.data||[],await ye.cacheTransactions(x,t.value),!0)}else return t.value=await ye.getCachedTransactions(x),!0}catch{return i.value="Terjadi kesalahan saat memuat transaksi",t.value=await ye.getCachedTransactions(x),!1}finally{s.value=!1}}async function y(x){s.value=!0,i.value=null;try{if(navigator.onLine){const $=await dt.getAccounts(x);return $.error?(i.value=$.error,e.value=await ye.getCachedAccounts(x),!1):(e.value=$.data||[],await ye.cacheAccounts(x,e.value),!0)}else return e.value=await ye.getCachedAccounts(x),!0}catch{return i.value="Terjadi kesalahan saat memuat akun",e.value=await ye.getCachedAccounts(x),!1}finally{s.value=!1}}async function w(x,$){s.value=!0,i.value=null;try{if(navigator.onLine){const re=await dt.getCategories(x,$);if(re.error){i.value=re.error;const z=await ye.getCachedCategories(x);return n.value=$?z.filter(O=>O.type===$):z,!1}return $?(n.value=n.value.filter(z=>z.type!==$),n.value.push(...re.data||[])):n.value=re.data||[],await ye.cacheCategories(x,n.value),!0}else{const re=await ye.getCachedCategories(x);return n.value=$?re.filter(z=>z.type===$):re,!0}}catch{i.value="Terjadi kesalahan saat memuat kategori";const z=await ye.getCachedCategories(x);return n.value=$?z.filter(O=>O.type===$):z,!1}finally{s.value=!1}}async function v(x,$,re){s.value=!0,i.value=null;try{if(navigator.onLine){const z=await dt.createTransaction(x,$,re);return z.error?(i.value=z.error,!1):(z.data&&t.value.unshift(z.data),await h(x),!0)}else{const O={id:await ye.createOfflineTransaction(x,$,re),family_id:x,account_id:re.account_id,category_id:re.category_id,type:re.type,amount:re.amount,description:re.description||"",date:re.date||new Date().toISOString().split("T")[0],created_by:$,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),_offline:!0};t.value.unshift(O);const D=await ir.getSyncStatus();return l.value=D.pendingItems,!0}}catch{return i.value="Terjadi kesalahan saat membuat transaksi",!1}finally{s.value=!1}}async function m(x,$){s.value=!0,i.value=null;try{const re=await dt.updateTransaction(x,$);if(re.error)return i.value=re.error,!1;const z=t.value.findIndex(O=>O.id===x);return z!==-1&&re.data&&(t.value[z]=re.data),!0}catch{return i.value="Terjadi kesalahan saat mengupdate transaksi",!1}finally{s.value=!1}}async function _(x){s.value=!0,i.value=null;try{const $=await dt.deleteTransaction(x);return $.error?(i.value=$.error,!1):(t.value=t.value.filter(re=>re.id!==x),!0)}catch{return i.value="Terjadi kesalahan saat menghapus transaksi",!1}finally{s.value=!1}}function E(x){o.value={...o.value,...x}}function T(){o.value={}}function S(){i.value=null}async function k(){await ir.initialize();const x=()=>{a.value=!navigator.onLine};window.addEventListener("online",x),window.addEventListener("offline",x),setInterval(async()=>{const $=await ir.getSyncStatus();l.value=$.pendingItems},1e4)}async function N(){if(!navigator.onLine)return i.value="Tidak dapat sinkronisasi saat offline",!1;const x=await ir.forceSyncNow();if(!x.success)return i.value=`Sinkronisasi gagal: ${x.errors.join(", ")}`,!1;const $=await ir.getSyncStatus();return l.value=$.pendingItems,!0}async function I(x){if(navigator.onLine)try{await ir.downloadAndCache(x)}catch($){console.error("Failed to download and cache data:",$)}}function Y(x){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(x)}function Q(x){return n.value.find($=>$.id===x)}function ue(x){return e.value.find($=>$.id===x)}return{transactions:t,accounts:e,categories:n,dashboardStats:r,isLoading:s,error:i,filters:o,isOffline:a,pendingSyncItems:l,incomeCategories:u,expenseCategories:c,filteredTransactions:d,loadDashboardStats:h,loadTransactions:p,loadAccounts:y,loadCategories:w,createTransaction:v,updateTransaction:m,deleteTransaction:_,setFilters:E,clearFilters:T,clearError:S,initializeOfflineSync:k,forceSyncNow:N,downloadAndCacheData:I,formatCurrency:Y,getCategoryById:Q,getAccountById:ue}}),Ac=Object.freeze(Object.defineProperty({__proto__:null,useTransactionStore:Os},Symbol.toStringTag,{value:"Module"})),h_=["innerHTML"],f_={class:"page-content-slot"},p_=ot({__name:"AppLayout",props:{pageTitle:{}},setup(t){const e=Z(""),n=Ut(),r=on(),s=td(),i=Z(!1);Z(!1),Ot(async()=>{try{const m=await fetch("/src/templates/layout.html");e.value=await m.text(),setTimeout(()=>{a(),y()},100)}catch(m){console.error("Failed to load layout template:",m)}o(),window.addEventListener("resize",o)}),Ra(()=>{window.removeEventListener("resize",o)});const o=()=>{i.value=window.innerWidth<768;const m=document.getElementById("sidebar"),_=document.getElementById("bottom-nav");m&&_&&(i.value?(m.style.display="none",_.style.display="flex"):(m.style.display="flex",_.style.display="none"))},a=()=>{l(),u(),p(),v()},l=()=>{document.querySelectorAll(".menu-item, .nav-item").forEach(_=>{_.addEventListener("click",E=>{E.preventDefault();const T=_.getAttribute("data-route");T&&T!=="add"&&(w(T),r.push(`/${T}`))})})},u=()=>{const m=document.getElementById("quick-add-btn"),_=document.getElementById("quick-add-modal"),E=document.getElementById("close-quick-add"),T=document.querySelectorAll(".quick-option");m&&_&&m.addEventListener("click",S=>{S.preventDefault(),_.classList.add("show")}),E&&_&&(E.addEventListener("click",()=>{_.classList.remove("show")}),_.addEventListener("click",S=>{S.target===_&&_.classList.remove("show")})),T.forEach(S=>{S.addEventListener("click",()=>{const k=S.getAttribute("data-type");k&&c(k)})}),d()},c=m=>{const _=document.getElementById("quick-add-options"),E=document.getElementById("quick-transaction-form"),T=document.getElementById("quick-modal-title"),S=document.getElementById("quick-transaction-type"),k=document.getElementById("quick-transaction-date");_&&E&&T&&S&&k&&(_.style.display="none",E.style.display="block",T.textContent=m==="income"?"Tambah Pemasukan":"Tambah Pengeluaran",S.value=m,k.value=new Date().toISOString().split("T")[0],h(m))},d=()=>{const m=document.getElementById("back-to-quick-options"),_=document.getElementById("quick-transaction-form"),E=document.getElementById("quick-add-options"),T=document.getElementById("quick-modal-title");m&&E&&_&&T&&m.addEventListener("click",()=>{_.style.display="none",E.style.display="block",T.textContent="Tambah Cepat",_ instanceof HTMLFormElement&&_.reset()}),_&&_.addEventListener("submit",async S=>{S.preventDefault(),await f()})},h=async m=>{var T;const _=document.getElementById("quick-transaction-category"),E=document.getElementById("quick-transaction-account");if(!(!_||!E||!((T=n.user)!=null&&T.family_id)))try{const{useTransactionStore:S}=await En(()=>Promise.resolve().then(()=>Ac),void 0),k=S();await Promise.all([k.loadAccounts(n.user.family_id),k.loadCategories(n.user.family_id)]),E.innerHTML='<option value="">Pilih akun</option>',k.accounts.forEach(I=>{const Y=document.createElement("option");Y.value=I.id,Y.textContent=I.name,E.appendChild(Y)}),_.innerHTML='<option value="">Pilih kategori</option>',(m==="income"?k.incomeCategories:k.expenseCategories).forEach(I=>{const Y=document.createElement("option");Y.value=I.id,Y.textContent=I.name,_.appendChild(Y)})}catch(S){console.error("Failed to load form data:",S)}},f=async()=>{var E,T,S;const m=document.getElementById("quick-transaction-form");if(!m)return;const _={type:document.getElementById("quick-transaction-type").value,amount:parseInt(document.getElementById("quick-transaction-amount").value),category_id:document.getElementById("quick-transaction-category").value,account_id:document.getElementById("quick-transaction-account").value,date:document.getElementById("quick-transaction-date").value,description:document.getElementById("quick-transaction-description").value,family_id:(E=n.user)==null?void 0:E.family_id};try{const{useTransactionStore:k}=await En(()=>Promise.resolve().then(()=>Ac),void 0),N=k();(T=n.user)!=null&&T.family_id&&((S=n.user)!=null&&S.id)&&await N.createTransaction(n.user.family_id,n.user.id,_);const I=document.getElementById("quick-add-modal"),Y=document.getElementById("quick-add-options"),Q=document.getElementById("quick-modal-title");I&&Y&&Q&&(I.classList.remove("show"),m.style.display="none",Y.style.display="block",Q.textContent="Tambah Cepat",m.reset()),console.log("Transaction added successfully!")}catch(k){console.error("Failed to add transaction:",k),alert("Gagal menambahkan transaksi. Silakan coba lagi.")}},p=()=>{const m=document.getElementById("logout-btn");m&&m.addEventListener("click",async _=>{_.preventDefault(),await n.logout()&&r.push("/auth/login")})},y=()=>{if(!n.user)return;const m=document.getElementById("user-name"),_=document.getElementById("user-email"),E=document.getElementById("user-avatar");if(m&&(m.textContent=n.user.full_name),_&&(_.textContent=n.user.email),E){const T=n.user.full_name.split(" ").map(S=>S.charAt(0)).join("").toUpperCase();E.innerHTML=`<span>${T}</span>`}},w=m=>{document.querySelectorAll(".menu-item, .nav-item").forEach(T=>{T.classList.remove("active")}),document.querySelectorAll(`[data-route="${m}"]`).forEach(T=>{T.classList.add("active")})},v=()=>{const m=s.name;m&&w(m)};return r.afterEach(m=>{m.name&&setTimeout(()=>{w(m.name)},100)}),(m,_)=>(Te(),Be("div",null,[_[0]||(_[0]=te("link",{rel:"stylesheet",href:"/src/styles/layout.css"},null,-1)),te("div",{innerHTML:e.value},null,8,h_),te("div",f_,[hf(m.$slots,"default",{},void 0,!0)])]))}});const Or=an(p_,[["__scopeId","data-v-39c54194"]]),m_={key:0,class:"loading-container"},g_={key:1,class:"error-container"},y_={class:"error-message"},v_=["innerHTML"],__=ot({__name:"DashboardView",setup(t){const e=Z(""),n=Ut(),r=Os(),s=on();Ot(async()=>{try{const h=await fetch("/src/templates/dashboard.html");e.value=await h.text(),setTimeout(()=>{a(),l()},100)}catch(h){console.error("Failed to load dashboard template:",h)}});const i=Oe(()=>r.dashboardStats),o=Oe(()=>{var h;return((h=i.value)==null?void 0:h.recentTransactions)||[]}),a=()=>{u(),c()},l=async()=>{var h;if(!((h=n.user)!=null&&h.family_id)){s.push("/family/setup");return}await Promise.all([r.loadDashboardStats(n.user.family_id),r.loadAccounts(n.user.family_id),r.loadCategories(n.user.family_id)]),c(),d()},u=()=>{const h=document.querySelector(".income-btn"),f=document.querySelector(".expense-btn"),p=document.querySelector(".view-all-link");h&&h.addEventListener("click",()=>{s.push("/transactions?type=income&add=true")}),f&&f.addEventListener("click",()=>{s.push("/transactions?type=expense&add=true")}),p&&p.addEventListener("click",y=>{y.preventDefault(),s.push("/transactions")})},c=()=>{if(!i.value)return;const h=document.getElementById("total-income"),f=document.getElementById("total-expense"),p=document.getElementById("total-balance");h&&(h.textContent=r.formatCurrency(i.value.totalIncome)),f&&(f.textContent=r.formatCurrency(i.value.totalExpense)),p&&(p.textContent=r.formatCurrency(i.value.totalBalance))},d=()=>{const h=document.getElementById("recent-transactions-list");if(!h)return;if(o.value.length===0){h.innerHTML=`
      <div class="empty-state">
        <p class="text-gray-500 text-center py-8">Belum ada transaksi bulan ini</p>
      </div>
    `;return}const f=o.value.map(p=>{var T,S,k;const y=p.type==="income",w=r.formatCurrency(Number(p.amount)),v=((T=p.category)==null?void 0:T.name)||"Tidak ada kategori",m=((S=p.account)==null?void 0:S.name)||"Tidak ada akun",_=((k=p.user)==null?void 0:k.full_name)||"Unknown",E=new Date(p.date).toLocaleDateString("id-ID",{day:"numeric",month:"short"});return`
      <div class="transaction-item">
        <div class="transaction-info">
          <div class="transaction-icon ${y?"income":"expense"}">
            <i class="icon-${y?"plus":"minus"}"></i>
          </div>
          <div class="transaction-details">
            <h4>${p.description||v}</h4>
            <p class="transaction-meta">${v}  ${m}  ${_}</p>
          </div>
        </div>
        <div class="transaction-amount">
          <span class="amount ${y?"income":"expense"}">${w}</span>
          <span class="transaction-date">${E}</span>
        </div>
      </div>
    `}).join("");h.innerHTML=f};return Oe(()=>{i.value&&(setTimeout(c,0),setTimeout(d,0))}),(h,f)=>(Te(),tn(Or,{"page-title":"Dashboard"},{default:Vn(()=>[f[2]||(f[2]=te("link",{rel:"stylesheet",href:"/src/styles/dashboard.css"},null,-1)),Ae(r).isLoading?(Te(),Be("div",m_,[...f[0]||(f[0]=[te("div",{class:"loading-spinner"},null,-1),te("p",null,"Memuat data dashboard...",-1)])])):ft("",!0),Ae(r).error?(Te(),Be("div",g_,[te("div",y_,[f[1]||(f[1]=te("i",{class:"icon-alert-circle"},null,-1)),te("p",null,jt(Ae(r).error),1),te("button",{onClick:l,class:"retry-btn"},"Coba Lagi")])])):ft("",!0),Ca(te("div",{innerHTML:e.value},null,8,v_),[[ja,!Ae(r).isLoading&&!Ae(r).error]])]),_:1}))}});const b_=an(__,[["__scopeId","data-v-e6cff968"]]),w_={key:0,class:"loading-container"},E_={key:1,class:"error-container"},T_={class:"error-message"},S_=["innerHTML"],k_=ot({__name:"TransactionsView",setup(t){const e=Z(""),n=Ut(),r=Os(),s=on(),i=td(),o=Z(!1),a=Z(!1),l=Z(null),u=Z({type:"expense",amount:0,description:"",category_id:"",account_id:"",date:new Date().toISOString().split("T")[0]}),c=Z({type:"all",category_id:"",account_id:"",date_period:"this-month"}),d=Oe(()=>r.filteredTransactions),h=Oe(()=>r.accounts),f=Oe(()=>r.categories),p=Oe(()=>r.incomeCategories),y=Oe(()=>r.expenseCategories);Ot(async()=>{try{const O=await fetch("/src/templates/transactions.html");e.value=await O.text(),setTimeout(()=>{v(),m(),w()},100)}catch(O){console.error("Failed to load transactions template:",O)}});const w=()=>{if(i.query.add==="true"){const O=i.query.type;O&&["income","expense"].includes(O)&&(u.value.type=O),k()}},v=()=>{_(),E(),T(),S()},m=async()=>{var O;if(!((O=n.user)!=null&&O.family_id)){s.push("/family/setup");return}await Promise.all([r.loadTransactions(n.user.family_id),r.loadAccounts(n.user.family_id),r.loadCategories(n.user.family_id)]),ue(),x(),z()},_=()=>{const O=document.getElementById("filter-type"),D=document.getElementById("filter-category"),J=document.getElementById("filter-account"),de=document.getElementById("filter-date");O&&O.addEventListener("change",()=>{c.value.type=O.value,Q()}),D&&D.addEventListener("change",()=>{c.value.category_id=D.value,Q()}),J&&J.addEventListener("change",()=>{c.value.account_id=J.value,Q()}),de&&de.addEventListener("change",()=>{c.value.date_period=de.value,Q()})},E=()=>{const O=document.getElementById("transaction-modal"),D=document.getElementById("close-transaction-modal"),J=document.getElementById("cancel-transaction"),de=document.getElementById("transaction-form");D&&D.addEventListener("click",N),J&&J.addEventListener("click",N),O&&O.addEventListener("click",Ee=>{Ee.target===O&&N()}),de&&de.addEventListener("submit",Y)},T=()=>{const O=document.querySelector(".add-transaction-btn");O&&O.addEventListener("click",()=>{k()})},S=()=>{},k=O=>{O?(a.value=!0,l.value=O.id,u.value={type:O.type,amount:Number(O.amount),description:O.description||"",category_id:O.category_id,account_id:O.account_id,date:O.date}):(a.value=!1,l.value=null,u.value={type:"expense",amount:0,description:"",category_id:"",account_id:"",date:new Date().toISOString().split("T")[0]}),o.value=!0;const D=document.getElementById("transaction-modal");D&&D.classList.add("show"),I()},N=()=>{o.value=!1;const O=document.getElementById("transaction-modal");O&&O.classList.remove("show")},I=()=>{setTimeout(()=>{const O=document.getElementById("transaction-modal-title"),D=document.getElementById("transaction-type"),J=document.getElementById("transaction-amount");document.getElementById("transaction-category"),document.getElementById("transaction-account");const de=document.getElementById("transaction-date"),Ee=document.getElementById("transaction-description");O&&(O.textContent=a.value?"Edit Transaksi":"Tambah Transaksi"),D&&(D.value=u.value.type,D.addEventListener("change",()=>{u.value.type=D.value,$()})),J&&(J.value=u.value.amount.toString(),J.addEventListener("input",()=>{u.value.amount=Number(J.value)})),de&&(de.value=u.value.date,de.addEventListener("change",()=>{u.value.date=de.value})),Ee&&(Ee.value=u.value.description,Ee.addEventListener("input",()=>{u.value.description=Ee.value})),$(),re()},50)},Y=async O=>{var D;O.preventDefault(),(D=n.user)!=null&&D.family_id&&(a.value&&l.value?await r.updateTransaction(l.value,u.value)&&(N(),ue(),z()):await r.createTransaction(n.user.family_id,n.user.id,u.value)&&(N(),ue(),z()))},Q=()=>{const O={};c.value.type!=="all"&&(O.type=c.value.type),c.value.category_id&&(O.category_id=c.value.category_id),c.value.account_id&&(O.account_id=c.value.account_id);const D=new Date;if(c.value.date_period==="this-month"){const J=new Date(D.getFullYear(),D.getMonth(),1),de=new Date(D.getFullYear(),D.getMonth()+1,0);O.date_from=J.toISOString().split("T")[0],O.date_to=de.toISOString().split("T")[0]}r.setFilters(O),ue(),z()},ue=()=>{const O=document.getElementById("transactions-table-body");if(!O)return;const D=d.value;if(D.length===0){O.innerHTML=`
      <tr>
        <td colspan="7" class="text-center py-8 text-gray-500">
          Belum ada transaksi
        </td>
      </tr>
    `;return}O.innerHTML=D.map(J=>{var ae,C,H;const de=J.type==="income",Ee=r.formatCurrency(Number(J.amount)),Ne=new Date(J.date).toLocaleDateString("id-ID"),F=((ae=J.category)==null?void 0:ae.name)||"Tidak ada kategori",j=((C=J.account)==null?void 0:C.name)||"Tidak ada akun",K=((H=J.user)==null?void 0:H.full_name)||"Unknown";return`
      <tr>
        <td>${Ne}</td>
        <td>${J.description||F}</td>
        <td>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${de?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}">
            ${F}
          </span>
        </td>
        <td>${j}</td>
        <td class="font-semibold ${de?"text-green-600":"text-red-600"}">${de?"+":"-"}${Ee}</td>
        <td>${K}</td>
        <td>
          <button onclick="editTransaction('${J.id}')" class="text-blue-600 hover:text-blue-800 mr-2">
            Edit
          </button>
          <button onclick="deleteTransaction('${J.id}')" class="text-red-600 hover:text-red-800">
            Hapus
          </button>
        </td>
      </tr>
    `}).join(""),window.editTransaction=J=>{const de=D.find(Ee=>Ee.id===J);de&&k(de)},window.deleteTransaction=async J=>{confirm("Apakah Anda yakin ingin menghapus transaksi ini?")&&await r.deleteTransaction(J)&&(ue(),z())}},x=()=>{const O=document.getElementById("filter-category"),D=document.getElementById("filter-account");O&&(O.innerHTML='<option value="">Semua Kategori</option>'+f.value.map(J=>`<option value="${J.id}">${J.name}</option>`).join("")),D&&(D.innerHTML='<option value="">Semua Akun</option>'+h.value.map(J=>`<option value="${J.id}">${J.name}</option>`).join(""))},$=()=>{const O=document.getElementById("transaction-category");if(!O)return;const D=u.value.type==="income"?p.value:y.value;O.innerHTML='<option value="">Pilih kategori</option>'+D.map(J=>`<option value="${J.id}">${J.name}</option>`).join(""),u.value.category_id&&(O.value=u.value.category_id),O.addEventListener("change",()=>{u.value.category_id=O.value})},re=()=>{const O=document.getElementById("transaction-account");O&&(O.innerHTML='<option value="">Pilih akun</option>'+h.value.map(D=>`<option value="${D.id}">${D.name}</option>`).join(""),u.value.account_id&&(O.value=u.value.account_id),O.addEventListener("change",()=>{u.value.account_id=O.value}))},z=()=>{const O=d.value,D=O.filter(j=>j.type==="income").reduce((j,K)=>j+Number(K.amount),0),J=O.filter(j=>j.type==="expense").reduce((j,K)=>j+Number(K.amount),0),de=D-J,Ee=document.getElementById("filtered-income"),Ne=document.getElementById("filtered-expense"),F=document.getElementById("filtered-balance");Ee&&(Ee.textContent=r.formatCurrency(D)),Ne&&(Ne.textContent=r.formatCurrency(J)),F&&(F.textContent=r.formatCurrency(Math.abs(de)),F.className=`summary-value ${de>=0?"text-green-600":"text-red-600"}`)};return bn(()=>r.transactions,()=>{ue(),z()},{deep:!0}),(O,D)=>(Te(),tn(Or,{"page-title":"Transaksi"},{default:Vn(()=>[D[2]||(D[2]=te("link",{rel:"stylesheet",href:"/src/styles/transactions.css"},null,-1)),Ae(r).isLoading?(Te(),Be("div",w_,[...D[0]||(D[0]=[te("div",{class:"loading-spinner"},null,-1),te("p",null,"Memuat data transaksi...",-1)])])):ft("",!0),Ae(r).error?(Te(),Be("div",E_,[te("div",T_,[D[1]||(D[1]=te("i",{class:"icon-alert-circle"},null,-1)),te("p",null,jt(Ae(r).error),1),te("button",{onClick:m,class:"retry-btn"},"Coba Lagi")])])):ft("",!0),Ca(te("div",{innerHTML:e.value},null,8,S_),[[ja,!Ae(r).isLoading&&!Ae(r).error]])]),_:1}))}});const A_=an(k_,[["__scopeId","data-v-376ccae2"]]);class O_{async createFamily(e,n){try{console.log("Creating family with userId:",e,"familyName:",n);const{data:r,error:s}=await se.from("users").select("id, email, full_name").eq("id",e).single();if(s||!r)return console.error("User profile not found:",s),{data:null,error:"User profile tidak ditemukan. Silakan logout dan login kembali.",status:400};console.log("User profile found:",r);const{data:i,error:o}=await se.from("families").insert({name:n,created_by:e}).select().single();if(o)return console.error("Family creation error:",o),{data:null,error:`Gagal membuat keluarga: ${o.message}`,status:400};console.log("Family created:",i);const{error:a}=await se.from("family_members").insert({user_id:e,family_id:i.id,role:"owner"});return a?(await se.from("families").delete().eq("id",i.id),{data:null,error:a.message,status:400}):(await se.rpc("create_default_categories",{family_id_param:i.id,user_id_param:e}),{data:i,error:null,status:201})}catch(r){return console.error("Error creating family:",r),{data:null,error:"Terjadi kesalahan saat membuat keluarga",status:500}}}async joinFamily(e,n){try{const{data:r,error:s}=await se.from("families").select("*").eq("family_code",n.toUpperCase()).single();if(s||!r)return{data:null,error:"Kode keluarga tidak ditemukan",status:404};const{data:i}=await se.from("family_members").select("id").eq("user_id",e).eq("family_id",r.id).single();if(i)return{data:null,error:"Anda sudah menjadi anggota keluarga ini",status:400};const{error:o}=await se.from("family_members").insert({user_id:e,family_id:r.id,role:"member"});return o?{data:null,error:o.message,status:400}:{data:r,error:null,status:200}}catch(r){return console.error("Error joining family:",r),{data:null,error:"Terjadi kesalahan saat bergabung dengan keluarga",status:500}}}async getFamily(e){try{const{data:n,error:r}=await se.from("families").select("*").eq("id",e).single();return r?{data:null,error:r.message,status:400}:{data:n,error:null,status:200}}catch(n){return console.error("Error getting family:",n),{data:null,error:"Terjadi kesalahan saat mengambil data keluarga",status:500}}}async getFamilyMembers(e){try{const{data:n,error:r}=await se.from("family_members").select(`
          *,
          user:users(id, full_name, email)
        `).eq("family_id",e).order("joined_at");return r?{data:null,error:r.message,status:400}:{data:n||[],error:null,status:200}}catch(n){return console.error("Error getting family members:",n),{data:null,error:"Terjadi kesalahan saat mengambil anggota keluarga",status:500}}}async updateFamily(e,n){try{const{data:r,error:s}=await se.from("families").update(n).eq("id",e).select().single();return s?{data:null,error:s.message,status:400}:{data:r,error:null,status:200}}catch(r){return console.error("Error updating family:",r),{data:null,error:"Terjadi kesalahan saat mengupdate keluarga",status:500}}}async removeMember(e,n){try{const{error:r}=await se.from("family_members").delete().eq("family_id",e).eq("user_id",n);return r?{data:null,error:r.message,status:400}:{data:null,error:null,status:200}}catch(r){return console.error("Error removing member:",r),{data:null,error:"Terjadi kesalahan saat mengeluarkan anggota",status:500}}}async leaveFamily(e,n){try{const{data:r}=await se.from("family_members").select("role").eq("family_id",e).eq("user_id",n).single();if((r==null?void 0:r.role)==="owner"){const{data:s,error:i}=await se.from("family_members").select("id").eq("family_id",e);if(i)return{data:null,error:i.message,status:400};if(s&&s.length>1)return{data:null,error:"Sebagai pemilik, Anda harus mentransfer kepemilikan atau mengeluarkan semua anggota sebelum keluar",status:400};await se.from("families").delete().eq("id",e)}else await this.removeMember(e,n);return{data:null,error:null,status:200}}catch(r){return console.error("Error leaving family:",r),{data:null,error:"Terjadi kesalahan saat keluar dari keluarga",status:500}}}}const nh=new O_,C_=["innerHTML"],I_=ot({__name:"FamilyView",setup(t){const e=Z("");Ut(),on(),Ot(async()=>{try{const r=await fetch("/src/templates/family.html");e.value=await r.text(),setTimeout(()=>{n()},100)}catch(r){console.error("Failed to load family template:",r)}});const n=()=>{console.log("Initializing family page...");const r=document.getElementById("create-family-btn");r&&r.addEventListener("click",async()=>{var l;const s=document.getElementById("family-name-input"),i=(l=s==null?void 0:s.value)==null?void 0:l.trim();if(!i){alert("Nama keluarga wajib diisi");return}const{data:{user:o}}=await se.auth.getUser();if(!o){alert("User belum login, silakan login ulang");return}const a=await nh.createFamily(o.id,i);a.error?alert(a.error):(alert("Keluarga berhasil dibuat!"),window.location.reload())})};return(r,s)=>(Te(),tn(Or,{"page-title":"Keluarga"},{default:Vn(()=>[s[0]||(s[0]=te("link",{rel:"stylesheet",href:"/src/styles/family.css"},null,-1)),te("div",{innerHTML:e.value},null,8,C_)]),_:1}))}}),R_={key:0,class:"error-message"},x_={key:1,class:"loading-overlay"},P_=["innerHTML"],L_=ot({__name:"FamilySetupView",setup(t){const e=Z(""),n=Ut(),r=on(),s=Z(!1),i=Z(null),o=Z("create");Z({familyName:""}),Z({familyCode:""}),Ot(async()=>{try{e.value=`
      <div class="family-setup-container">
        <div class="setup-card">
          <div class="setup-header">
            <h1>Pengaturan Keluarga</h1>
            <p>Buat keluarga baru atau bergabung dengan keluarga yang sudah ada</p>
          </div>
          
          <div class="tab-buttons">
            <button class="tab-btn active" data-tab="create">Buat Keluarga Baru</button>
            <button class="tab-btn" data-tab="join">Bergabung dengan Keluarga</button>
          </div>
          
          <div class="tab-content">
            <div class="tab-pane active" id="create-tab">
              <form class="setup-form" id="create-form">
                <div class="form-group">
                  <label for="family-name">Nama Keluarga</label>
                  <input type="text" id="family-name" placeholder="Masukkan nama keluarga Anda" required>
                </div>
                <button type="submit" class="btn-primary">Buat Keluarga</button>
              </form>
            </div>
            
            <div class="tab-pane" id="join-tab">
              <form class="setup-form" id="join-form">
                <div class="form-group">
                  <label for="family-code">Kode Keluarga</label>
                  <input type="text" id="family-code" placeholder="Masukkan kode keluarga (contoh: ABC-123-XYZ)" required>
                </div>
                <button type="submit" class="btn-primary">Bergabung</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    `,setTimeout(()=>{a()},100)}catch(h){console.error("Failed to load family setup template:",h)}});const a=()=>{l(),u()},l=()=>{const h=document.querySelectorAll(".tab-btn"),f=document.querySelectorAll(".tab-pane");h.forEach(p=>{p.addEventListener("click",()=>{const y=p.getAttribute("data-tab");h.forEach(v=>v.classList.remove("active")),f.forEach(v=>v.classList.remove("active")),p.classList.add("active");const w=document.getElementById(`${y}-tab`);w&&w.classList.add("active"),o.value=y})})},u=()=>{const h=document.getElementById("create-form"),f=document.getElementById("join-form");h&&h.addEventListener("submit",c),f&&f.addEventListener("submit",d)},c=async h=>{h.preventDefault(),console.log("=== DEBUG: Memulai proses buat keluarga ===");const{supabase:f}=await En(()=>Promise.resolve().then(()=>Qy),void 0),{data:{user:p},error:y}=await f.auth.getUser();if(console.log("DEBUG: Session user:",p),console.log("DEBUG: Session error:",y),console.log("DEBUG: authStore.user:",n.user),!p){console.error("DEBUG: User tidak ditemukan di session"),i.value="Session tidak valid. Silakan logout dan login ulang.";return}const w=document.getElementById("family-name"),v=w==null?void 0:w.value.trim();if(!v){i.value="Nama keluarga tidak boleh kosong";return}console.log("DEBUG: Nama keluarga:",v),console.log("DEBUG: User ID yang akan digunakan:",p.id);const{data:m,error:_}=await f.from("users").select("*").eq("id",p.id).single();if(console.log("DEBUG: User profile di tabel users:",m),console.log("DEBUG: User profile error:",_),!m){console.error("DEBUG: User tidak ditemukan di tabel users"),i.value="Profile user tidak ditemukan. Silakan logout dan login ulang.";return}s.value=!0,i.value=null;try{const E={name:v,created_by:p.id};console.log("=== FINAL DEBUG ATTEMPT ==="),console.log("Payload:",E),console.log("User ID type:",typeof p.id),console.log("User ID value:",p.id);const{data:T,error:S}=await f.from("families").insert(E).select("*").single();if(console.log("INSERT RESULT:",T),console.log("INSERT ERROR FULL:",JSON.stringify(S,null,2)),S){console.error("ERROR CODE:",S.code),console.error("ERROR MESSAGE:",S.message),console.error("ERROR DETAILS:",S.details),console.error("ERROR HINT:",S.hint),S.code==="42501"?i.value=`RLS Policy Error: ${S.message}. Cek logs untuk detail.`:i.value=`Database Error [${S.code}]: ${S.message}`;return}if(T){console.log("SUCCESS: Family created:",T);const k={user_id:p.id,family_id:T.id,role:"owner"};console.log("Adding family member:",k);const{error:N}=await f.from("family_members").insert(k);if(N){console.error("Member creation error:",N),await f.from("families").delete().eq("id",T.id),i.value=`Gagal menambahkan anggota keluarga: ${N.message}`;return}await n.getCurrentUser(),r.push("/dashboard");return}}catch(E){console.error("DEBUG: Error di catch block:",E),i.value="Terjadi kesalahan saat membuat keluarga"}finally{s.value=!1}},d=async h=>{if(h.preventDefault(),!n.user)return;const f=document.getElementById("family-code"),p=f==null?void 0:f.value.trim();if(!p){i.value="Kode keluarga tidak boleh kosong";return}s.value=!0,i.value=null;try{const y=await nh.joinFamily(n.user.id,p);if(y.error){i.value=y.error;return}await n.getCurrentUser(),r.push("/dashboard")}catch{i.value="Terjadi kesalahan saat bergabung dengan keluarga"}finally{s.value=!1}};return(h,f)=>(Te(),Be("div",null,[f[2]||(f[2]=te("link",{rel:"stylesheet",href:"/src/styles/auth.css"},null,-1)),i.value?(Te(),Be("div",R_,[ki(jt(i.value)+" ",1),te("button",{onClick:f[0]||(f[0]=p=>i.value=null)},"")])):ft("",!0),s.value?(Te(),Be("div",x_,[f[1]||(f[1]=te("div",{class:"loading-spinner"},null,-1)),te("p",null,jt(o.value==="create"?"Membuat keluarga...":"Bergabung dengan keluarga..."),1)])):ft("",!0),te("div",{innerHTML:e.value},null,8,P_)]))}});const N_=an(L_,[["__scopeId","data-v-72bd1cf6"]]),j_={key:0,class:"loading-container"},$_={key:1,class:"error-container"},U_={class:"error-message"},D_=["innerHTML"],F_=ot({__name:"AccountsView",setup(t){const e=Z(""),n=Ut(),r=Os(),s=on(),i=Z(!1),o=Z(null),a=Z([]),l=Z([]),u=Z("income"),c=Z(!1),d=Z(!1),h=Z(!1),f=Z(!1),p=Z(null),y=Z(null),w=Z({name:"",type:"cash",balance:0}),v=Z({name:"",type:"expense",icon:"dollar-sign",color:"#6B7280"}),m=Oe(()=>l.value.filter(F=>F.type===u.value));Ot(async()=>{try{const F=await fetch("/src/templates/accounts.html");e.value=await F.text(),setTimeout(()=>{_(),E()},100)}catch(F){console.error("Failed to load accounts template:",F)}});const _=()=>{k(),N(),I()},E=async()=>{var F;if(!((F=n.user)!=null&&F.family_id)){s.push("/family/setup");return}i.value=!0,o.value=null;try{await Promise.all([T(),S()])}catch{o.value="Terjadi kesalahan saat memuat data"}finally{i.value=!1}},T=async()=>{var j;if(!((j=n.user)!=null&&j.family_id))return;const F=await st.getAccountStats(n.user.family_id);if(F.error)throw new Error(F.error);a.value=F.data||[],J()},S=async()=>{var j;if(!((j=n.user)!=null&&j.family_id))return;const F=await st.getCategoryStats(n.user.family_id);if(F.error)throw new Error(F.error);l.value=F.data||[],de()},k=()=>{const F=document.getElementById("account-modal"),j=document.getElementById("close-account-modal"),K=document.getElementById("cancel-account"),ae=document.getElementById("account-form");j&&j.addEventListener("click",()=>ue()),K&&K.addEventListener("click",()=>ue()),F&&F.addEventListener("click",me=>{me.target===F&&ue()}),ae&&ae.addEventListener("submit",O);const C=document.getElementById("category-modal"),H=document.getElementById("close-category-modal"),M=document.getElementById("cancel-category"),X=document.getElementById("category-form");H&&H.addEventListener("click",()=>$()),M&&M.addEventListener("click",()=>$()),C&&C.addEventListener("click",me=>{me.target===C&&$()}),X&&X.addEventListener("submit",D),Y()},N=()=>{const F=document.getElementById("add-account-btn"),j=document.getElementById("add-category-btn");F&&F.addEventListener("click",()=>Q()),j&&j.addEventListener("click",()=>x())},I=()=>{const F=document.querySelectorAll(".tab-btn");F.forEach(j=>{j.addEventListener("click",()=>{const K=j.getAttribute("data-type");F.forEach(ae=>ae.classList.remove("active")),j.classList.add("active"),u.value=K,de()})})},Y=()=>{const F=document.querySelectorAll(".color-option"),j=document.getElementById("category-color");F.forEach(K=>{K.addEventListener("click",()=>{const ae=K.getAttribute("data-color");ae&&j&&(j.value=ae,v.value.color=ae,F.forEach(C=>C.classList.remove("selected")),K.classList.add("selected"))})})},Q=F=>{F?(h.value=!0,p.value=F.id,w.value={name:F.name,type:F.type,balance:Number(F.balance)}):(h.value=!1,p.value=null,w.value={name:"",type:"cash",balance:0}),c.value=!0;const j=document.getElementById("account-modal");j&&j.classList.add("show"),re()},ue=()=>{c.value=!1;const F=document.getElementById("account-modal");F&&F.classList.remove("show")},x=F=>{F?(f.value=!0,y.value=F.id,v.value={name:F.name,type:F.type,icon:F.icon,color:F.color}):(f.value=!1,y.value=null,v.value={name:"",type:u.value,icon:"dollar-sign",color:"#6B7280"}),d.value=!0;const j=document.getElementById("category-modal");j&&j.classList.add("show"),z()},$=()=>{d.value=!1;const F=document.getElementById("category-modal");F&&F.classList.remove("show")},re=()=>{setTimeout(()=>{const F=document.getElementById("account-modal-title"),j=document.getElementById("account-name"),K=document.getElementById("account-type"),ae=document.getElementById("account-balance");F&&(F.textContent=h.value?"Edit Akun":"Tambah Akun"),j&&(j.value=w.value.name,j.addEventListener("input",()=>{w.value.name=j.value})),K&&(K.value=w.value.type,K.addEventListener("change",()=>{w.value.type=K.value})),ae&&(ae.value=w.value.balance.toString(),ae.addEventListener("input",()=>{w.value.balance=Number(ae.value)}))},50)},z=()=>{setTimeout(()=>{const F=document.getElementById("category-modal-title"),j=document.getElementById("category-name"),K=document.getElementById("category-type"),ae=document.getElementById("category-icon"),C=document.getElementById("category-color");F&&(F.textContent=f.value?"Edit Kategori":"Tambah Kategori"),j&&(j.value=v.value.name,j.addEventListener("input",()=>{v.value.name=j.value})),K&&(K.value=v.value.type,K.addEventListener("change",()=>{v.value.type=K.value})),ae&&(ae.value=v.value.icon,ae.addEventListener("change",()=>{v.value.icon=ae.value})),C&&(C.value=v.value.color,document.querySelectorAll(".color-option").forEach(M=>{M.classList.remove("selected"),M.getAttribute("data-color")===v.value.color&&M.classList.add("selected")}))},50)},O=async F=>{var j;if(F.preventDefault(),!!((j=n.user)!=null&&j.family_id)){i.value=!0,o.value=null;try{if(h.value&&p.value){const K=await st.updateAccount(p.value,w.value);if(K.error){o.value=K.error;return}}else{const K=await st.createAccount(n.user.family_id,n.user.id,w.value);if(K.error){o.value=K.error;return}}ue(),await T()}catch{o.value="Terjadi kesalahan saat menyimpan akun"}finally{i.value=!1}}},D=async F=>{var j;if(F.preventDefault(),!!((j=n.user)!=null&&j.family_id)){i.value=!0,o.value=null;try{if(f.value&&y.value){const K=await st.updateCategory(y.value,v.value);if(K.error){o.value=K.error;return}}else{const K=await st.createCategory(n.user.family_id,n.user.id,v.value);if(K.error){o.value=K.error;return}}$(),await S()}catch{o.value="Terjadi kesalahan saat menyimpan kategori"}finally{i.value=!1}}},J=()=>{const F=document.getElementById("accounts-grid");if(F){if(a.value.length===0){F.innerHTML=`
      <div class="empty-state col-span-full">
        <i class="icon-credit-card"></i>
        <h3>Belum ada akun</h3>
        <p>Tambahkan akun pertama untuk mulai mencatat transaksi</p>
      </div>
    `;return}F.innerHTML=a.value.map(j=>{const K=r.formatCurrency(Number(j.balance)),ae={cash:"Tunai",bank:"Bank",credit:"Kredit",investment:"Investasi"}[j.type]||j.type;return`
      <div class="account-card ${j.type}">
        <div class="account-header">
          <span class="account-name">${j.name}</span>
          <span class="account-type ${j.type}">${ae}</span>
        </div>
        <div class="account-balance">${K}</div>
        <div class="account-stats">
          ${j.transaction_count||0} transaksi
        </div>
        <div class="account-actions">
          <button onclick="editAccount('${j.id}')" class="edit-account-btn">
            Edit
          </button>
          <button onclick="deleteAccount('${j.id}')" class="delete-account-btn">
            Hapus
          </button>
        </div>
      </div>
    `}).join(""),window.editAccount=j=>{const K=a.value.find(ae=>ae.id===j);K&&Q(K)},window.deleteAccount=async j=>{if(confirm("Apakah Anda yakin ingin menghapus akun ini?")){const K=await st.deleteAccount(j);K.error?alert(K.error):await T()}}}},de=()=>{const F=document.getElementById("categories-grid");if(!F)return;const j=m.value;if(j.length===0){F.innerHTML=`
      <div class="empty-state col-span-full">
        <i class="icon-tag"></i>
        <h3>Belum ada kategori ${u.value==="income"?"pemasukan":"pengeluaran"}</h3>
        <p>Tambahkan kategori untuk mengorganisir transaksi</p>
      </div>
    `;return}F.innerHTML=j.map(K=>{const ae=r.formatCurrency(Number(K.total_amount||0));return`
      <div class="category-card" style="border-color: ${K.color}33;">
        <div class="category-header">
          <div class="category-icon" style="background-color: ${K.color};">
            ${Ee(K.icon)}
          </div>
        </div>
        <div class="category-name">${K.name}</div>
        <div class="category-amount ${K.type}">${ae}</div>
        <div class="category-stats">
          ${K.transaction_count||0} transaksi
        </div>
        <div class="category-actions">
          <button onclick="editCategory('${K.id}')" class="edit-category-btn">
            Edit
          </button>
          <button onclick="deleteCategory('${K.id}')" class="delete-category-btn">
            Hapus
          </button>
        </div>
      </div>
    `}).join(""),window.editCategory=K=>{const ae=l.value.find(C=>C.id===K);ae&&x(ae)},window.deleteCategory=async K=>{if(confirm("Apakah Anda yakin ingin menghapus kategori ini?")){const ae=await st.deleteCategory(K);ae.error?alert(ae.error):await S()}}},Ee=F=>({"dollar-sign":"",coffee:"",car:"",home:"","shopping-bag":"",heart:"",smile:"",book:"",briefcase:"",gift:"","trending-up":"","file-text":""})[F]||"",Ne=()=>{o.value=null};return(F,j)=>(Te(),tn(Or,{"page-title":"Akun & Kategori"},{default:Vn(()=>[j[2]||(j[2]=te("link",{rel:"stylesheet",href:"/src/styles/accounts.css"},null,-1)),i.value?(Te(),Be("div",j_,[...j[0]||(j[0]=[te("div",{class:"loading-spinner"},null,-1),te("p",null,"Memuat data...",-1)])])):ft("",!0),o.value?(Te(),Be("div",$_,[te("div",U_,[j[1]||(j[1]=te("i",{class:"icon-alert-circle"},null,-1)),te("p",null,jt(o.value),1),te("button",{onClick:Ne,class:"retry-btn"},"Tutup")])])):ft("",!0),Ca(te("div",{innerHTML:e.value},null,8,D_),[[ja,!i.value]])]),_:1}))}});const B_=an(F_,[["__scopeId","data-v-2d0e4479"]]),M_={class:"placeholder-container"},q_={class:"placeholder-content"},K_=ot({__name:"ReportsView",setup(t){const e=Z("Halaman Laporan akan dikembangkan selanjutnya");return(n,r)=>(Te(),tn(Or,{"page-title":"Laporan"},{default:Vn(()=>[te("div",M_,[te("div",q_,[r[0]||(r[0]=te("h2",null,"Laporan",-1)),te("p",null,jt(e.value),1)])])]),_:1}))}});const H_=an(K_,[["__scopeId","data-v-b55a48d9"]]),W_={class:"placeholder-container"},V_={class:"placeholder-content"},G_=ot({__name:"SettingsView",setup(t){const e=Z("Halaman Pengaturan akan dikembangkan selanjutnya");return(n,r)=>(Te(),tn(Or,{"page-title":"Pengaturan"},{default:Vn(()=>[te("div",W_,[te("div",V_,[r[0]||(r[0]=te("h2",null,"Pengaturan",-1)),te("p",null,jt(e.value),1)])])]),_:1}))}});const z_=an(G_,[["__scopeId","data-v-613571c5"]]),rh=Lm({history:cm("/"),routes:[{path:"/",redirect:"/dashboard"},{path:"/auth",children:[{path:"login",name:"login",component:ov,meta:{requiresAuth:!1}},{path:"register",name:"register",component:hv,meta:{requiresAuth:!1}},{path:"confirm",name:"email-confirm",component:pv,meta:{requiresAuth:!1}}]},{path:"/dashboard",name:"dashboard",component:b_,meta:{requiresAuth:!0,requiresFamily:!0}},{path:"/transactions",name:"transactions",component:A_,meta:{requiresAuth:!0,requiresFamily:!0}},{path:"/accounts",name:"accounts",component:B_,meta:{requiresAuth:!0,requiresFamily:!0}},{path:"/family",children:[{path:"",name:"family",component:I_,meta:{requiresAuth:!0,requiresFamily:!0}},{path:"setup",name:"family-setup",component:N_,meta:{requiresAuth:!0,requiresFamily:!1}}]},{path:"/reports",name:"reports",component:H_,meta:{requiresAuth:!0,requiresFamily:!0}},{path:"/settings",name:"settings",component:z_,meta:{requiresAuth:!0,requiresFamily:!0}},{path:"/:pathMatch(.*)*",redirect:"/dashboard"}]});rh.beforeEach(async(t,e,n)=>{const r=Ut();!r.user&&!r.isLoading&&await r.getCurrentUser();const s=t.meta.requiresAuth,i=t.meta.requiresFamily,o=r.isAuthenticated,a=r.hasFamily;if(s&&!o){n("/auth/login");return}if(!s&&o){n(a?"/dashboard":"/family/setup");return}if(i&&o&&!a){n("/family/setup");return}n()});const tl=Tp(tv);tl.use(Op());tl.use(rh);tl.mount("#app");const Y_=Os();Y_.initializeOfflineSync().catch(console.error);
